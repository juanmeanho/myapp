var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.checkStringArgs=function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,b){var c=$jscomp.propertyToPolyfillSymbol[b];if(null==c)return a[b];c=a[c];return void 0!==c?c:a[b]};
$jscomp.polyfill=function(a,b,c,d){b&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,b,c,d):$jscomp.polyfillUnisolated(a,b,c,d))};$jscomp.polyfillUnisolated=function(a,b,c,d){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];if(!(e in c))return;c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})};
$jscomp.polyfillIsolated=function(a,b,c,d){var e=a.split(".");a=1===e.length;d=e[0];d=!a&&d in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var f=0;f<e.length-1;f++){var g=e[f];if(!(g in d))return;d=d[g]}e=e[e.length-1];c=$jscomp.IS_SYMBOL_NATIVE&&"es6"===c?d[e]:null;b=b(c);null!=b&&(a?$jscomp.defineProperty($jscomp.polyfills,e,{configurable:!0,writable:!0,value:b}):b!==c&&($jscomp.propertyToPolyfillSymbol[e]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(e):$jscomp.POLYFILL_PREFIX+e,e=
$jscomp.propertyToPolyfillSymbol[e],$jscomp.defineProperty(d,e,{configurable:!0,writable:!0,value:b})))};$jscomp.polyfill("String.prototype.endsWith",function(a){return a?a:function(b,c){var d=$jscomp.checkStringArgs(this,b,"endsWith");b+="";void 0===c&&(c=d.length);c=Math.max(0,Math.min(c|0,d.length));for(var e=b.length;0<e&&0<c;)if(d[--c]!=b[--e])return!1;return 0>=e}},"es6","es3");$jscomp.owns=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};
$jscomp.assign=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.assign?Object.assign:function(a,b){for(var c=1;c<arguments.length;c++){var d=arguments[c];if(d)for(var e in d)$jscomp.owns(d,e)&&(a[e]=d[e])}return a};$jscomp.polyfill("Object.assign",function(a){return a||$jscomp.assign},"es6","es3");Array.prototype.remove=function(a,b){b=this.slice((b||a)+1||this.length);this.length=0>a?this.length+a:a;return this.push.apply(this,b)};
String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});String.prototype.endsWith||(String.prototype.endsWith=function(a){return-1!==this.indexOf(a,this.length-a.length)});function GenericObject(){this.classname="GenericObject"}GenericObject.prototype.SEMICOLON=";";GenericObject.prototype.COLON=":";GenericObject.prototype.COMMA=",";GenericObject.prototype.SLASH="/";GenericObject.prototype.SP=" ";GenericObject.prototype.EQUALS="=";
GenericObject.prototype.STAR="*";GenericObject.prototype.NEWLINE="\r\n";GenericObject.prototype.RETURN="\n";GenericObject.prototype.LESS_THAN="<";GenericObject.prototype.GREATER_THAN=">";GenericObject.prototype.AT="@";GenericObject.prototype.DOT=".";GenericObject.prototype.QUESTION="?";GenericObject.prototype.POUND="#";GenericObject.prototype.AND="&";GenericObject.prototype.LPAREN="(";GenericObject.prototype.RPAREN=")";GenericObject.prototype.DOUBLE_QUOTE='"';GenericObject.prototype.QUOTE="'";
GenericObject.prototype.HT="\t";GenericObject.prototype.PERCENT="%";GenericObject.prototype.isMySubclass=function(a){if("object"!=typeof a||a instanceof Array)return!1;var b=0;if("GenericObject"==Object.getPrototypeOf(a).classname)return!0;for(O=Object.getPrototypeOf(a);void 0!=O.classname;)"GenericObject"==Object.getPrototypeOf(O).classname&&(b=1),O=Object.getPrototypeOf(O);return 1==b?!0:!1};GenericObject.prototype.encode=function(a){return a+this.encode()};GenericObject.prototype.equals=function(a){};
GenericObject.prototype.match=function(a){};GenericObject.prototype.merge=function(a){};GenericObject.prototype.clone=function(){var a=this.constructor==Object?new this.constructor:new this.constructor(this.valueOf());for(var b in this)a[b]!=this[b]&&(a[b]="object"==typeof this[b]?this[b].clone():this[b]);a.toString=this.toString;a.valueOf=this.valueOf;return a};function GenericObjectList(){this.classname="GenericObjectList"}
GenericObjectList.prototype.isMySubclass=function(a){if("object"!=typeof a||a instanceof Array)return!1;var b=0;if("GenericObjectList"==Object.getPrototypeOf(a).classname)return!0;for(O=Object.getPrototypeOf(a);void 0!=O.classname;)"GenericObjectList"==Object.getPrototypeOf(O).classname&&(b=1),O=Object.getPrototypeOf(O);return 1==b?!0:!1};
function NameValue(a,b,c){this.classname="NameValue";this.isQuotedString=null;this.isFlagParameter=c;this.separator=this.EQUALS;this.quotes="";this.name=a;this.value=b;null==a&&(this.name=null);null==b&&(this.value=null);null==c&&(this.isFlagParameter=!1)}NameValue.prototype=new GenericObject;NameValue.prototype.constructor=NameValue;NameValue.prototype.EQUALS="=";NameValue.prototype.DOUBLE_QUOTE='"';NameValue.prototype.setSeparator=function(a){this.separator=a};
NameValue.prototype.setQuotedValue=function(){this.isQuotedString=!0;this.quotes=this.DOUBLE_QUOTE};NameValue.prototype.isValueQuoted=function(){return this.isQuotedString};NameValue.prototype.getName=function(){return this.name};NameValue.prototype.getValueAsObject=function(){return this.isFlagParameter?"":this.value};NameValue.prototype.setName=function(a){this.name=a};NameValue.prototype.setValueAsObject=function(a){this.value=a};NameValue.prototype.encode=function(){return this.encodeBuffer("").toString()};
NameValue.prototype.encodeBuffer=function(a){var b=new GenericObject,c=new GenericObjectList;null==this.name||null==this.value||this.isFlagParameter?null==this.name&&null!=this.value?b.isMySubclass(this.value)?this.value.encodeBuffer(a):a=c.isMySubclass(this.value)?a+this.value.encode():a+this.quotes+this.value.toString()+this.quotes:null==this.name||null!=this.value&&!this.isFlagParameter||(a+=this.name):b.isMySubclass(this.value)?(a=a+this.name+this.separator+this.quotes,a=this.value.encodeBuffer(a),
a+=this.quotes):a=c.isMySubclass(this.value)?a+this.name+this.separator+this.value.encode():0==this.value.toString().length?this.isQuotedString?a+this.name+this.separator+this.quotes+this.quotes:"lr"==this.name?a+this.name:a+this.name+this.separator:a+this.name+this.separator+this.quotes+this.value.toString()+this.quotes;return a};
NameValue.prototype.equals=function(a){if(null==a||a.classname!=this.classname)return!1;if(this==a)return!0;if(null==this.name&&null!=a.name||null!=this.name&&null==a.name||null!=this.name&&null!=a.name&&0!=this.name.compareToIgnoreCase(a.name)||null!=this.value&&null==a.value||null==this.value&&null!=a.value)return!1;if(this.value==a.value)return!0;if(this.value instanceof String){if(this.isQuotedString)return this.value==a.value?!0:!1;a=a.value;return this.value.toLowerCase()==a.toLowerCase()?!0:
!1}return this.value==a.value?!0:!1};NameValue.prototype.getKey=function(){return this.name};NameValue.prototype.getValue=function(){return null==this.value?null:this.value.toString()};NameValue.prototype.setValue=function(a){var b=null==this.value?null:a;this.value=a;return b};NameValue.prototype.hashCode=function(){var a=0,b=this.encode().toLowerCase();if(null!=b&&""!=b.value)for(var c=0;c<b.length;c++)if(a=31*a+b.charCodeAt(c),2147483647<a||-2147483648>a)a&=4294967295;return a};
function NameValueList(a){this.classname="NameValueList";this.hmap=[];this.separator=";"}NameValueList.prototype.setSeparator=function(a){this.separator=a};NameValueList.prototype.encode=function(){return this.encodeBuffer("").toString()};NameValueList.prototype.encodeBuffer=function(a){if(0!=this.hmap.length)for(var b=0;b<this.hmap.length;b++){var c=this.hmap[b][1];a=c instanceof GenericObject?c.encodeBuffer(a):a+c.toString();b!=this.hmap.length-1&&(a+=this.separator)}return a};
NameValueList.prototype.toString=function(){return this.encode()};NameValueList.prototype.set_nv=function(a){for(var b=0,c=0;c<this.hmap.length;c++){var d=this.hmap[c][0];if(d==a.getName().toLowerCase()){b=1;var e=[];e[0]=d;e[1]=a;this.hmap[c]=e}}0==b&&(b=this.hmap.length,e=[],e[0]=a.getName().toLowerCase(),e[1]=a,this.hmap[b]=e)};
NameValueList.prototype.set_name_value=function(a,b){b=new NameValue(a,b);a=a.toLowerCase();for(var c=0,d=0;d<this.hmap.length;d++){var e=this.hmap[d][0];if(e==a.toLowerCase()){c=1;var f=[];f[0]=e;f[1]=b;this.hmap[d]=f}}0==c&&(c=this.hmap.length,f=[],f[0]=a.toLowerCase(),f[1]=b,this.hmap[c]=f)};
NameValueList.prototype.equals=function(a){if(null==a||a.classname!=this.classname||this.hmap.length!=a.hmap.length)return!1;for(var b=[],c=0,d=0;d<this.hmap.length;d++)b[c]=this.hmap[d][0],c++;for(d=0;d<b.length;d++){new NameValue;new NameValue;c=this.getNameValue(b[d]);var e=a.getNameValue(b[d]);if(null==e||!e.equals(c))return!1}return!0};NameValueList.prototype.getValue=function(a){new NameValue;a=this.getNameValue(a.toLowerCase());return null!=a?a.getValueAsObject():null};
NameValueList.prototype.getNameValue=function(a){for(var b=null,c=0;c<this.hmap.length;c++)a.toLowerCase()==this.hmap[c][0]&&(b=this.hmap[c][1]);return b};NameValueList.prototype.hasNameValue=function(a){for(var b=0,c=0;c<this.hmap.length;c++)a.toLowerCase()==this.hmap[c][0]&&(b=1);return 1==b?!0:!1};NameValueList.prototype.delet=function(a){for(var b=0,c=0,d=0;d<this.hmap.length;d++)a.toLowerCase()==this.hmap[d][0]&&(b=1,c=d);return 1==b?(this.hmap.splice(c,1),!0):!1};
NameValueList.prototype.size=function(){return this.hmap.length};NameValueList.prototype.isEmpty=function(){return 0==this.hmap.length?!0:!1};NameValueList.prototype.iterator=function(){return this.hmap};NameValueList.prototype.getNames=function(){for(var a=[],b=0,c=0;c<this.hmap.length;c++)a[b]=this.hmap[c][0],b++;return 0!=a.length?a:null};NameValueList.prototype.getParameter=function(a){a=this.getValue(a);return null==a?null:a instanceof GenericObject?a.encode():a.toString()};
NameValueList.prototype.clear=function(){this.hmap=null};NameValueList.prototype.containsKey=function(a){for(var b=0,c=0;c<this.hmap.length;c++)this.hmap[c][0]==a.toString().toLowerCase()&&(b=1);return 1==b?!0:!1};NameValueList.prototype.containsValue=function(a){for(var b=0,c=0;c<this.hmap.length;c++)this.hmap[c][1]==a&&(b=1);return 1==b?!0:!1};NameValueList.prototype.entrySet=function(){return this.hmap};
NameValueList.prototype.get=function(a){new NameValue;a=this.getNameValue(a.toString().toLowerCase());return null!=a?a.getValueAsObject():null};NameValueList.prototype.keySet=function(){for(var a=[],b=0,c=0;c<this.hmap.length;c++)a[b]=this.hmap[c][0],b++;return a};NameValueList.prototype.put=function(a,b){for(var c=new NameValue,d=0,e=0;e<this.hmap.length;e++)if(this.hmap[e][0]==a){d=1;c=this.hmap[e][1];var f=[];f[0]=a;f[1]=b;this.hmap[e]=f}return 0!=d?c:null};
NameValueList.prototype.putAll=function(a){for(var b=0;b<a.length;b++)this.put(a[b][0],a[b][1])};NameValueList.prototype.remove=function(a){var b=0,c=0;new NameValue;for(var d=0;d<this.hmap.length;d++)a.toString().toLowerCase()==this.hmap[d][0]&&(b=1,c=d);return 1==b?(a=this.hmap[c][1],this.hmap.splice(c,1),a):null};NameValueList.prototype.values=function(){for(var a=[],b=0,c=0;c<this.hmap.length;c++)a[b]=this.hmap[c][1],b++;return a};
NameValueList.prototype.hashCode=function(){var a=0,b=this.keySet();if(null!=b&&""!=b.value)for(var c=0;c<b.length;c++)if(a=31*a+b.charCodeAt(c),2147483647<a||-2147483648>a)a&=4294967295;return a};function DuplicateNameValueList(){this.classname="DuplicateNameValueList";this.nameValueMap=[];this.separator=";"}DuplicateNameValueList.prototype.setSeparator=function(a){this.separator=a};DuplicateNameValueList.prototype.encode=function(){return this.encodeBuffer("").toString()};
DuplicateNameValueList.prototype.encodeBuffer=function(a){if(0!=this.nameValueMap.length)for(var b=0;b<this.nameValueMap.length;b++)for(var c,d=0;d<this.nameValueMap[b][1].length;d++)c=this.nameValueMap[b][1][d],a=c instanceof GenericObject?c.encodeBuffer(a):a+c.toString(),b!=this.nameValueMap.length-1&&(a+=this.separator);return a};DuplicateNameValueList.prototype.toString=function(){return this.encode()};
DuplicateNameValueList.prototype.set_nv=function(a){for(var b=null,c=0,d=0;d<this.nameValueMap.length;d++)if(this.nameValueMap[d][0]==a.getName().toLowerCase()){b=this.nameValueMap[d][1];var e=b.length;c=1;var f=d}null==b&&(1==c?(b=[],b[0]=a,this.nameValueMap[f][1]=b):(c=this.nameValueMap.length,b=[],e=[],e[0]=a.getName().toLowerCase(),e[1]=b,this.nameValueMap[c]=e,e=0,f=c));b[e]=a;this.nameValueMap[f][1]=b};
DuplicateNameValueList.prototype.set_name_value=function(a,b){a=new NameValue(a,b);b=null;for(var c=0,d=0;d<this.nameValueMap.length;d++)if(this.nameValueMap[d][0]==a.getName().toLowerCase()){b=this.nameValueMap[d][1];var e=b.length;c=1;var f=d}null==b&&(1==c?(b=[],b[0]=a,this.nameValueMap[f][1]=b):(f=this.nameValueMap.length,b=[],e=[],e[0]=a.getName().toLowerCase(),e[1]=b,this.nameValueMap[f]=e,e=0));b[e]=a;this.nameValueMap[f][1]=b};
DuplicateNameValueList.prototype.equals=function(a){if(null==a||a.classname==this.classname||this.nameValueMap.length!=a.nameValueMap.length)return!1;for(var b;b<this.nameValueMap.length;b++){var c=this.nameValueMap[b][0],d=this.getNameValue(c);c=a.nameValueMap.get(c);if(null==c||c!=d)return!1}return!0};DuplicateNameValueList.prototype.getValue=function(a){a=this.getNameValue(a.toLowerCase());return null!=a?a:null};
DuplicateNameValueList.prototype.getNameValue=function(a){for(var b=[],c=0;c<this.nameValueMap.length;c++)this.nameValueMap[c][0]==a&&(b=this.nameValueMap[c][1]);return b};DuplicateNameValueList.prototype.hasNameValue=function(a){for(var b=0,c=0;c<this.nameValueMap.length;c++)this.nameValueMap[c][0]==a.toLowerCase()&&(b=1);return 1==b?!0:!1};
DuplicateNameValueList.prototype.delet=function(a){a=a.toLowerCase();for(var b=0,c=0,d=0;d<this.nameValueMap.length;d++)this.nameValueMap[d][0]==a&&(b=1,c=d);return 1==b?(this.nameValueMap.splice(c,1),!0):!1};DuplicateNameValueList.prototype.iterator=function(){return this.nameValueMap};DuplicateNameValueList.prototype.getNames=function(){for(var a=[],b=0,c=0;c<this.nameValueMap.length;c++)a[b]=this.nameValueMap[c][0],b++;return 0!=a.length?a:null};
DuplicateNameValueList.prototype.getParameter=function(a){a=this.getValue(a);if(null==a)return null;for(var b="",c=0;c<a.length;c++)b=a[c]instanceof GenericObject?b+a[c].encode():b+a[c].toString(),c!=a.length-1&&(b+=";  ");return b};DuplicateNameValueList.prototype.clear=function(){this.nameValueMap=[]};DuplicateNameValueList.prototype.isEmpty=function(){return 0!=this.nameValueMap.length?!0:!1};
DuplicateNameValueList.prototype.put=function(a,b){for(var c=new NameValue,d=0,e=0;e<this.nameValueMap.length;e++)if(this.nameValueMap[e][0]==a){d=1;c=this.nameValueMap[e][1];var f=[];f[0]=a;f[1]=b;this.nameValueMap[e]=f}return 0!=d?c:null};DuplicateNameValueList.prototype.remove=function(a){var b=0,c=0;new NameValue;for(var d=0;d<this.nameValueMap.length;d++)a.toString().toLowerCase()==this.nameValueMap[d][0]&&(b=1,c=d);return 1==b?(a=this.nameValueMap[c][1],this.nameValueMap.splice(c,1),a):null};
DuplicateNameValueList.prototype.size=function(){for(var a=0,b=0;b<this.nameValueMap.length;b++)a+=this.nameValueMap[b][1].length;return a};DuplicateNameValueList.prototype.values=function(){for(var a=[],b=0,c=0;c<this.nameValueMap.length;c++)a[b]=this.nameValueMap[c][1],b++;return a};
DuplicateNameValueList.prototype.hashCode=function(){for(var a=0,b=[],c=0,d=0;d<this.nameValueMap.length;d++)b[c]=this.nameValueMap[d][0],c++;if(null!=b&&""!=b.value)for(d=0;d<b.length;d++)if(a=31*a+b.charCodeAt(d),2147483647<a||-2147483648>a)a&=4294967295;return a};function HostPort(){this.classname="HostPort";this.port=-1;this.host=new Host}HostPort.prototype=new GenericObject;HostPort.prototype.constructor=HostPort;HostPort.prototype.COLON=":";HostPort.prototype.encode=function(){return this.encodeBuffer("")};
HostPort.prototype.encodeBuffer=function(a){a=this.host.encodeBuffer(a);-1!=this.port&&(a=a+this.COLON+this.port);return a};HostPort.prototype.equals=function(a){return null==a||this.classname!=a.classname?!1:this.port==a.port&&this.host.equals(a.host)?!0:!1};HostPort.prototype.getHost=function(){return this.host};HostPort.prototype.getPort=function(){return this.port};HostPort.prototype.hasPort=function(){return-1!=this.port?!0:!1};HostPort.prototype.removePort=function(){this.port=-1};
HostPort.prototype.setHost=function(a){this.host=a};HostPort.prototype.setPort=function(a){this.port=a};HostPort.prototype.getInetAddress=function(){return null==this.host?null:this.host.getInetAddress()};HostPort.prototype.merge=function(a){(new GenericObject).merge(a);-1==this.port&&(this.port=a.port)};HostPort.prototype.toString=function(){return this.encode()};HostPort.prototype.hashCode=function(){return this.host.hashCode()+this.port};
function Host(a,b){this.stripAddressScopeZones=!1;this.inetAddress=this.addressType=this.hostname=null;this.classname="Host";null==a&&null==b?this.addressType=this.HOSTNAME:null==b&&null!=a?this.setHost(a,this.IPV4ADDRESS):this.setHost(a,b)}Host.prototype=new GenericObject;Host.prototype.constructor=Host;Host.prototype.HOSTNAME=1;Host.prototype.IPV4ADDRESS=2;Host.prototype.IPV6ADDRESS=3;Host.prototype.encode=function(){return this.encodeBuffer("").toString()};
Host.prototype.encodeBuffer=function(a){return this.addressType!=this.IPV6ADDRESS||this.isIPv6Reference(this.hostname)?a+this.hostname:a+"["+this.hostname+"]"};Host.prototype.equals=function(a){return null==a||this.classname!=a.classname?!1:a.hostname==this.hostname?!0:!1};Host.prototype.getHostname=function(){return this.hostname};Host.prototype.getAddress=function(){return this.hostname};
Host.prototype.getIpAddress=function(){var a=null;if(null==this.hostname)return null;this.addressType!=this.HOSTNAME&&(a=this.hostname);return a};Host.prototype.setHostname=function(a){this.setHost(a,this.HOSTNAME)};Host.prototype.setHostAddress=function(a){this.setHost(a,this.IPV4ADDRESS)};
Host.prototype.setHost=function(a,b){this.inetAddress=null;null==b&&(b=2);this.isIPv6Address(a)?this.addressType=this.IPV6ADDRESS:this.addressType=b;null!=a&&(this.hostname=a.trim(),this.addressType==this.HOSTNAME&&(this.hostname=this.hostname.toLowerCase()),a=-1,this.addressType==this.IPV6ADDRESS&&this.stripAddressScopeZones&&-1!=(a=this.hostname.indexOf("%"))&&(this.hostname=this.hostname.substring(0,a)))};Host.prototype.setAddress=function(a){this.setHostAddress(a)};
Host.prototype.isHostname=function(){return this.addressType==this.HOSTNAME?!0:!1};Host.prototype.isIPAddress=function(){return this.addressType!=this.HOSTNAME?!0:!1};Host.prototype.getInetAddress=function(){return null==this.hostname?null:this.inetAddress};Host.prototype.isIPv6Address=function(a){return null!=a&&-1!=a.indexOf(":")?!0:!1};Host.prototype.isIPv6Reference=function(a){return"["==a.charAt(0)&&"]"==a.charAt(a.length()-1)?!0:!1};
Host.prototype.hashCode=function(){var a=0,b=this.getHostname();if(null!=b&&""!=b.value)for(var c=0;c<b.length;c++)if(a=31*a+b.charCodeAt(c),2147483647<a||-2147483648>a)a&=4294967295;return a};function Token(){this.classname="Token";this.tokenType=this.tokenValue=null}Token.prototype.getTokenValue=function(){return this.tokenValue};Token.prototype.getTokenType=function(){return this.tokenType};Token.prototype.toString=function(){return"tokenValue = "+this.tokenValue+"/tokenType = "+this.tokenType};
function StringTokenizer(a){this.classname="StringTokenizer";this.savedPtr=this.ptr=this.bufferLen=this.buffer=null;null!=a&&(this.buffer=a,this.bufferLen=a.length,this.ptr=0)}StringTokenizer.prototype.nextToken=function(){for(var a=this.ptr;this.ptr<this.bufferLen;){var b=this.buffer.charAt(this.ptr);this.ptr++;if("\n"==b)break}return this.buffer.substring(a,this.ptr)};StringTokenizer.prototype.hasMoreChars=function(){return this.ptr<this.bufferLen&&"\r"!=this.buffer.charAt(this.ptr)?!0:!1};
StringTokenizer.prototype.isHexDigit=function(a){return"A"<=a&&"F">=a||"a"<=a&&"f">=a||this.isDigit(a)?!0:!1};StringTokenizer.prototype.isAlpha=function(a){return 127>=a.charCodeAt(0)?"a"<=a&&"z">=a||"A"<=a&&"Z">=a?!0:!1:a==a.toLowerCase()||a==a.toUpperCase()?!0:!1};StringTokenizer.prototype.isDigit=function(a){return 127>=a.charCodeAt(0)?"9">=a&&"0"<=a?!0:!1:"number"==typeof a?!0:!1};
StringTokenizer.prototype.isAlphaDigit=function(a){return 127>=a.charCodeAt(0)?"a"<=a&&"z">=a||"A"<=a&&"Z">=a||"9">=a&&"0"<=a?!0:!1:a==a.toLowerCase()||a==a.toUpperCase()||"number"==typeof a?!0:!1};StringTokenizer.prototype.getLine=function(){for(var a=this.ptr;this.ptr<this.bufferLen&&"\n"!=this.buffer.charAt(this.ptr);)this.ptr++;this.ptr<this.bufferLen&&"\n"==this.buffer.charAt(this.ptr)&&this.ptr++;return this.buffer.substring(a,this.ptr)};
StringTokenizer.prototype.peekLine=function(){var a=this.ptr,b=this.getLine();this.ptr=a;return b};StringTokenizer.prototype.lookAhead=function(a){null==a&&(a=0);return this.buffer.charAt(this.ptr+a)};StringTokenizer.prototype.getNextChar=function(){if(this.ptr>=this.bufferLen)throw console.error("StringTokenizer:getNextChar(): end of buffer:"+this.ptr),"StringTokenizer:getNextChar(): end of buffer";return this.buffer.charAt(this.ptr++)};
StringTokenizer.prototype.consume=function(a){this.ptr=null==a?this.savedPtr:this.ptr+a};StringTokenizer.prototype.getLines=function(){for(var a=[];this.hasMoreChars();){var b=this.getLine();a.push(b)}return a};StringTokenizer.prototype.getNextToken=function(a){for(var b=this.ptr;;){var c=this.lookAhead(0);if(c==a)break;else if(""==c)throw console.error("StringTokenizer:getNextToken(): EOL reached"),"StringTokenizer:getNextToken(): EOL reached";this.consume(1)}return this.buffer.substring(b,this.ptr)};
StringTokenizer.prototype.getSDPFieldName=function(a){if(null==a)return null;var b=a.indexOf("=");return a.substring(0,b)};
function LexerCore(){this.classname="LexerCore";this.globalSymbolTable=[];this.lexerTables=[];this.currentLexerName=this.currentLexer=null;this.currentMatch=new Token;if(0==arguments.length)this.currentLexer=[],this.currentLexerName="charLexer";else{var a=arguments[0],b=arguments[1];this.buffer=b;this.bufferLen=b.length;this.ptr=0;this.currentLexer=[];this.currentLexerName=a}}LexerCore.prototype=new StringTokenizer;LexerCore.prototype.constructor=LexerCore;LexerCore.prototype.START=2048;
LexerCore.prototype.END=LexerCore.prototype.START+2048;LexerCore.prototype.ID=LexerCore.prototype.END-1;LexerCore.prototype.SAFE=LexerCore.prototype.END-2;LexerCore.prototype.ID_NO_WHITESPACE=LexerCore.prototype.END-3;LexerCore.prototype.WHITESPACE=LexerCore.prototype.END+1;LexerCore.prototype.DIGIT=LexerCore.prototype.END+2;LexerCore.prototype.ALPHA=LexerCore.prototype.END+3;LexerCore.prototype.BACKSLASH=92;LexerCore.prototype.QUOTE=39;LexerCore.prototype.AT=64;LexerCore.prototype.SP=32;
LexerCore.prototype.HT=9;LexerCore.prototype.COLON=58;LexerCore.prototype.STAR=42;LexerCore.prototype.DOLLAR=36;LexerCore.prototype.PLUS=43;LexerCore.prototype.POUND=35;LexerCore.prototype.MINUS=45;LexerCore.prototype.DOUBLEQUOTE=34;LexerCore.prototype.TILDE=126;LexerCore.prototype.BACK_QUOTE=96;LexerCore.prototype.NULL=0;LexerCore.prototype.EQUALS=61;LexerCore.prototype.SEMICOLON=59;LexerCore.prototype.SLASH=47;LexerCore.prototype.L_SQUARE_BRACKET=91;LexerCore.prototype.R_SQUARE_BRACKET=93;
LexerCore.prototype.R_CURLY=125;LexerCore.prototype.L_CURLY=123;LexerCore.prototype.HAT=94;LexerCore.prototype.BAR=124;LexerCore.prototype.DOT=46;LexerCore.prototype.EXCLAMATION=33;LexerCore.prototype.LPAREN=40;LexerCore.prototype.RPAREN=41;LexerCore.prototype.GREATER_THAN=62;LexerCore.prototype.LESS_THAN=60;LexerCore.prototype.PERCENT=37;LexerCore.prototype.QUESTION=63;LexerCore.prototype.AND=38;LexerCore.prototype.UNDERSCORE=95;LexerCore.prototype.ALPHA_VALID_CHARS=String.fromCharCode(65535);
LexerCore.prototype.DIGIT_VALID_CHARS=String.fromCharCode(65534);LexerCore.prototype.ALPHADIGIT_VALID_CHARS=String.fromCharCode(65533);LexerCore.prototype.addKeyword=function(a,b){this.currentLexer=this.put(this.currentLexer,a,b);for(var c=null,d=0;d<this.globalSymbolTable.length;d++)this.globalSymbolTable[d]==b&&(c=0);null==c&&(this.globalSymbolTable=this.put(this.globalSymbolTable,b,a))};
LexerCore.prototype.lookupToken=function(a){var b=null;if(a>this.START){for(var c=0;c<this.globalSymbolTable.length;c++)this.globalSymbolTable[c][0]==a&&(b=this.globalSymbolTable[c][1]);return b}return a};LexerCore.prototype.addLexer=function(a){for(var b=null,c=0;c<this.lexerTables.length;c++)this.lexerTables[c][0]==a&&(b=this.lexerTables[c][1]);this.currentLexer=b;null==this.currentLexer&&(this.currentLexer=[],this.lexerTables=this.put(this.lexerTables,a,this.currentLexer));return this.currentLexer};
LexerCore.prototype.selectLexer=function(a){this.currentLexerName=a};LexerCore.prototype.peekNextId=function(){var a=this.ptr,b=this.ttoken();this.savedPtr=this.ptr;this.ptr=a;return b};LexerCore.prototype.getNextId=function(){return this.ttoken()};
LexerCore.prototype.getNextToken=function(){if(0!=arguments.length){for(var a=arguments[0],b=this.ptr;this.hasMoreChars();){var c=this.lookAhead(0);if(c==a)break;else if(""==c)throw console.error("LexerCore:getNextToken(): EOL reached"),"LexerCore:getNextToken(): EOL reached";this.consume(1)}return this.buffer.substring(b,this.ptr)}return this.currentMatch};
LexerCore.prototype.peekNextToken=function(a){if(null==a)return this.peekNextToken(1)[0];for(var b=this.ptr,c=[],d=0;d<a;d++){var e=new Token;if(this.startsId()){var f=this.ttoken();e.tokenValue=f;f=f.toUpperCase();for(var g=null,h=0;h<this.currentLexer.length;h++)this.currentLexer[h][0]==f&&(g=h);e.tokenType=null!=g?this.currentLexer[g][1]:this.ID}else f=this.getNextChar(),e.tokenValue=f,this.isAlpha(f)?e.tokenType=this.ALPHA:this.isDigit(f)?e.tokenType=this.DIGIT:e.tokenType=f;c[d]=e}this.savedPtr=
this.ptr;this.ptr=b;return c};
LexerCore.prototype.match=function(a){if(a>this.START&&a<this.END)if(a==this.ID){if(!this.startsId())throw console.error("LexerCore:match(): "+this.buffer+"\nID expected",this.ptr),"LexerCore:match(): ID expected";a=this.getNextId();this.currentMatch=new Token;this.currentMatch.tokenValue=a;this.currentMatch.tokenType=this.ID}else if(a==this.SAFE){if(!this.startsSafeToken())throw console.error("LexerCore:match(): "+this.buffer+"\nID expected",this.ptr),"LexerCore:match(): ID expected";a=this.ttokenSafe();
this.currentMatch=new Token;this.currentMatch.tokenValue=a;this.currentMatch.tokenType=this.SAFE}else{for(var b=this.getNextId(),c=null,d=0;d<this.currentLexer.length;d++)this.currentLexer[d][0]==b.toUpperCase()&&(c=d);c=null==c?null:this.currentLexer[c][1];if(null==c||c!=a)throw console.error("LexerCore:match(): "+this.buffer+"\nUnexpected Token : "+b),"LexerCore:match(): unexpected Token";this.currentMatch=new Token;this.currentMatch.tokenValue=b;this.currentMatch.tokenType=a}else if(a>this.END)if(b=
this.lookAhead(0),a==this.DIGIT){if(!this.isDigit(b))throw console.error("LexerCore:match(): "+this.buffer+"\nExpecting DIGIT",this.ptr),"LexerCore:match(): Expecting DIGIT";this.currentMatch=new Token;this.currentMatch.tokenValue=b;this.currentMatch.tokenType=a;this.consume(1)}else{if(a==this.ALPHA){if(!this.isAlpha(b))throw console.error("LexerCore:match(): "+this.buffer+"\nExpecting ALPHA",this.ptr),"LexerCore:match(): Expecting ALPHA";this.currentMatch=new Token;this.currentMatch.tokenValue=b;
this.currentMatch.tokenType=a;this.consume(1)}}else if(b=this.lookAhead(0),b==a)this.consume(1);else throw console.error("LexerCore:match(): "+this.buffer+"\nExpecting  >>>"+a+"<<< got >>>"+b+"<<<"),"LexerCore:match(): expecting  >>>"+a+"<<< got >>>"+b+"<<<";return this.currentMatch};LexerCore.prototype.SPorHT=function(){for(var a=this.lookAhead(0);" "==a||"\t"==a;)this.consume(1),a=this.lookAhead(0)};
LexerCore.prototype.isTokenChar=function(a){if(this.isAlphaDigit(a))return!0;switch(a){case "-":case ".":case "!":case "%":case "*":case "_":case "+":case "`":case "'":case "~":return!0;default:return!1}};LexerCore.prototype.startsId=function(){var a=this.lookAhead(0);return this.isTokenChar(a)};
LexerCore.prototype.startsSafeToken=function(){var a=lookAhead(0);if(this.isAlphaDigit(a))return!0;switch(a){case "_":case "+":case "-":case "!":case "`":case "'":case ".":case "/":case "}":case "{":case "]":case "[":case "^":case "|":case "~":case "%":case "#":case "@":case "$":case ":":case ";":case "?":case '"':case "*":case "=":return!0;default:return!1}};
LexerCore.prototype.ttoken=function(){for(var a=this.ptr;this.hasMoreChars();){var b=this.lookAhead(0);if(this.isTokenChar(b))this.consume(1);else break}return this.buffer.substring(a,this.ptr)};
LexerCore.prototype.ttokenSafe=function(){for(var a=this.ptr;this.hasMoreChars();){var b=this.lookAhead(0);if(this.isAlphaDigit(b))this.consume(1);else{var c=!1;switch(b){case "_":case "+":case "-":case "!":case "`":case "'":case ".":case "/":case "}":case "{":case "]":case "[":case "^":case "|":case "~":case "%":case "#":case "@":case "$":case ":":case ";":case "?":case '"':case "*":c=!0}if(c)this.consume(1);else break}}return this.buffer.substring(a,this.ptr)};
LexerCore.prototype.consumeValidChars=function(a){for(var b=a.length;this.hasMoreChars();){for(var c=this.lookAhead(0),d=!1,e=0;e<b;e++){d=a[e];switch(d){case this.ALPHA_VALID_CHARS:d=this.isAlpha(c);break;case this.DIGIT_VALID_CHARS:d=this.isDigit(c);break;case this.ALPHADIGIT_VALID_CHARS:d=this.isAlphaDigit(c);break;default:d=c==d}if(d)break}if(d)this.consume(1);else break}};
LexerCore.prototype.quotedString=function(){var a=this.ptr+1;if('"'!=this.lookAhead(0))return null;for(this.consume(1);this.hasMoreChars();){var b=this.getNextChar();if('"'==b)break;else{if(""==b)throw console.error("LexerCore:quotedString(): "+this.buffer+" :unexpected EOL",this.ptr),"LexerCore:quotedString(): unexpected EOL";"\\"==b&&this.consume(1)}}return this.buffer.substring(a,this.ptr-1)};
LexerCore.prototype.comment=function(){var a="";if("("!=this.lookAhead(0))return null;for(this.consume(1);this.hasMoreChars();){var b=this.getNextChar();if(")"==b)break;else{if(""==b)throw console.error("LexerCore:comment(): "+this.buffer+" :unexpected EOL",this.ptr),"LexerCore:comment(): unexpected EOL";if("\\"==b&&(a+=b,b=this.getNextChar(),""==b))throw console.error("LexerCore:comment(): "+this.buffer+" :unexpected EOL",this.ptr),"LexerCore:comment(): unexpected EOL";a+=b}}return a.toString()};
LexerCore.prototype.byteStringNoSemicolon=function(){for(var a="";this.hasMoreChars();){var b=this.lookAhead(0);if(""==b||"\n"==b||";"==b||","==b)break;else this.consume(1),a+=b}return a.toString()};LexerCore.prototype.byteStringNoWhiteSpace=function(){for(var a="";this.hasMoreChars();){var b=this.lookAhead(0);if(""==b||"\n"==b||" "==b)break;else this.consume(1),a+=b}return a.toString()};
LexerCore.prototype.byteStringNoSlash=function(){for(var a="";this.hasMoreChars();){var b=this.lookAhead(0);if(""==b||"\n"==b||"/"==b)break;else this.consume(1),a+=b}return a.toString()};LexerCore.prototype.byteStringNoComma=function(){for(var a="";this.hasMoreChars();){var b=this.lookAhead(0);if("\n"==b||","==b)break;else this.consume(1),a+=b}return a.toString()};
LexerCore.prototype.charAsString=function(a){if("string"==typeof a)return a;if("number"==typeof a)return this.buffer.substring(this.ptr,this.ptr+a)};
LexerCore.prototype.number=function(){var a=this.ptr;if(!this.isDigit(this.lookAhead(0)))throw console.error(this.buffer+"LexerCore:number(): Unexpected token at "+this.lookAhead(0),this.ptr),"LexerCore:number(): Unexpected token at "+this.lookAhead(0);for(this.consume(1);this.hasMoreChars();){var b=this.lookAhead(0);if(this.isDigit(b))this.consume(1);else break}return this.buffer.substring(a,this.ptr)};LexerCore.prototype.markInputPosition=function(){return this.ptr};
LexerCore.prototype.rewindInputPosition=function(a){this.ptr=a};LexerCore.prototype.getRest=function(){return this.ptr>=this.buffer.length?null:this.buffer.substring(this.ptr)};
LexerCore.prototype.getString=function(a){for(var b="";this.hasMoreChars();){var c=this.lookAhead(0);if(""==c)throw console.error(this.buffer+"LexerCore:getString(): unexpected EOL",this.ptr),"LexerCore:getString(): unexpected EOL";if(c==a){this.consume(1);break}else if("\\"==c){this.consume(1);c=this.lookAhead(0);if(""==c)throw console.error(this.buffer+"LexerCore:getString(): unexpected EOL",this.ptr),"LexerCore:getString(): unexpected EOL";this.consume(1);b+=c}else this.consume(1),b+=c}return b.toString()};
LexerCore.prototype.getPtr=function(){return this.ptr};LexerCore.prototype.getBuffer=function(){return this.buffer};LexerCore.prototype.put=function(a,b,c){for(var d=0,e=0;e<a.length;e++){var f=a[e][0];if(f==b){d=1;var g=[];g[0]=f;g[1]=c;a[e]=g}}0==d&&(g=[],g[0]=b,g[1]=c,a.push(g));return a};function ParserCore(){this.classname="ParserCore";this.lexer=this.nesting_level=null}
ParserCore.prototype.nameValue=function(a){if(null==a){var b=this.nameValue("=");return b}this.lexer.match(LexerCore.prototype.ID);var c=this.lexer.getNextToken();this.lexer.SPorHT();try{var d=!1;if(this.lexer.lookAhead(0)==a){this.lexer.consume(1);this.lexer.SPorHT();a=null;var e=!1;'"'==this.lexer.lookAhead(0)?(a=this.lexer.quotedString(),d=!0):(this.lexer.match(LexerCore.prototype.ID),a=this.lexer.getNextToken().tokenValue,null==a&&(a="",e=!0));b=new NameValue(c.tokenValue,a,e);d&&b.setQuotedValue()}else b=
new NameValue(c.tokenValue,"",!0);return b}catch(f){return console.error("ParserCore:nameValue(): catched exception:"+f),b=new NameValue(c.tokenValue,null,!1)}};function HostNameParser(a){this.classname="HostNameParser";this.lexer=null;this.stripAddressScopeZones=!1;"string"==typeof a?this.lexer=new LexerCore("charLexer",a):"object"==typeof a&&(this.lexer=a,this.lexer.selectLexer("charLexer"))}HostNameParser.prototype=new ParserCore;HostNameParser.prototype.constructor=HostNameParser;
HostNameParser.prototype.VALID_DOMAIN_LABEL_CHAR=[LexerCore.prototype.ALPHADIGIT_VALID_CHARS,"-","."];HostNameParser.prototype.consumeDomainLabel=function(){this.lexer.consumeValidChars(this.VALID_DOMAIN_LABEL_CHAR)};HostNameParser.prototype.ipv6Reference=function(){};
HostNameParser.prototype.host=function(){if("["==this.lexer.lookAhead(0))var a=this.ipv6Reference();else a=this.lexer.getPtr(),this.consumeDomainLabel(),a=this.lexer.getBuffer().substring(a,this.lexer.getPtr());if(0==a.length)throw console.error("Parser:host():"+this.lexer.getBuffer()+" missing host name",this.lexer.getPtr()),"Parser:host(): Missing host name";return new Host(a)};HostNameParser.prototype.isIPv6Address=function(){};
HostNameParser.prototype.hostPort=function(a){var b=this.host(),c=new HostPort;c.setHost(b);a&&this.lexer.SPorHT();if(this.lexer.hasMoreChars())switch(this.lexer.lookAhead(0)){case ":":this.lexer.consume(1);a&&this.lexer.SPorHT();try{var d=this.lexer.number();c.setPort(d)}catch(e){throw console.error("Parser:hostPort():"+this.lexer.getBuffer()+" : error parsing port ",this.lexer.getPtr()),"Parser:hostPort(): error parsing port";}break;case ",":case ";":case "?":case ">":case " ":case "\t":case "\r":case "\n":case "/":break;
case "%":if(this.stripAddressScopeZones)break;default:if(!a)throw console.error("Parser:hostPort(): "+this.lexer.getBuffer()+" illegal character in hostname:"+this.lexer.lookAhead(0),this.lexer.getPtr()),"Parser:hostPort(): error parsing port";}return c};function MessageDigestAlgorithm(){this.classname="MessageDigestAlgorithm";this.toHex="0123456789abcdef".split("");this.hexcase=0}
MessageDigestAlgorithm.prototype.calculateResponse=function(a,b,c,d,e,f,g,h,k,l){a=a+":"+b+":"+c;null==l||0==l.length||"auth"==l?g=g+":"+h:(null==k&&(k=""),g=g+":"+h+":"+this.H(k));return null==f||null==l||null==e||"auth"!=l&&"auth-int"!=l?this.KD(this.H(a),d+":"+this.H(g)):this.KD(this.H(a),d+":"+e+":"+f+":"+l+":"+this.H(g))};MessageDigestAlgorithm.prototype.H=function(a){return this.md5(a)};MessageDigestAlgorithm.prototype.KD=function(a,b){return this.H(a+":"+b)};
MessageDigestAlgorithm.prototype.toHexString=function(a){for(var b=0,c="",d=[],e=0;e<a.length;e++)d[b++]=this.toHex[a[e]>>4&15],c+=d[b],d[b++]=this.toHex[a[e]&15],c+=d[b];return c};MessageDigestAlgorithm.prototype.md5=function(a){return this.hex_md5(a)};MessageDigestAlgorithm.prototype.hex_md5=function(a){return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(a)))};MessageDigestAlgorithm.prototype.rstr_md5=function(a){return this.binl2rstr(this.binl_md5(this.rstr2binl(a),8*a.length))};
MessageDigestAlgorithm.prototype.rstr2hex=function(a){for(var b=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",c="",d,e=0;e<a.length;e++)d=a.charCodeAt(e),c+=b.charAt(d>>>4&15)+b.charAt(d&15);return c};
MessageDigestAlgorithm.prototype.str2rstr_utf8=function(a){for(var b="",c=-1,d,e;++c<a.length;)d=a.charCodeAt(c),e=c+1<a.length?a.charCodeAt(c+1):0,55296<=d&&56319>=d&&56320<=e&&57343>=e&&(d=65536+((d&1023)<<10)+(e&1023),c++),127>=d?b+=String.fromCharCode(d):2047>=d?b+=String.fromCharCode(192|d>>>6&31,128|d&63):65535>=d?b+=String.fromCharCode(224|d>>>12&15,128|d>>>6&63,128|d&63):2097151>=d&&(b+=String.fromCharCode(240|d>>>18&7,128|d>>>12&63,128|d>>>6&63,128|d&63));return b};
MessageDigestAlgorithm.prototype.rstr2binl=function(a){for(var b=Array(a.length>>2),c=0;c<b.length;c++)b[c]=0;for(c=0;c<8*a.length;c+=8)b[c>>5]|=(a.charCodeAt(c/8)&255)<<c%32;return b};MessageDigestAlgorithm.prototype.binl2rstr=function(a){for(var b="",c=0;c<32*a.length;c+=8)b+=String.fromCharCode(a[c>>5]>>>c%32&255);return b};
MessageDigestAlgorithm.prototype.binl_md5=function(a,b){a[b>>5]|=128<<b%32;a[(b+64>>>9<<4)+14]=b;b=1732584193;for(var c=-271733879,d=-1732584194,e=271733878,f=0;f<a.length;f+=16){var g=b,h=c,k=d,l=e;b=this.md5_ff(b,c,d,e,a[f+0],7,-680876936);e=this.md5_ff(e,b,c,d,a[f+1],12,-389564586);d=this.md5_ff(d,e,b,c,a[f+2],17,606105819);c=this.md5_ff(c,d,e,b,a[f+3],22,-1044525330);b=this.md5_ff(b,c,d,e,a[f+4],7,-176418897);e=this.md5_ff(e,b,c,d,a[f+5],12,1200080426);d=this.md5_ff(d,e,b,c,a[f+6],17,-1473231341);
c=this.md5_ff(c,d,e,b,a[f+7],22,-45705983);b=this.md5_ff(b,c,d,e,a[f+8],7,1770035416);e=this.md5_ff(e,b,c,d,a[f+9],12,-1958414417);d=this.md5_ff(d,e,b,c,a[f+10],17,-42063);c=this.md5_ff(c,d,e,b,a[f+11],22,-1990404162);b=this.md5_ff(b,c,d,e,a[f+12],7,1804603682);e=this.md5_ff(e,b,c,d,a[f+13],12,-40341101);d=this.md5_ff(d,e,b,c,a[f+14],17,-1502002290);c=this.md5_ff(c,d,e,b,a[f+15],22,1236535329);b=this.md5_gg(b,c,d,e,a[f+1],5,-165796510);e=this.md5_gg(e,b,c,d,a[f+6],9,-1069501632);d=this.md5_gg(d,e,
b,c,a[f+11],14,643717713);c=this.md5_gg(c,d,e,b,a[f+0],20,-373897302);b=this.md5_gg(b,c,d,e,a[f+5],5,-701558691);e=this.md5_gg(e,b,c,d,a[f+10],9,38016083);d=this.md5_gg(d,e,b,c,a[f+15],14,-660478335);c=this.md5_gg(c,d,e,b,a[f+4],20,-405537848);b=this.md5_gg(b,c,d,e,a[f+9],5,568446438);e=this.md5_gg(e,b,c,d,a[f+14],9,-1019803690);d=this.md5_gg(d,e,b,c,a[f+3],14,-187363961);c=this.md5_gg(c,d,e,b,a[f+8],20,1163531501);b=this.md5_gg(b,c,d,e,a[f+13],5,-1444681467);e=this.md5_gg(e,b,c,d,a[f+2],9,-51403784);
d=this.md5_gg(d,e,b,c,a[f+7],14,1735328473);c=this.md5_gg(c,d,e,b,a[f+12],20,-1926607734);b=this.md5_hh(b,c,d,e,a[f+5],4,-378558);e=this.md5_hh(e,b,c,d,a[f+8],11,-2022574463);d=this.md5_hh(d,e,b,c,a[f+11],16,1839030562);c=this.md5_hh(c,d,e,b,a[f+14],23,-35309556);b=this.md5_hh(b,c,d,e,a[f+1],4,-1530992060);e=this.md5_hh(e,b,c,d,a[f+4],11,1272893353);d=this.md5_hh(d,e,b,c,a[f+7],16,-155497632);c=this.md5_hh(c,d,e,b,a[f+10],23,-1094730640);b=this.md5_hh(b,c,d,e,a[f+13],4,681279174);e=this.md5_hh(e,
b,c,d,a[f+0],11,-358537222);d=this.md5_hh(d,e,b,c,a[f+3],16,-722521979);c=this.md5_hh(c,d,e,b,a[f+6],23,76029189);b=this.md5_hh(b,c,d,e,a[f+9],4,-640364487);e=this.md5_hh(e,b,c,d,a[f+12],11,-421815835);d=this.md5_hh(d,e,b,c,a[f+15],16,530742520);c=this.md5_hh(c,d,e,b,a[f+2],23,-995338651);b=this.md5_ii(b,c,d,e,a[f+0],6,-198630844);e=this.md5_ii(e,b,c,d,a[f+7],10,1126891415);d=this.md5_ii(d,e,b,c,a[f+14],15,-1416354905);c=this.md5_ii(c,d,e,b,a[f+5],21,-57434055);b=this.md5_ii(b,c,d,e,a[f+12],6,1700485571);
e=this.md5_ii(e,b,c,d,a[f+3],10,-1894986606);d=this.md5_ii(d,e,b,c,a[f+10],15,-1051523);c=this.md5_ii(c,d,e,b,a[f+1],21,-2054922799);b=this.md5_ii(b,c,d,e,a[f+8],6,1873313359);e=this.md5_ii(e,b,c,d,a[f+15],10,-30611744);d=this.md5_ii(d,e,b,c,a[f+6],15,-1560198380);c=this.md5_ii(c,d,e,b,a[f+13],21,1309151649);b=this.md5_ii(b,c,d,e,a[f+4],6,-145523070);e=this.md5_ii(e,b,c,d,a[f+11],10,-1120210379);d=this.md5_ii(d,e,b,c,a[f+2],15,718787259);c=this.md5_ii(c,d,e,b,a[f+9],21,-343485551);b=this.safe_add(b,
g);c=this.safe_add(c,h);d=this.safe_add(d,k);e=this.safe_add(e,l)}return[b,c,d,e]};MessageDigestAlgorithm.prototype.md5_cmn=function(a,b,c,d,e,f){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(b,a),this.safe_add(d,f)),e),c)};MessageDigestAlgorithm.prototype.md5_ff=function(a,b,c,d,e,f,g){return this.md5_cmn(b&c|~b&d,a,b,e,f,g)};MessageDigestAlgorithm.prototype.md5_gg=function(a,b,c,d,e,f,g){return this.md5_cmn(b&d|c&~d,a,b,e,f,g)};
MessageDigestAlgorithm.prototype.md5_hh=function(a,b,c,d,e,f,g){return this.md5_cmn(b^c^d,a,b,e,f,g)};MessageDigestAlgorithm.prototype.md5_ii=function(a,b,c,d,e,f,g){return this.md5_cmn(c^(b|~d),a,b,e,f,g)};MessageDigestAlgorithm.prototype.safe_add=function(a,b){var c=(a&65535)+(b&65535);return(a>>16)+(b>>16)+(c>>16)<<16|c&65535};MessageDigestAlgorithm.prototype.bit_rol=function(a,b){return a<<b|a>>>32-b};function Separators(){this.classname="Separators"}Separators.prototype.SEMICOLON=";";
Separators.prototype.COLON=":";Separators.prototype.COMMA=",";Separators.prototype.SLASH="/";Separators.prototype.SP=" ";Separators.prototype.EQUALS="=";Separators.prototype.STAR="*";Separators.prototype.NEWLINE="\r\n";Separators.prototype.RETURN="\n";Separators.prototype.LESS_THAN="<";Separators.prototype.GREATER_THAN=">";Separators.prototype.AT="@";Separators.prototype.DOT=".";Separators.prototype.QUESTION="?";Separators.prototype.POUND="#";Separators.prototype.AND="&";
Separators.prototype.LPAREN="(";Separators.prototype.RPAREN=")";Separators.prototype.DOUBLE_QUOTE='"';Separators.prototype.QUOTE="'";Separators.prototype.HT="\t";Separators.prototype.PERCENT="%";function SdpException(a){this.classname="SdpException";this.message="";1==arguments.length&&"string"==typeof arguments[0]&&(this.message+=arguments[0])}SdpException.prototype.constructor=SdpException;SdpException.prototype.getMessage=function(){return this.message};
function SDPObject(){this.classname="SDPObject"}SDPObject.prototype=new GenericObject;SDPObject.prototype.constructor=SDPObject;SDPObject.prototype.encode=function(){throw new SdpException("SDPObject:encode() not implemented");};SDPObject.prototype.toString=function(){return this.encode()};SDPObject.prototype.equals=function(a){throw new SdpException("SDPObject:equals() not implemented");};SDPObject.prototype.match=function(a){throw new SdpException("SDPObject:other() not implemented");};
SDPObject.prototype.clone=function(a){a=this.constructor==Object?new this.constructor:new this.constructor(this.valueOf());for(var b in this)a[b]!=this[b]&&(a[b]="object"==typeof this[b]?this[b].clone():this[b]);a.toString=this.toString;a.valueOf=this.valueOf;return a};function SDPField(){this.classname="SDPField";this.fieldName=null}SDPField.prototype=new SDPObject;SDPField.prototype.constructor=SDPField;SDPField.prototype.SESSION_NAME_FIELD="s=";SDPField.prototype.INFORMATION_FIELD="i=";
SDPField.prototype.EMAIL_FIELD="e=";SDPField.prototype.PHONE_FIELD="p=";SDPField.prototype.CONNECTION_FIELD="c=";SDPField.prototype.BANDWIDTH_FIELD="b=";SDPField.prototype.ORIGIN_FIELD="o=";SDPField.prototype.TIME_FIELD="t=";SDPField.prototype.KEY_FIELD="k=";SDPField.prototype.ATTRIBUTE_FIELD="a=";SDPField.prototype.VERSION_FIELD="v=";SDPField.prototype.URI_FIELD="u=";SDPField.prototype.MEDIA_FIELD="m=";SDPField.prototype.REPEAT_FIELD="r=";SDPField.prototype.ZONE_FIELD="z=";
SDPField.prototype.BASE64="base64";SDPField.prototype.PROMPT="prompt";SDPField.prototype.CLEAR="clear";SDPField.prototype.URI="URI";SDPField.prototype.IPV4="IP4";SDPField.prototype.IPV6="IP6";SDPField.prototype.IN="IN";SDPField.prototype.getFieldName=function(){return this.fieldName};SDPField.prototype.setFieldName=function(a){this.fieldName=a};SDPField.prototype.getTypeChar=function(){return null==this.fieldName?"":this.fieldName.charAt(0)};
function AttributeField(){this.classname="AttributeField";this.fieldName=this.ATTRIBUTE_FIELD;this.attribute=null}AttributeField.prototype=new SDPField;AttributeField.prototype.constructor=AttributeField;AttributeField.prototype.getName=function(){return null==this.attribute?null:this.attribute.getName()};
AttributeField.prototype.setName=function(a){if("string"==typeof a)null==this.attribute&&(this.attribute=new NameValue),this.attribute.setSeparator(Separators.prototype.COLON),this.attribute.setName(a);else throw new SdpException("AttributeField.setName() requires string object argument");};AttributeField.prototype.hasValue=function(){return null==this.attribute?!1:null==this.attribute.getValueAsObject()?!1:!0};
AttributeField.prototype.getValue=function(){if(null==this.attribute)return null;var a=this.attribute.getValueAsObject();return null==a?null:a instanceof String?a:a.toString()};AttributeField.prototype.setValue=function(a){null==this.attribute&&(this.attribute=new NameValue);this.attribute.setValueAsObject(a)};
AttributeField.prototype.encode=function(){if(null==this.attribute)throw new SdpException("AttributeField.encode() requires name/value");var a=this.ATTRIBUTE_FIELD;a+=this.attribute.encode();return a+=Separators.prototype.NEWLINE};AttributeField.prototype.equals=function(a){return a instanceof AttributeField?a.attribute.getName().toLowerCase()==this.attribute.getName().toLowerCase()&&this.attribute.getValueAsObject().equals(a.attribute.getValueAsObject()):!1};
function VersionField(){this.classname="VersionField";this.fieldName=this.VERSION_FIELD;this.version=0}VersionField.prototype=new SDPField;VersionField.prototype.constructor=VersionField;VersionField.prototype.getVersion=function(){return this.version};
VersionField.prototype.setVersion=function(a){if("number"==typeof a)if(0<=a)this.version=a;else throw new SdpException("VersionField.setVersion(): bad argument");else throw new SdpException("VersionField.setVersion(): requires number type argument");};VersionField.prototype.encode=function(){return this.VERSION_FIELD+this.version+Separators.prototype.NEWLINE};
function OriginField(){this.classname="OriginField";this.fieldName=this.ORIGIN_FIELD;this.userName=null;this.networkType=SDPField.prototype.IN;this.addressType=SDPField.prototype.IPV4;this.sessionVersion=this.sessionId=this.host=null}OriginField.prototype=new SDPField;OriginField.prototype.constructor=OriginField;OriginField.prototype.getUserName=function(){return this.userName};OriginField.prototype.getSessionId=function(){return new Number(this.sessionId)};
OriginField.prototype.getSessionVersion=function(){return new Number(this.sessionVersion)};OriginField.prototype.getNetworkType=function(){return this.networkType};OriginField.prototype.getAddressType=function(){return this.addressType};OriginField.prototype.getHost=function(){return this.host};OriginField.prototype.getAddress=function(){var a=this.getHost();return null==a?null:a.getAddress()};
OriginField.prototype.setSessionId=function(a){if("string"==typeof a||"number"==typeof a)this.sessionId="",this.sessionId+=a;else throw new SdpException("OriginField.setSessionId() requires string or number object argument");};OriginField.prototype.setSessionVersion=function(a){if("string"==typeof a||"number"==typeof a)this.sessionVersion="",this.sessionVersion+=a;else throw new SdpException("OriginField.setSessionVersion() requires string or number argument");};
OriginField.prototype.setNetworkType=function(a){if("string"==typeof a)this.networkType=a;else throw new SdpException("OriginField.setNetworkType() requires string argument");};OriginField.prototype.setAddressType=function(a){if("string"==typeof a)this.addressType=a;else throw new SdpException("OriginField.setAddressType() requires string argument");};
OriginField.prototype.setHost=function(a){if(a instanceof Host)this.host=a;else throw new SdpException("OriginField.setHost() requires Host object argument");};OriginField.prototype.setAddress=function(a){if("string"==typeof a){var b=this.getHost();null==b&&(b=new Host);b.setAddress(a);this.setHost(b)}else throw new SdpException("OriginField.setAddress() requires string argument");};
OriginField.prototype.setUserName=function(a){if("string"==typeof a)this.userName=a;else throw new SdpException("OriginField.setUserName() requires string argument");};
OriginField.prototype.encode=function(){if(null==this.host)throw new SdpException("OriginField.encode() requires host");if(null==this.userName)throw new SdpException("OriginField.encode() requires userName");if(null==this.sessionId)throw new SdpException("OriginField.encode() requires sessionId");if(null==this.sessionVersion)throw new SdpException("OriginField.encode() requires sessionVersion");var a="";null!=this.host&&(a=this.host.encode(),Host.prototype.isIPv6Address(a)&&(a=a.substring(1,a.length()-
1)));var b=this.ORIGIN_FIELD;b+=this.userName;b+=Separators.prototype.SP;b+=this.sessionId;b+=Separators.prototype.SP;b+=this.sessionVersion;b+=Separators.prototype.SP;b+=this.networkType;b+=Separators.prototype.SP;b+=this.addressType;b+=Separators.prototype.SP;return b=b+a+Separators.prototype.NEWLINE};
OriginField.prototype.clone=function(){var a=new OriginField;a.userName=this.userName;a.networkType=this.networkType;a.addressType=this.addressType;a.sessionId=this.sessionId;a.sessionVersion=this.sessionVersion;a.host=new Host(this.host.getAddress());return a};function SessionNameField(){this.classname="SessionNameField";this.fieldName=this.SESSION_NAME_FIELD;this.sessionName=null}SessionNameField.prototype=new SDPField;SessionNameField.prototype.constructor=SessionNameField;
SessionNameField.prototype.getSessionName=function(){return this.sessionName};SessionNameField.prototype.setSessionName=function(a){if("string"==typeof a)this.sessionName=a;else throw new SdpException("SessionNameField.setSessionName() requires string object argument");};SessionNameField.prototype.encode=function(){return this.SESSION_NAME_FIELD+this.sessionName+Separators.prototype.NEWLINE};
function InformationField(){this.classname="InformationField";this.fieldName=this.INFORMATION_FIELD;this.information=""}InformationField.prototype=new SDPField;InformationField.prototype.constructor=InformationField;InformationField.prototype.getInformation=function(){return this.information};InformationField.prototype.setInformation=function(a){if("string"==typeof a)this.information=a;else throw new SdpException("InformationField.setInformation() requires string type argument");};
InformationField.prototype.encode=function(){if(null==this.information)throw new SdpException("InformationField.encode() requires information");return this.INFORMATION_FIELD+this.information+Separators.prototype.NEWLINE};function URIField(){this.classname="URIField";this.fieldName=this.URI_FIELD;this.uri=""}URIField.prototype=new SDPField;URIField.prototype.constructor=URIField;URIField.prototype.getURI=function(){return this.uri};
URIField.prototype.setURI=function(a){if("string"==typeof a)this.uri=a;else throw new SdpException("URIField.setURI() requires string object argument");};URIField.prototype.encode=function(){if(null==this.uri)throw new SdpException("URIField.encode() requires uri");return this.URI_FIELD+this.uri+Separators.prototype.NEWLINE};function EmailField(){this.classname="EmailField";this.fieldName=this.EMAIL_FIELD;this.email=this.displayName=null}EmailField.prototype=new SDPField;
EmailField.prototype.constructor=EmailField;EmailField.prototype.getEmail=function(){return this.email};EmailField.prototype.getDisplayName=function(){return this.displayName};EmailField.prototype.setDisplayName=function(a){if("string"==typeof a)this.displayName=a;else throw new SdpException("EmailField.setDisplayName() requires string object argument");};
EmailField.prototype.setEmail=function(a){if("string"==typeof a)this.email=a;else throw new SdpException("EmailField.setEmail() requires string object argument");};EmailField.prototype.encode=function(){if(null==this.email)throw new SdpException("PhoneField.encode() requires email");var a=null!=this.displayName?this.displayName+Separators.prototype.LESS_THAN:"";a+=this.email;null!=this.displayName&&(a+=Separators.prototype.GREATER_THAN);return a+=Separators.prototype.NEWLINE};
function PhoneField(){this.classname="PhoneField";this.fieldName=this.VERSION_FIELD;this.phoneNumber=this.name=null}PhoneField.prototype=new SDPField;PhoneField.prototype.constructor=PhoneField;OriginField.prototype.getName=function(){return this.name};PhoneField.prototype.getPhoneNumber=function(){return this.phoneNumber};PhoneField.prototype.setName=function(a){if("string"==typeof a)this.name=a;else throw new SdpException("PhoneField.setName(): requires number type argument");};
PhoneField.prototype.setPhoneNumber=function(a){if("string"==typeof a)this.phoneNumber=a;else throw new SdpException("PhoneField.setPhoneNumber(): requires number type argument");};PhoneField.prototype.encode=function(){if(null==this.phoneNumber)throw new SdpException("PhoneField.encode() requires phoneNumber");var a=this.PHONE_FIELD;null!=this.name&&(a+=this.name);a+=Separators.prototype.LESS_THAN;a+=this.phoneNumber;a+=Separators.prototype.GREATER_THAN;return a+=Separators.prototype.NEWLINE};
function TimeField(){this.classname="TimeField";this.fieldName=this.TIME_FIELD;this.stopTime=this.startTime=0}TimeField.prototype=new SDPField;TimeField.prototype.constructor=TimeField;TimeField.prototype.getStartTime=function(){return this.startTime};TimeField.prototype.getStopTime=function(){return this.stopTime};TimeField.prototype.setStartTime=function(a){if("number"==typeof a)this.startTime=a;else throw new SdpException("TimeField.setStartTime() requires string type argument");};
TimeField.prototype.setStopTime=function(a){if("number"==typeof a)this.startTime=a;else throw new SdpException("TimeField.setStopTime() requires string type argument");};TimeField.prototype.getTypedTime=function(){return!1};TimeField.prototype.setTypedTime=function(a){};TimeField.prototype.isZero=function(){return 0==this.getStartTime()&&0==this.getStopTime()};TimeField.prototype.setZero=function(){this.setStopTime(0);this.setStartTime(0)};
TimeField.prototype.encode=function(){var a=this.TIME_FIELD;a+=this.startTime;a+=Separators.prototype.SP;a+=this.stopTime;return a+=Separators.prototype.NEWLINE};function ConnectionAddress(){this.classname="ConnectionAddress";this.host=null;this.port=this.ttl=0}ConnectionAddress.prototype=new SDPObject;ConnectionAddress.prototype.constructor=ConnectionAddress;ConnectionAddress.prototype.getHost=function(){return this.host};ConnectionAddress.prototype.getTtl=function(){return this.ttl};
ConnectionAddress.prototype.getPort=function(){return this.port};ConnectionAddress.prototype.setHost=function(a){if(a instanceof Host)this.host=a;else throw new SdpException("ConnectionAddress.setHost() requires  Host object argument");};ConnectionAddress.prototype.setTtl=function(a){if("number"==typeof a)this.ttl=a;else throw new SdpException("ConnectionAddress.setTtl() requires  number object argument");};
ConnectionAddress.prototype.setPort=function(a){if("number"==typeof a)this.port=a;else throw new SdpException("ConnectionAddress.setPort() requires  number object argument");};
ConnectionAddress.prototype.encode=function(){if(null==this.host)throw new SdpException("ConnectionAddress.encode() requires host");var a=this.host.encode();Host.prototype.isIPv6Address(a)&&(a+=a.substring(1,a.length()-1));0!=this.ttl&&0!=this.port?a+=Separators.prototype.SLASH+this.ttl+Separators.prototype.SLASH+this.port:0!=this.ttl&&(a+=Separators.prototype.SLASH+this.ttl);return a};
ConnectionAddress.prototype.clone=function(){var a=new ConnectionAddress;null!=this.address&&(a.address=this.address.clone());a.ttl=this.ttl;a.port=this.port;return a};function ConnectionField(){this.classname="ConnectionField";this.fieldName=this.CONNECTION_FIELD;this.networkType=SDPField.prototype.IN;this.addressType=SDPField.prototype.IPV4;this.address=null}ConnectionField.prototype=new SDPField;ConnectionField.prototype.constructor=ConnectionField;ConnectionField.prototype.getNetworkType=function(){return this.networkType};
ConnectionField.prototype.getAddressType=function(){return this.addressType};ConnectionField.prototype.getAddress=function(){if(null==this.address)return null;var a=this.address.getAddress();return null==a?null:a.getAddress()};ConnectionField.prototype.setNetworkType=function(a){if("string"==typeof a)this.networkType=a;else throw new SdpException("ConnectionField.setNetworkType() requires string type argument");};
ConnectionField.prototype.setAddressType=function(a){if("string"==typeof a)this.addressType=a;else throw new SdpException("ConnectionField.setAddressType() requires string type argument");};
ConnectionField.prototype.setAddress=function(a){if(a instanceof ConnectionAddress)this.address=a;else if("string"==typeof a)if(null==this.address){this.address=new ConnectionAddress;var b=new Host(a);this.address.setHost(b)}else b=this.address.getHost(),null==b?(b=new Host(a),this.address.setAddress(b)):b.setAddress(a);else throw new SdpException("ConnectionField.setAddress() requires ConnectionAddress object or string argument");};
ConnectionField.prototype.encode=function(){if(null==this.address)throw new SdpException("ConnectionField.encode() requires address");var a=this.CONNECTION_FIELD;a+=this.networkType;a+=Separators.prototype.SP;a+=this.addressType;a+=Separators.prototype.SP;a+=this.address.encode();return a+=Separators.prototype.NEWLINE};
ConnectionField.prototype.clone=function(){var a=new ConnectionField;null!=this.address&&(a.address=this.address.clone());a.networkType=this.networkType;a.addressType=this.addressType;return a};function KeyField(){this.classname="KeyField";this.fieldName=this.KEY_FIELD;this.key=this.method=null}KeyField.prototype=new SDPField;KeyField.prototype.constructor=KeyField;KeyField.prototype.getMethod=function(){return this.method};KeyField.prototype.getKey=function(){return this.key};
KeyField.prototype.setMethod=function(a){if("string"==typeof a)this.method=a;else throw new SdpException("KeyField.setMethod() requires string object argument");};KeyField.prototype.setKey=function(a){if("string"==typeof a)this.key=a;else throw new SdpException("KeyField.setKey() requires string object argument");};
KeyField.prototype.encode=function(){if(null==this.method)throw new SdpException("KeyField.encode() requires method");if(null==this.key)throw new SdpException("KeyField.encode() requires key");var a=this.KEY_FIELD;a+=this.method;a+=Separators.prototype.COLON;a+=this.key;return a+=Separators.prototype.NEWLINE};function MediaField(){this.classname="MediaField";this.fieldName=this.MEDIA_FIELD;this.type=null;this.port=-1;this.nports=0;this.protocol=null;this.formatArray=[]}MediaField.prototype=new SDPField;
MediaField.prototype.constructor=MediaField;MediaField.prototype.getType=function(){return this.type};MediaField.prototype.getPort=function(){return this.port};MediaField.prototype.getNports=function(){return this.nports};MediaField.prototype.getProtocol=function(){return this.protocol};MediaField.prototype.getFormats=function(){return this.formatArray};
MediaField.prototype.setType=function(a){if("string"==typeof a)this.type=a.toLowerCase();else throw new SdpException("MediaField.setMedia() requires string object argument");};MediaField.prototype.setPort=function(a){if("number"==typeof a){if(0>a)throw new SdpException("MediaField.setPort() requires number > 0 object argument");this.port=a}else throw new SdpException("MediaField.setPort() requires number object argument");};
MediaField.prototype.setNports=function(a){if("number"==typeof a){if(0>a)throw new SdpException("MediaField.setNports() requires number > 0 object argument");this.nports=a}else throw new SdpException("MediaField.setNports() requires number object argument");};MediaField.prototype.setProtocol=function(a){if("string"==typeof a)this.protocol=a;else throw new SdpException("MediaField.setProtocol() requires string object argument");};
MediaField.prototype.setFormats=function(a){if(a instanceof Array)this.formatArray=a;else throw new SdpException("MediaField.setFormats() requires Array object argument");};MediaField.prototype.getFormats=function(a){if("boolean"==typeof a)return a&&null==this.formatArray&&(this.formatArray=[]),this.formatArray;throw new SdpException("MediaField.getFormats() requires boolean object argument");};
MediaField.prototype.encodeFormats=function(){for(var a="",b=0;b<this.formatArray.length;b++)a+=this.formatArray[b],b<this.formatArray.length-1&&(a+=Separators.prototype.SP);return a};
MediaField.prototype.encode=function(){if(null==this.type)throw new SdpException("MediaField.encode() requires type");if(null==this.protocol)throw new SdpException("MediaField.encode() requires protocol");if(null==this.formatArray)throw new SdpException("MediaField.encode() requires format");var a=this.MEDIA_FIELD;a+=this.type+Separators.prototype.SP+this.port;1<this.nports&&(a+=Separators.prototype.SLASH+this.nports);a+=Separators.prototype.SP+this.protocol;a+=Separators.prototype.SP+this.encodeFormats();
return a+=Separators.prototype.NEWLINE};MediaField.prototype.clone=function(){var a=new MediaField;a.media=this.type;a.port=this.port;a.nports=this.nports;a.proto=this.protocol;a.formats=[];if(null!=this.formatArray)for(var b=0;b<this.formatArray.length;b++)a.formats[b]=this.formatArray[b];return a};function AttributeField(){this.classname="AttributeField";this.fieldName=this.ATTRIBUTE_FIELD;this.attribute=null}AttributeField.prototype=new SDPField;AttributeField.prototype.constructor=AttributeField;
AttributeField.prototype.getName=function(){return null==this.attribute?null:this.attribute.getName()};AttributeField.prototype.setName=function(a){if("string"==typeof a)null==this.attribute&&(this.attribute=new NameValue),this.attribute.setSeparator(Separators.prototype.COLON),this.attribute.setName(a);else throw new SdpException("AttributeField.setName() requires string object argument");};
AttributeField.prototype.hasValue=function(){return null==this.attribute?!1:null==this.attribute.getValueAsObject()?!1:!0};AttributeField.prototype.getValue=function(){if(null==this.attribute)return null;var a=this.attribute.getValueAsObject();return null==a?null:a instanceof String?a:a.toString()};AttributeField.prototype.setValue=function(a){null==this.attribute&&(this.attribute=new NameValue);this.attribute.setValueAsObject(a)};
AttributeField.prototype.encode=function(){if(null==this.attribute)throw new SdpException("AttributeField.encode() requires name/value");var a=this.ATTRIBUTE_FIELD;a+=this.attribute.encode();return a+=Separators.prototype.NEWLINE};AttributeField.prototype.equals=function(a){return a instanceof AttributeField?a.attribute.getName().toLowerCase()==this.attribute.getName().toLowerCase()&&this.attribute.getValueAsObject().equals(a.attribute.getValueAsObject()):!1};
function BandwidthField(){this.classname="BandwidthField";this.fieldName=this.BANDWDTH_FIELD;this.type="AS";this.bandwidth=null}BandwidthField.prototype=new SDPField;BandwidthField.prototype.constructor=BandwidthField;BandwidthField.prototype.getType=function(){return this.type};BandwidthField.prototype.getBandwidth=function(){return this.bandwidth};
BandwidthField.prototype.setType=function(a){if("string"==typeof a)this.type=a;else throw new SdpException("BandwidthField.setType() requires string object argument");};BandwidthField.prototype.setBandwidth=function(a){if("number"==typeof a)this.bandwidth=a;else throw new SdpException("BandwidthField.setBandwidth() requires number object argument");};
BandwidthField.prototype.encode=function(){if(null==this.bandwidth)throw new SdpException("BandwidthField.encode() requires valid bandwidth value");var a=this.BANDWIDTH_FIELD;a+=this.type;a+=Separators.prototype.COLON;a+=this.bandwidth;return a+=Separators.prototype.NEWLINE};function TypedTime(){this.classname="TypedTime";this.unit="";this.time=0}TypedTime.prototype=new SDPObject;TypedTime.prototype.constructor=TypedTime;
TypedTime.prototype.setTime=function(a){if("number"==typeof a)this.time=a;else throw new SdpException("TypedTime.prototype.setTime() requires a number argument");};TypedTime.prototype.getTime=function(){return this.time};TypedTime.prototype.setUnit=function(a){if("string"==typeof a)this.unit=a;else throw new SdpException("TypedTime.prototype.setUnit() requires string argument ");};TypedTime.prototype.getUnit=function(){return this.unit};
TypedTime.prototype.encode=function(){var a=""+this.time;null!=this.unit&&(a+=this.unit);return a};function RepeatField(){this.classname="RepeatField";this.fieldName=this.REPEAT_FIELD;this.activeDuration=this.repeatInterval=null;this.offsets=[]}RepeatField.prototype=new SDPField;RepeatField.prototype.constructor=RepeatField;
RepeatField.prototype.setRepeatInterval=function(a){if(a instanceof TypedTime)this.repeatInterval=a;else if("number"==typeof a){if(0>a)throw new SdpException("RepeatField.setRepeatInterval() requires positive number object argument");null==this.repeatInterval&&(this.repeatInterval=new TypedTime);this.repeatInterval.setTime(a)}else throw SdpException("RepeatField.setRepeatInterval() requires number or TypedTime object argument");};
RepeatField.prototype.setActiveDuration=function(a){if(a instanceof TypedTime)this.activeDuration=a;else if("number"==typeof a){if(0>a)throw new SdpException("RepeatField.setActiveDuration() requires positive number object argument");null==this.activeDuration&&(this.activeDuration=new TypedTime);this.activeDuration.setTime(a)}else throw SdpException("RepeatField.setActiveDuration() requires number or TypedTime object argument");};
RepeatField.prototype.addOffset=function(a){if(a instanceof TypedTime)this.offsets.push(a);else throw SdpException("RepeatField.addOffset() requires TypedTime object argument");};RepeatField.prototype.getOffsets=function(){return this.offsets};RepeatField.prototype.getRepeatInterval=function(){return null==this.repeatInterval?-1:this.repeatInterval.getTime()};RepeatField.prototype.getActiveDuration=function(){return null==this.activeDuration?-1:this.activeDuration.getTime()};
RepeatField.prototype.getOffsetArray=function(){for(var a=[],b=0;b<this.offsets.length;b++)a[b]=this.offsets[b].getTime();return a};RepeatField.prototype.setOffsetArray=function(a){if(a instanceof Array)for(var b=0;b<this.offsets.length;b++){var c=new TypedTime;c.setTime(a[b]);this.addOffset(c)}else throw SdpException("RepeatField.setOffsetArray() requires Array object argument");};RepeatField.prototype.getTypedTime=function(){return!0};RepeatField.prototype.setTypedTime=function(a){};
RepeatField.prototype.encode=function(a){a=this.REPEAT_FIELD;a+=this.repeatInterval.encode();a+=Separators.prototype.SP;a+=this.activeDuration.encode();for(var b=0;b<this.offsets.length;b++){var c=this.offsets[b];a+=Separators.prototype.SP;a+=c.encode()}return a+=Separators.prototype.NEWLINE};
RepeatField.prototype.clone=function(){var a=new RepeatField;null!=this.repeatInterval&&(a.repeatInterval=this.repeatInterval.clone());null!=this.activeDuration&&(a.activeDuration=this.activeDuration.clone());null!=this.offsets&&(a.offsets=this.offsets.clone());return a};function MediaDescription(){this.classname="MediaDescription";this.keyField=this.connectionField=this.informationField=this.mediaField=null;this.bandwidthFieldArray=[];this.attributeFieldArray=[]}
MediaDescription.prototype.constructor=MediaDescription;
MediaDescription.prototype.encode=function(){var a="";null!=this.mediaField&&(a+=this.mediaField.encode());null!=this.informationField&&(a+=this.informationField.encode());null!=this.connectionField&&(a+=this.connectionField.encode());if(null!=this.bandwidthFieldArray)for(var b=0;b<this.bandwidthFieldArray.length;b++)a+=this.bandwidthFieldArray[b].encode();null!=this.keyField&&(a+=this.keyField.encode());if(null!=this.attributeFieldArray)for(b=0;b<this.attributeFieldArray.length;b++)a+=this.attributeFieldArray[b].encode();
return a};MediaDescription.prototype.toString=function(){return this.encode()};MediaDescription.prototype.getMedia=function(){return this.mediaField};MediaDescription.prototype.getInfo=function(){return this.informationField};MediaDescription.prototype.getConnection=function(){return this.connectionField};MediaDescription.prototype.getKey=function(){return this.keyField};MediaDescription.prototype.getAttributes=function(){return this.attributeFieldArray};
MediaDescription.prototype.getAttribute=function(a){if("string"==typeof a){for(var b=0;b<this.attributeFieldArray.length;b++)if(a==this.attributeFieldArray[b].getAttribute().getName())return this.attributeFieldArray[b].getAttribute().getValueAsObject();return null}throw new SdpException("MediaDescription.getAttribute() requires string object argument");};
MediaDescription.prototype.setMedia=function(a){if(a instanceof MediaField)this.mediaField=a;else throw new SdpException("MediaDescription.setMedia() requires Mediafield object argument");};MediaDescription.prototype.setInfo=function(a){if(a instanceof InformationField)this.informationField=a;else throw new SdpException("MediaDescription.setInfo() requires InformationField object argument");};
MediaDescription.prototype.setConnection=function(a){if(a instanceof ConnectionField)this.connectionField=a;else throw new SdpException("MediaDescription.setConnection() requires ConnectionField object argument");};MediaDescription.prototype.addBandwidth=function(a){if(a instanceof BandwidthField)this.bandwidthFieldArray.push(a);else throw new SdpException("MediaDescription.addBandwidth() requires BandwidthField object argument");};
MediaDescription.prototype.setKey=function(a){if(a instanceof KeyField)this.keyField=a;else throw new SdpException("MediaDescription.setKey() requires KeyField object argument");};
MediaDescription.prototype.setAttributes=function(a){if(a instanceof Array){for(var b=0;b<a.length;b++)if(!(a[b]instanceof AttributeField))throw new SdpException("MediaDescription.setAttributes() requires Array of AttributeField object argument");this.attributeFieldArray=a}else throw new SdpException("MediaDescription.setAttributes() requires Array object argument");};
MediaDescription.prototype.addAttribute=function(a){if(a instanceof AttributeField)this.attributeFieldArray.push(a);else throw new SdpException("MediaDescription.addAttribute()requires AttributeField object argument");};
MediaDescription.prototype.hasAttribute=function(a){if("string"==typeof a){for(var b=0;b<this.attributeFieldArray.length;b++)if(this.attributeFieldArray[b].getName()==a)return!0;return!1}throw new SdpException("MediaDescription.hasAttribute()requires string object name argument");};
MediaDescription.prototype.setAttribute=function(a,b){if("string"==typeof a){var c=new AttributeField;c.setName(a);c.setValue(b);this.attributeFieldArray.push(c)}else throw new SdpException("MediaDescription.setAttribute()requires string object name argument");};
MediaDescription.prototype.getBandwidth=function(a){if("string"==typeof a){if(null!=this.bandwidthFieldArray)for(var b=0;b<this.bandwidthFieldArray.length;b++)if(this.bandwidthFieldArray[b].getType()==a)return this.bandwidthFieldArray.getBandwidth();return-1}throw new SdpException("MediaDescription.getBandwidth() requires string object name argument");};
MediaDescription.prototype.setBandwidth=function(a,b){if("string"==typeof a)if("number"==typeof b){for(var c=0;c<this.bandwidthFieldArray.length;c++)if(this.bandwidthFieldArray[c].getType()==a){this.bandwidthFieldArray[c].setBandwidth(b);return}c=new BandwidthField;c.setType(a);c.setBandwidth(b);this.bandwidthFieldArray.push(c)}else throw new SdpException("MediaDescription.setBandwidth() requires number object value argument");else throw new SdpException("MediaDescription.setBandwidth() requires string object name argument");
};MediaDescription.prototype.removeBandwidth=function(a){if("string"==typeof a&&null!=this.bandwidthFieldArray)for(var b=0;b<this.bandwidthFieldArray.length;b++)if(this.bandwidthFieldArray[b].getType()==a){this.bandwidthFieldArray.splice(b,1);break}};MediaDescription.prototype.getDuplexity=function(){for(var a=0;a<this.attributeFieldArray.length;a++){var b=this.attributeFieldArray[a].getAttribute().getName().toLowerCase();if("sendrecv"==b||"recvonly"==b||"sendonly"==b||"inactive"==b)return b}return null};
MediaDescription.prototype.setDuplexity=function(a){if("string"==typeof a){for(var b=0;b<this.attributeFieldArray.length;b++){var c=this.attributeFieldArray[b].getName().toLowerCase();if("sendrecv"==c||"recvonly"==c||"sendonly"==c||"inactive"==c)return}b=new AttributeField;b.setName(a);b.setValue(null);this.attributeFieldArray.push(b)}else throw new SdpException("MediaDescription.setDuplexity() requires string object duplexity argument");};
MediaDescription.prototype.removeAttribute=function(a){if("string"==typeof a){if(null!=this.attributeFieldArray)for(var b=0;b<this.attributeFieldArray.length;b++)if(this.attributeFieldArray[b].getName()==a){this.attributeFieldArray.slice(b,1);break}}else throw new SdpException("MediaDescription.removeAttribute() requires string object argument");};
MediaDescription.prototype.getMimeTypes=function(){var a=this.getMedia();if(null!=a){var b=a.getMediaType(),c=a.getProtocol();a=a.getMediaFormats(!1);for(var d=[],e=0;e<a.length;e++){var f=null;"RTP/AVP"==c?null!=this.getAttribute(SdpConstants.RTPMAP)&&(f=b+"/"+c):f=b+"/"+c;d.push(f)}return d}return null};
MediaDescription.prototype.getMimeParameters=function(){var a=[],b=this.getAttribute("rate");null!=b&&a.push(b);b=this.getAttribute("ptime");null!=b&&a.push(b);b=this.getAttribute("maxptime");null!=b&&a.push(b);b=this.getAttribute("ftmp");null!=b&&a.push(b);return a};
MediaDescription.prototype.addDynamicPayloads=function(a,b){if(a instanceof Array&&b instanceof Array){if(0==a.length||0==b.length)throw new SdpException("MediaDescription:addDynamicPayloads(): no dynamic payload");if(a.length!=b.length)throw new SdpException("MediaDescription:addDynamicPayloads(): missing payload parameters");for(var c=0;c<a.length;c++)this.setAttribute(a[c],b[c])}else throw new SdpException("MediaDescription.addDynamicPayloads() requires Array object arguments");};
MediaDescription.prototype.setPreconditionFields=function(a){this.preconditionFields.setPreconditions(a)};MediaDescription.prototype.setPreconditions=function(a){this.preconditionFields=a};MediaDescription.prototype.getPreconditionFields=function(){return this.preconditionFields.getPreconditions()};
function TimeDescription(){this.classname="TimeDescription";if(1==arguments.length)if(arguments[0]instanceof TimeField)this.timeField=arguments[0];else throw new SdpException("TimeDescription():TimeDescription() requires TimeField object in argument");else this.timeField=new TimeField;this.repeatList=[]}TimeDescription.prototype.getTime=function(){return this.timeField};
TimeDescription.prototype.setTime=function(a){if(a instanceof TimeField)this.timeField=a;else throw new SdpException("TimeDescription.setTime() requires TimeField object argument");};TimeDescription.prototype.getRepeatTimes=function(a){a&&(this.repeatList=[]);return this.repeatList};TimeDescription.prototype.setRepeatTimes=function(a){this.repeatList=a};
TimeDescription.prototype.addRepeat=function(a){if(a instanceof RepeatField)this.repeatList.push(a);else throw new SdpException("TimeDescription.addRepeat() requires RepeatField object argument");};TimeDescription.prototype.encode=function(){for(var a=this.timeField.encode(),b=0;b<this.repeatList.length;b++)a+=this.repeatList[b].encode();return a};
function SessionDescription(){this.classname="SessionDescription";this.attributeFieldArray=this.bandwidthFieldArray=this.phoneFieldArray=this.emailFieldArray=this.zoneAdjustments=this.mediaDescriptionArray=this.timeFieldArray=this.keyField=this.connectionField=this.uriField=this.informationField=this.sessionNameField=this.originField=this.versionField=this.currentMediaDescription=this.currentTimeDescription=null;if(1==arguments.length)if(arguments[0]instanceof SessionDescription)this.copy(arguments[0]);
else throw new SdpException("SessionDescription.SessionDescription() requires SessionDescription object arguments");}SessionDescription.prototype=new SDPObject;SessionDescription.prototype.constructor=SessionDescription;
SessionDescription.prototype.copy=function(a){if(null!=a){var b=a.getVersion();null!=b&&this.setVersion(b.clone());b=a.getOrigin();null!=b&&this.setOrigin(b.clone());b=a.getSessionName();null!=b&&this.setSessionName(b.clone());b=a.getInfo();null!=b&&this.setInfo(b.clone());b=a.getURI();if(null!=b){var c=new URIField;c.setURI(b.toString());this.setURI(c)}b=a.getConnection();null!=b&&this.setConnection(b.clone());b=a.getKey();null!=b&&this.setKey(b.clone());var d=a.getTimeDescriptions(!1);if(null!=
d){var e=[];for(b=0;b<d.length;b++){c=d[b];var f=c.getTime().clone();f=new TimeDescription(f);var g=c.getRepeatTimes(!1);if(null!=g)for(c=0;c<g.length;c++){var h=g[c].clone();f.addRepeatField(h)}e.push(f)}this.setTimes(e)}c=a.getEmails(!1);if(null!=c){d=[];for(b=0;b<c.length;b++)e=c[b].clone(),d.push(e);this.setEmails(d)}c=a.getPhones(!1);if(null!=c){d=[];for(b=0;b<c.length;b++)e=c[b].clone(),d.push(e);this.setPhones(d)}if(null!=a.getZoneAdjustments(!1)){c=[];for(b=0;b<c.length;b++)d=c[b].clone(),
c.push(d);this.setZoneAdjustments(c)}d=a.getBandwidths(!1);if(null!=d){e=[];for(b=0;b<d.length;b++)c=d[b].clone(),e.push(c);this.setBandwidths(e)}d=a.getAttributes(!1);if(null!=d){e=[];for(b=0;b<d.length;b++)c=d[b].clone(),e.push(c);this.setAttributes(e)}a=a.getMediaDescriptions(!1);if(null!=a){d=[];for(b=0;b<a.length;b++){f=a[b];e=new MediaDescription;c=f.getMedia();if(null!=c){g=new MediaField;g.setType(c.getType());g.setPort(c.getPort());g.setNports(c.getNports());g.setProto(c.getProto());h=c.getFormats();
if(null!=h){var k=[];for(c=0;c<h.length;c++)k.push(String.valueOf(h[c]));g.setFormats(k)}e.setMedia(g)}c=f.getInformation();null!=c&&e.setInformation(c.clone());c=f.getConnection();null!=c&&e.setConnection(c.clone());g=f.getBandwidths(!1);if(null!=g){h=[];for(c=0;c<g.length;c++)h.push(g[c].clone());e.setBandwidths(h)}c=f.getKey();null!=c&&e.setKey(c.clone());f=f.getAttributeFields();if(null!=f){g=[];for(c=0;c<f.length;c++)g.push(f[c].clone());e.setAttribute(g)}d.push(e)}this.setMediaDescriptions(d)}}};
SessionDescription.prototype.addField=function(a){if(null!=a&&1==SDPField.prototype.isPrototypeOf(a))if(a instanceof VersionField)this.versionField=a;else if(a instanceof OriginField)this.originField=a;else if(a instanceof SessionNameField)this.sessionNameField=a;else if(a instanceof InformationField)null!=this.currentMediaDescription?this.currentMediaDescription.setInformation(a):this.informationField=a;else if(a instanceof URIField)this.uriField=a;else if(a instanceof ConnectionField)null!=this.currentMediaDescription?
this.currentMediaDescription.setConnection(a):this.connectionField=a;else if(a instanceof KeyField)null!=this.currentMediaDescription?this.currentMediaDescription.setKey(a):this.keyField=a;else if(a instanceof EmailField)this.getEmails(!0).push(a);else if(a instanceof PhoneField)this.getPhones(!0).push(a);else if(a instanceof TimeField)this.currentTimeDescription=new TimeDescription(a),this.getTimeDescriptions(!0).push(this.currentTimeDescription);else if(a instanceof RepeatField){if(null==this.currentTimeDescription)throw new (new SdpException("SessionDescription.addField(): parsing error, no time atttribut specified"));
this.currentTimeDescription.addRepeat(a)}else a instanceof BandwidthField?null!=this.currentMediaDescription?this.currentMediaDescription.addBandwidth(a):this.getBandwidths(!0).push(a):a instanceof AttributeField?null!=this.currentMediaDescription?(a.getName(),this.currentMediaDescription.addAttribute(a)):this.getAttributes(!0).push(a):a instanceof MediaField&&(this.currentMediaDescription=new MediaDescription,this.getMediaDescriptions(!0).push(this.currentMediaDescription),this.currentMediaDescription.setMedia(a));
else throw new SdpException("SessionDescription.addField() requires SDPField object arguments");};SessionDescription.prototype.clone=function(){try{return new SessionDescription(this)}catch(a){throw new CloneNotSupportedException;}};SessionDescription.prototype.getVersion=function(){return this.versionField};
SessionDescription.prototype.setVersion=function(a){if(a instanceof VersionField)this.versionField=a;else throw new SdpException("SessionDescription.setVersion() requires VersionField object argument");};SessionDescription.prototype.getOrigin=function(){return this.originField};SessionDescription.prototype.setOrigin=function(a){if(a instanceof OriginField)this.originField=a;else throw new SdpException("SessionDescription.setOrigin() requires OriginField object argument");};
SessionDescription.prototype.getSessionName=function(){return this.sessionNameField};SessionDescription.prototype.setSessionName=function(a){if(a instanceof SessionNameField)this.sessionNameField=a;else throw new SdpException("SessionDescription.setSessionName() requires SessionNameField object argument");};SessionDescription.prototype.getInfo=function(){return this.informationField};
SessionDescription.prototype.setInfo=function(a){if(a instanceof InformationField)this.informationField=a;else throw new SdpException("SessionDescription.setInfo() requires InformationField object argument");};SessionDescription.prototype.getURI=function(){return this.uriField};SessionDescription.prototype.setURI=function(a){if(a instanceof URIField)this.uriField=a;else throw new SdpException("SessionDescription.setURI() requires URIField object argument");};
SessionDescription.prototype.getEmails=function(a){null==this.emailFieldArray&&a&&(this.emailFieldArray=[]);return this.emailFieldArray};SessionDescription.prototype.setEmails=function(a){if(a instanceof Array){for(var b=0;b<a.length;b++)if(!(a[b]instanceof EmailField))throw new SdpException("SessionDescription.setEmails() requires Array of EmailField object argument");this.emailFieldArray=a}else throw new SdpException("SessionDescription.setEmails() requires Array object argument");};
SessionDescription.prototype.getPhones=function(a){null==this.phoneFieldArray&&a&&(this.phoneFieldArray=[]);return this.phoneFieldArray};SessionDescription.prototype.setPhones=function(a){if(a instanceof Array){for(var b=0;b<a.length;b++)if(!(a[b]instanceof PhoneField))throw new SdpException("SessionDescription.setPhones() requires Array of PhoneField object argument");this.phoneFieldArray=a}else throw new SdpException("SessionDescription.setPhones() requires Array object argument");};
SessionDescription.prototype.getTimeDescriptions=function(a){null==this.timeFieldArray&&a&&(this.timeFieldArray=[]);return this.timeFieldArray};SessionDescription.prototype.setTimes=function(a){if(a instanceof Array){for(var b=0;b<a.length;b++)if(!(a[b]instanceof TimeField))throw new SdpException("SessionDescription.setTimes() requires Array of TimeField object argument");this.timeFieldArray=a}else throw new SdpException("SessionDescription.setTimes() requires Array object argument");};
SessionDescription.prototype.getZoneAdjustments=function(a){null==this.zoneAdjustments&&a&&(this.zoneAdjustments=[]);return this.zoneAdjustments};
SessionDescription.prototype.setZoneAdjustments=function(a){if(a instanceof Array){for(var b=0;b<a.length;b++)if(!(a[b]instanceof ZoneAdjustmentField))throw new SdpException("SessionDescription.setZoneAdjustments() requires Array of ZoneAdjustmentField object argument");this.zoneAdjustments=a}else throw new SdpException("SessionDescription.setZoneAdjustments() requires Array object argument");};SessionDescription.prototype.getConnection=function(){return this.connectionField};
SessionDescription.prototype.setConnection=function(a){if(a instanceof ConnectionField)this.connectionField=a;else throw new SdpException("SessionDescription.setConnection() requires ConnectionField object argument");};SessionDescription.prototype.getBandwidths=function(a){null==this.bandwidthFieldArray&&a&&(this.bandwidthFieldArray=[]);return this.bandwidthFieldArray};
SessionDescription.prototype.setBandwidths=function(a){if(a instanceof Array){for(var b=0;b<a.length;b++)if(!(a[b]instanceof BandwidthField))throw new SdpException("SessionDescription.setBandwidths() requires Array of BandwidthField object argument");this.bandwidthFieldArray=a}else throw new SdpException("SessionDescription.setBandwidths() requires Array object argument");};
SessionDescription.prototype.getBandwidth=function(a){if("string"==typeof a){if(null!=this.bandwidthFieldArray)for(var b=0;b<this.bandwidthFieldArray.length;b++)if(this.bandwidthFieldArray[b].getType()==a)return this.bandwidthFieldArray[b].getValue()}else throw new SdpException("SessionDescription.getBandwidth() requires string object argument");return-1};
SessionDescription.prototype.setBandwidth=function(a,b){if("string"==typeof a&&"number"==typeof b){if(null!=this.bandwidthFieldArray)for(var c=0;c<this.bandwidthFieldArray.length;c++){if(this.bandwidthFieldArray[c].getType()==a){this.bandwidthFieldArray[c].setBandwidth(b);return}}else this.bandwidthFieldArray=[];c=new BandwidthField;c.setType(a);c.setBandwidth(b);this.bandwidthFieldArray.push(c)}else throw new SdpException("SessionDescription:setBandwidth() requires string and number arguments");
};SessionDescription.prototype.removeBandwidth=function(a){if("string"==typeof a){if(null!=this.bandwidthFieldArray)for(var b=0;b<this.bandwidthFieldArray.length;b++)if(this.bandwidthFieldArray[b].getType()==a){this.bandwidthFieldArray.splice(b,1);break}}else throw new SdpException("SessionDescription:setBandwidth() removeBandwidth require string argument");};SessionDescription.prototype.getKey=function(){return this.keyField};
SessionDescription.prototype.setKey=function(a){if(a instanceof KeyField)this.keyField=a;else throw new SdpException("SessionDescription.setKey() requires KeyField object argument");};
SessionDescription.prototype.getAttribute=function(a){if("string"==typeof a){if(null==this.attributeFieldArray)return null;for(var b=0;b<this.attributeFieldArray.length;b++)if(this.attributeFieldArray[b].getName()==a)return this.attributeFieldArray[b].getValue();return null}throw new SdpException("SessionDescription.getAttribute() requires string object argument");};SessionDescription.prototype.getAttributes=function(a){null==this.attributeFieldArray&&a&&(this.attributeFieldArray=[]);return this.attributeFieldArray};
SessionDescription.prototype.removeAttribute=function(a){if("string"==typeof a){if(null!=this.attributeFieldArray)for(var b=0;b<this.attributeFieldArray.length;b++)if(this.attributeFieldArray[b].getName()==a){this.attributeFieldArray.slice(b,1);break}}else throw new SdpException("SessionDescription.removeAttribute() requires string object argument");};
SessionDescription.prototype.setAttribute=function(a,b){if("string"==typeof a){if(null==b)throw new SdpException("SessionDescription.setAttribute() requires not null value object argument");null==this.attributeFieldArray&&(this.attributeFieldArray=[]);for(var c=0;c<this.attributeFieldArray.length;c++)if(this.attributeFieldArray[c].getName()==a){this.attributeFieldArray[c].setValue(b);return}c=new AttributeField;c.setName(a);c.setValue(b);this.attributeFieldArray.push(c)}else throw new SdpException("SessionDescription.setAttribute() requires string argument for name");
};SessionDescription.prototype.setAttributes=function(a){if(a instanceof Array){for(var b=0;b<a.length;b++)if(!(a[b]instanceof AttributeField))throw new SdpException("SessionDescription.setAttributes() requires Array of AttributeField object argument");this.attributeFieldArray=a}else throw new SdpException("SessionDescription.setAttributes() requires Array object argument");};
SessionDescription.prototype.getMediaDescriptions=function(a){null==this.mediaDescriptionArray&&a&&(this.mediaDescriptionArray=[]);return this.mediaDescriptionArray};
SessionDescription.prototype.setMediaDescriptions=function(a){if(a instanceof Array){for(var b=0;b<a.length;b++)if(!(a[b]instanceof MediaDescription))throw new SdpException("SessionDescription.setMediaDescriptions() requires Array of MediaDescription object argument");this.mediaDescriptionArray=a}else throw new SdpException("SessionDescription.setAttributes() requires Array of MediaDescription object argument");};
SessionDescription.prototype.encodeSDPFieldArray=function(a){for(var b="",c=0;c<a.length;c++)b+=a[c].encode();return b};
SessionDescription.prototype.encode=function(){var a=""+(null==this.versionField?"":this.versionField.encode());a+=null==this.originField?"":this.originField.encode();a+=null==this.sessionNameField?"":this.sessionNameField.encode();a+=null==this.informationField?"":this.informationField.encode();a+=null==this.uriField?"":this.uriField.encode();a+=null==this.emailFieldArray?"":this.encodeSDPFieldArray(this.emailFieldArray);a+=null==this.phoneFieldArray?"":this.encodeSDPFieldArray(this.phoneFieldArray);
a+=null==this.connectionField?"":this.connectionField.encode();a+=null==this.bandwidthFieldArray?"":this.encodeSDPFieldArray(this.bandwidthFieldArray);a+=null==this.timeFieldArray?"":this.encodeSDPFieldArray(this.timeFieldArray);a+=null==this.zoneAdjustments?"":this.encodeSDPFieldArray(this.zoneAdjustments);a+=null==this.keyField?"":this.keyField.encode();a+=null==this.attributeFieldArray?"":this.encodeSDPFieldArray(this.attributeFieldArray);return a+=null==this.mediaDescriptionArray?"":this.encodeSDPFieldArray(this.mediaDescriptionArray)};
function SDPParser(){this.classname="SDPParser"}SDPParser.prototype.constructor=SDPParser;
SDPParser.prototype.parse=function(a){if("string"==typeof a){var b=new SessionDescription,c=0,d=null;for(a=a.trim()+"\r\n";c<a.length;){var e=a.indexOf("\n",c),f=a.indexOf("\r",c);if(0<e&&0>f)d=a.substring(c,e),c=e+1;else if(0>e&&0<f)d=a.substring(c,f),c=f+1;else if(0<e&&0<f)e>f?(d=a.substring(c,f),c=e==f+1?e+1:f+1):(d=a.substring(c,e),c=f==e+1?f+1:e+1);else if(0>e&&0>f)break;e=SDPParserFactory.prototype.createParser(d).parse(d);b.addField(e)}return b}throw new SdpException("SDPParser.parse() requires string object argument");
};
SDPParser.prototype.parseNameValue=function(a){if(null==a){var b=this.parseNameValue("=");return b}this.lexer.match(LexerCore.prototype.ID);var c=this.lexer.getNextToken();this.lexer.SPorHT();try{var d=!1;if(this.lexer.lookAhead(0)==a){this.lexer.consume(1);this.lexer.SPorHT();a=null;var e=!1;'"'==this.lexer.lookAhead(0)?(a=this.lexer.quotedString(),d=!0):(this.lexer.match(LexerCore.prototype.ID),a=this.lexer.getNextToken().tokenValue,null==a&&(a="",e=!0));b=new NameValue(c.tokenValue,a,e);d&&b.setQuotedValue()}else b=new NameValue(c.tokenValue,
"",!0);return b}catch(f){return console.error("SDPParser:parseNameValue(): catched exception:"+f),b=new NameValue(c.tokenValue,null,!1)}};function VersionFieldParser(){this.classname="VersionFieldParser"}VersionFieldParser.prototype=new SDPParser;VersionFieldParser.prototype.constructor=VersionFieldParser;
VersionFieldParser.prototype.parse=function(a){if("string"==typeof a)try{this.lexer=new LexerCore("charLexer",a);this.lexer.match("v");this.lexer.SPorHT();this.lexer.match("=");this.lexer.SPorHT();var b=new VersionField;this.lexer.match(LexerCore.prototype.ID);var c=this.lexer.getNextToken();b.setVersion(parseInt(c.getTokenValue()));this.lexer.SPorHT();return b}catch(d){throw new SdpException("VersionFieldParser.parse(): parsing exception:"+this.lexer.getBuffer()+"at "+this.lexer.getPtr());}else throw new SdpException("VersionFieldParser.parse() requires string object argument");
};function SessionNameFieldParser(){this.classname="SessionNameFieldParser"}SessionNameFieldParser.prototype=new SDPParser;SessionNameFieldParser.prototype.constructor=SessionNameFieldParser;
SessionNameFieldParser.prototype.parse=function(a){if("string"==typeof a)try{this.lexer=new LexerCore("charLexer",a);this.lexer.match("s");this.lexer.SPorHT();this.lexer.match("=");this.lexer.SPorHT();var b=new SessionNameField,c=this.lexer.getRest();b.setSessionName(null==c?"":c.trim());return b}catch(d){throw new SdpException("SessionNameFieldParser.parse(): parsing exception:"+this.lexer.getBuffer()+"at "+this.lexer.getPtr());}else throw new SdpException("SessionNameFieldParser.parse() requires string object argument");
};function AttributeFieldParser(){this.classname="AttributeFieldParser"}AttributeFieldParser.prototype=new SDPParser;AttributeFieldParser.prototype.constructor=AttributeFieldParser;
AttributeFieldParser.prototype.parse=function(a){if("string"==typeof a){this.lexer=new LexerCore("charLexer",a);try{var b=new AttributeField;this.lexer.match("a");this.lexer.SPorHT();this.lexer.match("=");this.lexer.SPorHT();var c=this.lexer.markInputPosition();try{var d=this.lexer.getNextToken(":");this.lexer.consume(1);var e=this.lexer.getRest();null!=e&&e.trim();b.setName(d);b.setValue(e)}catch(f){this.lexer.rewindInputPosition(c);d=this.lexer.getRest();if(null==d)throw new ParseException(this.lexer.getBuffer(),
this.lexer.getPtr());b.setName(d);b.setValue(null)}this.lexer.SPorHT();return b}catch(f){throw new SdpException("AttributeFieldParser.parse(): parsing exception:"+this.lexer.getBuffer(),this.lexer.getPtr());}}else throw new SdpException("AttributeFieldParser.parse() requires string object argument");};function BandwidthFieldParser(){this.classname="BandwidthFieldParser"}BandwidthFieldParser.prototype=new SDPParser;BandwidthFieldParser.prototype.constructor=BandwidthFieldParser;
BandwidthFieldParser.prototype.parse=function(a){if("string"==typeof a){this.lexer=new LexerCore("charLexer",a);try{this.lexer.match("b");this.lexer.SPorHT();this.lexer.match("=");this.lexer.SPorHT();var b=new BandwidthField,c=this.parseNameValue(":");b.setBandwidth(parseInt(c.getValueAsObject()));b.setType(c.getName());this.lexer.SPorHT();return b}catch(d){throw new SdpException("BandwidthFieldParser.parse(): parsing exception:"+this.lexer.getBuffer(),this.lexer.getPtr());}}else throw new SdpException("BandwidthFieldParser.parse() requires string object argument");
};function ConnectionFieldParser(){this.classname="ConnectionFieldParser"}ConnectionFieldParser.prototype=new SDPParser;ConnectionFieldParser.prototype.constructor=ConnectionFieldParser;
ConnectionFieldParser.prototype.parse=function(a){if("string"==typeof a){this.lexer=new LexerCore("charLexer",a);try{this.lexer.match("c");this.lexer.SPorHT();this.lexer.match("=");this.lexer.SPorHT();var b=new ConnectionField;this.lexer.match(LexerCore.prototype.ID);this.lexer.SPorHT();var c=this.lexer.getNextToken();b.setNetworkType(c.getTokenValue());this.lexer.match(LexerCore.prototype.ID);this.lexer.SPorHT();c=this.lexer.getNextToken();b.setAddressType(c.getTokenValue());this.lexer.SPorHT();
var d=this.lexer.getRest(),e=this.parseConnectionAddress(d.trim());b.setAddress(e);return b}catch(f){throw new SdpException("ConnectionFieldParser.parse(): parsing exception:"+this.lexer.getBuffer(),this.lexer.getPtr());}}else throw new SdpException("ConnectionFieldParser.parse() requires string object argument");};
ConnectionFieldParser.prototype.parseConnectionAddress=function(a){var b=new ConnectionAddress,c=a.indexOf("/");if(-1!=c){b.setAddress(new Host(a.substring(0,c)));var d=a.indexOf("/",c+1);-1!=d?(c=a.substring(c+1,d),b.setTtl(parseInt(c.trim())),a=a.substring(d+1),b.setPort(parseInt(a.trim()))):(c=a.substring(c+1),b.setTtl(Integer.parseInt(c.trim())))}else b.setHost(new Host(a));return b};function EmailFieldParser(){this.classname="EmailFieldParser"}EmailFieldParser.prototype=new SDPParser;
EmailFieldParser.prototype.constructor=EmailFieldParser;
EmailFieldParser.prototype.parse=function(a){if("string"==typeof a)try{this.lexer=new LexerCore("charLexer",a);this.lexer.match("e");this.lexer.SPorHT();this.lexer.match("=");this.lexer.SPorHT();var b=new EmailField,c=this.lexer.getRest(),d=this.parseDisplayName(c.trim());null!=d&&b.setDisplayName(d);b.setEmail(this.parseEmail(c));return b}catch(e){throw new SdpException("EmailFieldParser.parse(): parsing exception:"+this.lexer.getBuffer(),this.lexer.getPtr());}else throw new SdpException("EmailFieldParser.parse() requires string object argument");
};EmailFieldParser.prototype.parseDisplayName=function(a){var b=a.indexOf("(");if(-1!=b){var c=a.indexOf(")");return a.substring(b+1,c)}b=a.indexOf("<");return-1!=b?a.substring(0,b):null};EmailFieldParser.prototype.parseEmail=function(a){var b=a.indexOf("(");if(-1!=b)return a.substring(0,b);b=a.indexOf("<");if(-1!=b){var c=a.indexOf(">");return a.substring(b+1,c)}b=a.indexOf("\n");return-1!=b?a.substring(0,b):null};function InformationFieldParser(){this.classname="InformationFieldParser"}
InformationFieldParser.prototype=new SDPParser;InformationFieldParser.prototype.constructor=InformationFieldParser;
InformationFieldParser.prototype.parse=function(a){if("string"==typeof a)try{this.lexer=new LexerCore("charLexer",a);this.lexer.match("i");this.lexer.SPorHT();this.lexer.match("=");this.lexer.SPorHT();var b=new InformationField;b.setInformation(this.lexer.getRest().trim());return b}catch(c){throw new SdpException("InformationFieldParser.parse(): parsing exception:"+this.lexer.getBuffer(),this.lexer.getPtr());}else throw new SdpException("InformationFieldParser.parse() requires string object argument");
};function KeyFieldParser(){this.classname="KeyFieldParser"}KeyFieldParser.prototype=new SDPParser;KeyFieldParser.prototype.constructor=KeyFieldParser;
KeyFieldParser.prototype.parse=function(a){if("string"==typeof a)try{this.lexer=new LexerCore("charLexer",a);this.lexer.match("k");this.lexer.SPorHT();this.lexer.match("=");this.lexer.SPorHT();var b=new KeyField,c=new NameValue,d=this.lexer.markInputPosition();try{var e=this.lexer.getNextToken(":");this.lexer.consume(1);var f=this.lexer.getRest();c=new NameValue(e.trim(),f.trim())}catch(h){this.lexer.rewindInputPosition(d);var g=this.lexer.getRest();if(null==g)throw SdpException("KeyFieldParser.parse(): parsing exception:"+
this.lexer.getBuffer()+"at "+this.lexer.getPtr());c=new NameValue(g.trim(),null)}b.setMethod(c.getName());b.setKey(c.getValueAsObject());this.lexer.SPorHT();return b}catch(h){throw new SdpException("KeyFieldParser.parse(): parsing exception:"+this.lexer.getBuffer()+"at "+this.lexer.getPtr());}else throw new SdpException("KeyFieldParser.parse() requires string object argument");};function OriginFieldParser(){this.classname="OriginFieldParser"}OriginFieldParser.prototype=new SDPParser;
OriginFieldParser.prototype.constructor=OriginFieldParser;
OriginFieldParser.prototype.parse=function(a){if("string"==typeof a)try{this.lexer=new LexerCore("charLexer",a);var b=new OriginField;this.lexer.match("o");this.lexer.SPorHT();this.lexer.match("=");this.lexer.SPorHT();var c=this.lexer.getNextToken(" ");b.setUserName(c);this.lexer.SPorHT();this.lexer.match(LexerCore.prototype.ID);var d=this.lexer.getNextToken().getTokenValue();18<d.length&&(d=d.substring(d.length-18));b.setSessionId(d);this.lexer.SPorHT();this.lexer.match(LexerCore.prototype.ID);var e=
this.lexer.getNextToken().getTokenValue();18<e.length&&(e=e.substring(e.length-18));b.setSessionVersion(e);this.lexer.SPorHT();this.lexer.match(LexerCore.prototype.ID);var f=this.lexer.getNextToken();b.setNetworkType(f.getTokenValue());this.lexer.SPorHT();this.lexer.match(LexerCore.prototype.ID);var g=this.lexer.getNextToken();b.setAddressType(g.getTokenValue());this.lexer.SPorHT();var h=this.lexer.getRest(),k=(new HostNameParser(h)).host();b.setHost(k);return b}catch(l){throw new SdpException("OriginFieldParser.parse(): parsing exception:"+
this.lexer.getBuffer()+"at "+this.lexer.getPtr());}else throw new SdpException("OriginFieldParser.parse() requires string object argument");};function PhoneFieldParser(){this.classname="PhoneFieldParser"}PhoneFieldParser.prototype=new SDPParser;PhoneFieldParser.prototype.constructor=PhoneFieldParser;
PhoneFieldParser.prototype.parse=function(a){if("string"==typeof a)try{this.lexer=new LexerCore("charLexer",a);this.lexer.match("p");this.lexer.SPorHT();this.lexer.match("=");this.lexer.SPorHT();var b=new PhoneField,c=this.lexer.getRest(),d=this.parseDisplayName(c.trim());null!=d&&b.setName(d);b.setPhoneNumber(this.parsePhoneNumber(c));return b}catch(e){throw new SdpException("PhoneFieldParser.parse(): parsing exception:"+this.lexer.getBuffer()+"at "+this.lexer.getPtr());}else throw new SdpException("PhoneFieldParser.parse() requires string object argument");
};PhoneFieldParser.prototype.parseDisplayName=function(a){var b=a.indexOf("(");if(-1!=b){var c=a.indexOf(")");return a.substring(b+1,c)}b=a.indexOf("<");return-1!=b?a.substring(0,b):null};PhoneFieldParser.prototype.parsePhoneNumber=function(a){var b=a.indexOf("(");if(-1!=b)return a.substring(0,b).trim();b=a.indexOf("<");if(-1!=b){var c=a.indexOf(">");return a.substring(b+1,c)}return a.trim()};function URIFieldParser(){this.classname="URIFieldParser"}URIFieldParser.prototype=new SDPParser;
URIFieldParser.prototype.constructor=URIFieldParser;
URIFieldParser.prototype.parse=function(a){if("string"==typeof a)try{this.lexer=new LexerCore("charLexer",a);this.lexer.match("u");this.lexer.SPorHT();this.lexer.match("=");this.lexer.SPorHT();var b=new URIField;b.setURI(this.lexer.getRest().trim());return b}catch(c){throw new SdpException("URIFieldParser.parse(): parsing exception:"+this.lexer.getBuffer()+"at "+this.lexer.getPtr());}else throw new SdpException("URIFieldParser.parse() requires string object argument");};
function TimeFieldParser(){this.classname="TimeFieldParser"}TimeFieldParser.prototype=new SDPParser;TimeFieldParser.prototype.constructor=TimeFieldParser;
TimeFieldParser.prototype.parse=function(a){if("string"==typeof a)try{this.lexer=new LexerCore("charLexer",a);this.lexer.match("t");this.lexer.SPorHT();this.lexer.match("=");this.lexer.SPorHT();var b=new TimeField;b.setStartTime(this.parseTime());this.lexer.SPorHT();b.setStopTime(this.parseTime());return b}catch(c){throw new SdpException("TimeFieldParser.parse(): parsing exception:"+this.lexer.getBuffer()+"at "+this.lexer.getPtr());}else throw new SdpException("TimeFieldParser.parse() requires string object argument");
};TimeFieldParser.prototype.parseTime=function(){var a=this.lexer.number();18<a.length&&(a=a.substring(a.length-18));return parseInt(a)};function RepeatFieldParser(){this.classname="RepeatFieldParser"}RepeatFieldParser.prototype=new SDPParser;RepeatFieldParser.prototype.constructor=RepeatFieldParser;
RepeatFieldParser.prototype.parse=function(a){if("string"==typeof a)try{this.lexer=new LexerCore("charLexer",a);this.lexer.match("r");this.lexer.SPorHT();this.lexer.match("=");this.lexer.SPorHT();var b=new RepeatField;this.lexer.match(LexerCore.prototype.ID);var c=this.lexer.getNextToken();this.lexer.SPorHT();var d=this.parseTypedTime(c.getTokenValue());b.setRepeatInterval(d);this.lexer.match(LexerCore.prototype.ID);var e=this.lexer.getNextToken();this.lexer.SPorHT();d=this.parseTypedTime(e.getTokenValue());
for(b.setActiveDuration(d);this.lexer.hasMoreChars();){var f=this.lexer.lookAhead(0);if("\n"==f||"\r"==f)break;this.lexer.match(LexerCore.prototype.ID);var g=this.lexer.getNextToken();this.lexer.SPorHT();d=this.parseTypedTime(g.getTokenValue());b.addOffset(d)}return b}catch(h){throw new SdpException("RepeatFieldParser.parse(): parsing exception:"+this.lexer.getBuffer()+"at "+this.lexer.getPtr());}else throw new SdpException("RepeatFieldParser.parse() requires string object argument");};
RepeatFieldParser.prototype.parseTypedTime=function(a){var b=new TypedTime;a.endsWith("d")?(b.setUnit("d"),a=a.replace("d"," "),b.setTime(parseInt(a.trim()))):a.endsWith("h")?(b.setUnit("h"),a=a.replace("h"," "),b.setTime(parseInt(a.trim()))):a.endsWith("m")?(b.setUnit("m"),a=a.replace("m"," "),b.setTime(parseInt(a.trim()))):(b.setUnit("s"),a.endsWith("s")?(a=a.replace("s"," "),b.setTime(parseInt(a.trim()))):b.setTime(parseInt(a.trim())));return b};
function MediaFieldParser(){this.classname="MediaFieldParser"}MediaFieldParser.prototype=new SDPParser;MediaFieldParser.prototype.constructor=MediaFieldParser;
MediaFieldParser.prototype.parse=function(a){if("string"==typeof a)try{this.lexer=new LexerCore("charLexer",a);var b=new MediaField;this.lexer.match("m");this.lexer.SPorHT();this.lexer.match("=");this.lexer.SPorHT();this.lexer.match(LexerCore.prototype.ID);var c=this.lexer.getNextToken();b.setType(c.getTokenValue());this.lexer.SPorHT();this.lexer.match(LexerCore.prototype.ID);var d=this.lexer.getNextToken();b.setPort(parseInt(d.getTokenValue()));this.lexer.SPorHT();if(this.lexer.hasMoreChars()&&"\n"==
this.lexer.lookAhead(1))return b;if("/"==this.lexer.lookAhead(0)){this.lexer.consume(1);this.lexer.match(LexerCore.prototype.ID);var e=this.lexer.getNextToken();b.setNports(parseInt(e.getTokenValue()));this.lexer.SPorHT()}this.lexer.match(LexerCore.prototype.ID);for(var f=this.lexer.getNextToken().getTokenValue();"/"==this.lexer.lookAhead(0);){this.lexer.consume(1);this.lexer.match(LexerCore.prototype.ID);var g=this.lexer.getNextToken();f=f+"/"+g.getTokenValue()}b.setProtocol(f);this.lexer.SPorHT();
for(a=[];this.lexer.hasMoreChars();){var h=this.lexer.lookAhead(0);if("\n"==h||"\r"==h)break;this.lexer.SPorHT();this.lexer.match(LexerCore.prototype.ID);var k=this.lexer.getNextToken();this.lexer.SPorHT();var l=k.getTokenValue().trim();""==!l&&a.push(l)}b.setFormats(a);return b}catch(m){throw new SdpException("MediaFieldParser.parse(): parsing exception:"+this.lexer.getBuffer()+"at "+this.lexer.getPtr());}else throw new SdpException("MediaFieldParser.parse() requires string object argument");};
function SDPParserFactory(){this.classname="SDPParserFactory"}SDPParserFactory.prototype.constructor=SDPParserFactory;SDPParserFactory.prototype.parserTable=[];SDPParserFactory.prototype.parserTable.a=AttributeFieldParser.prototype.constructor;SDPParserFactory.prototype.parserTable.b=BandwidthFieldParser.prototype.constructor;SDPParserFactory.prototype.parserTable.c=ConnectionFieldParser.prototype.constructor;SDPParserFactory.prototype.parserTable.e=EmailFieldParser.prototype.constructor;
SDPParserFactory.prototype.parserTable.i=InformationFieldParser.prototype.constructor;SDPParserFactory.prototype.parserTable.k=KeyFieldParser.prototype.constructor;SDPParserFactory.prototype.parserTable.m=MediaFieldParser.prototype.constructor;SDPParserFactory.prototype.parserTable.o=OriginFieldParser.prototype.constructor;SDPParserFactory.prototype.parserTable.p=PhoneFieldParser.prototype.constructor;SDPParserFactory.prototype.parserTable.v=VersionFieldParser.prototype.constructor;
SDPParserFactory.prototype.parserTable.r=RepeatFieldParser.prototype.constructor;SDPParserFactory.prototype.parserTable.s=SessionNameFieldParser.prototype.constructor;SDPParserFactory.prototype.parserTable.t=TimeFieldParser.prototype.constructor;SDPParserFactory.prototype.parserTable.u=SDPParserFactory.prototype.constructor;
SDPParserFactory.prototype.createParser=function(a){if("string"==typeof a)try{var b=a.indexOf(Separators.prototype.EQUALS);if(-1==b)throw new SdpException("SDPParserFactory.createParser(): parsing exception");var c=a.substring(0,b).trim();if(null!=this.parserTable[c[0]])return new this.parserTable[c[0]];throw new SdpException("SDPParserFactory.createParse(): could not find parser for "+c);}catch(d){throw new SdpException("SDPParserFactory.createParse(): could not find parser for "+c);}else throw new SdpException("SDPParserFactory.createParser() requires string object argument");
};function GenericURI(a){this.classname="GenericURI";this.scheme=this.uriString=null;if(null!=a){this.uriString=a;var b=a.indexOf(":");this.scheme=a.substring(0,b)}}GenericURI.prototype.SIP="sip";GenericURI.prototype.SIPS="sips";GenericURI.prototype.POSTDIAL="postdial";GenericURI.prototype.PHONE_CONTEXT_TAG="context-tag";GenericURI.prototype.ISUB="isub";GenericURI.prototype.PROVIDER_TAG="provider-tag";GenericURI.prototype.TEL="tel";GenericURI.prototype.encode=function(){return this.uriString};
GenericURI.prototype.encodeBuffer=function(a){return a+=this.uriString};GenericURI.prototype.toString=function(){return this.encode()};GenericURI.prototype.getScheme=function(){return this.scheme};GenericURI.prototype.isSipURI=function(){return this instanceof SipUri?!0:!1};GenericURI.prototype.equals=function(a){return this==a||a instanceof URI&&this.toString().toLowerCase()==a.toString().toLowerCase()?!0:!1};
GenericURI.prototype.hashCode=function(){var a=0,b=this.toString();if(null!=b&&""!=b.value)for(var c=0;c<b.length;c++)if(a=31*a+b.charCodeAt(c),2147483647<a||-2147483648>a)a&=4294967295;return a};function UserInfo(){this.userType=this.password=this.user=null;this.classname="UserInfo"}UserInfo.prototype.TELEPHONE_SUBSCRIBER=1;UserInfo.prototype.USER=2;UserInfo.prototype.COLON=":";UserInfo.prototype.POUND="#";UserInfo.prototype.SEMICOLON=";";
UserInfo.prototype.equals=function(a){if("UserInfo"!=a.classname)return!1;new UserInfo;return this.userType!=a.userType||this.user!=a.user||null!=this.password&&null==a.password||null!=a.password&&null==this.password?!1:this.password==a.password};UserInfo.prototype.encode=function(){return this.encodeBuffer("").toString()};UserInfo.prototype.encodeBuffer=function(a){return null!=this.password?a+this.user+this.COLON+this.password:a+this.user};
UserInfo.prototype.clearPassword=function(){this.password=null};UserInfo.prototype.getUserType=function(){return this.userType};UserInfo.prototype.getUser=function(){return this.user};UserInfo.prototype.setUser=function(a){this.user=a;null!=a&&(0<=a.indexOf(this.POUND)||0<=a.indexOf(this.SEMICOLON))?this.setUserType(this.TELEPHONE_SUBSCRIBER):this.setUserType(this.USER)};UserInfo.prototype.getPassword=function(){return this.password};UserInfo.prototype.setPassword=function(a){this.password=a};
UserInfo.prototype.setUserType=function(a){if(a!=this.USER&&a!=this.TELEPHONE_SUBSCRIBER)throw console.error("UserInfo:setUserType(): parameter not in range"),"UserInfo:setUserType(): parameter not in range";this.userType=a};function Authority(){this.classname="Authority";this.userInfo=null;this.hostPort=new HostPort}Authority.prototype.AT="@";Authority.prototype.encode=function(){return this.encodeBuffer("")};
Authority.prototype.encodeBuffer=function(a){null!=this.userInfo&&(a=this.userInfo.encodeBuffer(a),a+=this.AT);return a=this.hostPort.encodeBuffer(a)};Authority.prototype.equals=function(a){return null==a||a.classname!=this.classname||this.hostPort!=a.hostPort||null!=this.userInfo&&null!=a.userInfo&&this.userInfo!=a.userInfo?!1:!0};Authority.prototype.getHostPort=function(){return this.hostPort};Authority.prototype.getUserInfo=function(){return this.userInfo};
Authority.prototype.getPassword=function(){return null==this.userInfo?null:this.userInfo.password};Authority.prototype.getUser=function(){return null!=this.userInfo?this.userInfo.user:null};Authority.prototype.getHost=function(){return null==this.hostPort?null:this.hostPort.getHost()};Authority.prototype.getPort=function(){return null==this.hostPort?-1:this.hostPort.getPort()};Authority.prototype.removePort=function(){null!=this.hostPort&&this.hostPort.removePort()};
Authority.prototype.setPassword=function(a){null==this.userInfo&&(this.userInfo=new UserInfo);this.userInfo.setPassword(a)};Authority.prototype.setUser=function(a){null==this.userInfo&&(this.userInfo=new UserInfo);this.userInfo.setUser(a)};Authority.prototype.setHost=function(a){null==this.hostPort&&(this.hostPort=new HostPort);this.hostPort.setHost(a)};Authority.prototype.setPort=function(a){null==this.hostPort&&(this.hostPort=new HostPort);this.hostPort.setPort(a)};
Authority.prototype.setHostPort=function(a){this.hostPort=a};Authority.prototype.setUserInfo=function(a){this.userInfo=a};Authority.prototype.removeUserInfo=function(){this.userInfo=null};Authority.prototype.hashCode=function(){if(null==this.hostPort)throw console.error("Authority:hashCode(): null hostPort cannot compute hashcode"),"Authority:hashCode(): null hostPort cannot compute hashcode";return this.hostPort.encode().hashCode()};
function TelephoneNumber(){this.classname="TelephoneNumber";this.phoneNumber=this.isglobal=null;this.parameters=new NameValueList}TelephoneNumber.prototype.POSTDIAL="postdial";TelephoneNumber.prototype.PHONE_CONTEXT_TAG="context-tag";TelephoneNumber.prototype.ISUB="isub";TelephoneNumber.prototype.PROVIDER_TAG="provider-tag";TelephoneNumber.prototype.SEMICOLON=";";TelephoneNumber.prototype.deleteParm=function(a){this.parameters.delet(a)};TelephoneNumber.prototype.getPhoneNumber=function(){return this.phoneNumber};
TelephoneNumber.prototype.getPostDial=function(){return this.parameters.getValue(this.POSTDIAL)};TelephoneNumber.prototype.getIsdnSubaddress=function(){return this.parameters.getValue(this.ISUB)};TelephoneNumber.prototype.hasPostDial=function(){return null!=this.parameters.getValue(this.POSTDIAL)?!0:!1};TelephoneNumber.prototype.hasParm=function(a){return this.parameters.hasNameValue(a)?!0:!1};TelephoneNumber.prototype.hasIsdnSubaddress=function(){return this.hasParm(this.ISUB)?!0:!1};
TelephoneNumber.prototype.isGlobal=function(){return this.isglobal};TelephoneNumber.prototype.removePostDial=function(){this.parameters.delet(this.POSTDIAL)};TelephoneNumber.prototype.removeIsdnSubaddress=function(){this.deleteParm(this.ISUB)};TelephoneNumber.prototype.setParameters=function(a){this.parameters=a};TelephoneNumber.prototype.setGlobal=function(a){this.isglobal=a};TelephoneNumber.prototype.setPostDial=function(a){a=new NameValue(this.POSTDIAL,a);this.parameters.set_nv(a)};
TelephoneNumber.prototype.setParm=function(a,b){a=new NameValue(a,b);this.parameters.set_nv(a)};TelephoneNumber.prototype.setIsdnSubaddress=function(a){this.setParm(this.ISUB,a)};TelephoneNumber.prototype.setPhoneNumber=function(a){this.phoneNumber=a};TelephoneNumber.prototype.encode=function(){return this.encodeBuffer("").toString()};
TelephoneNumber.prototype.encodeBuffer=function(a){this.isglobal&&(a+="+");a+=this.phoneNumber;0!=this.parameters.hmap.length&&(a+=this.SEMICOLON,a=this.parameters.encodeBuffer(a));return a};TelephoneNumber.prototype.getParameter=function(a){a=this.parameters.getValue(a);return null==a?null:a instanceof GenericObject?a.encode():a.toString()};TelephoneNumber.prototype.getParameterNames=function(){return this.parameters.getNames()};TelephoneNumber.prototype.removeParameter=function(a){this.parameters.delet(a)};
TelephoneNumber.prototype.setParameter=function(a,b){a=new NameValue(a,b);this.parameters.set_nv(a)};TelephoneNumber.prototype.getParameters=function(){return this.parameters};function SipUri(){this.classname="SipUri";this.authority=new Authority;this.uriParms=new NameValueList;this.qheaders=new NameValueList;this.telephoneSubscriber=new TelephoneNumber;this.scheme="sip";this.qheaders.setSeparator("&")}SipUri.prototype=new GenericURI;SipUri.prototype.constructor=SipUri;SipUri.prototype.SIP="sip";
SipUri.prototype.SIPS="sips";SipUri.prototype.COLON=":";SipUri.prototype.SEMICOLON=";";SipUri.prototype.QUESTION="?";SipUri.prototype.AT="@";SipUri.prototype.METHOD="method";SipUri.prototype.USER="user";SipUri.prototype.PHONE="phone";SipUri.prototype.TTL="ttl";SipUri.prototype.MADDR="maddr";SipUri.prototype.TRANSPORT="transport";SipUri.prototype.LR="lr";SipUri.prototype.GRUU="gr";
SipUri.prototype.setScheme=function(a){if(a.toLowerCase()!=this.SIP&&a.toLowerCase()!=this.SIPS)throw console.error("SipUri:setScheme(): bad scheme "+a),"SipUri:setScheme(): bad scheme "+a;this.scheme=a.toLowerCase()};SipUri.prototype.getScheme=function(){return this.scheme};SipUri.prototype.clearUriParms=function(){this.uriParms=new NameValueList};SipUri.prototype.clearPassword=function(){if(null!=this.authority){var a=this.authority.getUserInfo();null!=a&&a.clearPassword()}};
SipUri.prototype.getAuthority=function(){return this.authority};SipUri.prototype.clearQheaders=function(){this.qheaders=new NameValueList};
SipUri.prototype.equals=function(a){if(a==this)return!0;if(a instanceof SipUri){if(this.isSecure()^a.isSecure()||null==this.getUser()^null==a.getUser()||null==this.getUserPassword()^null==a.getUserPassword()||null!=this.getUser()&&this.getUser()!=a.getUser()||null!=this.getUserPassword()&&this.getUserPassword()!=a.getUserPassword()||null==this.getHost()^null==a.getHost()||null!=this.getHost()&&!this.getHost().equalsIgnoreCase(a.getHost())||this.getPort()!=a.getPort())return!1;for(var b=this.getParameterNames(),
c=0;c<b.length;c++){var d=b[c],e=this.getParameter(d);d=a.getParameter(d);if(null!=e&&null!=d&&e!=d)return!1}if(null==this.getTransportParam()^null==a.getTransportParam()||null==this.getUserParam()^null==a.getUserParam()||-1==this.getTTLParam()^-1==a.getTTLParam()||null==this.getMethodParam()^null==a.getMethodParam()||null==this.getMAddrParam()^null==a.getMAddrParam())return!1;b=this.getHeaderNames();c=a.getHeaderNames();if(b[0]&&!c[0]||!b[0]&&c[0])return!1;if(b[0]&&c[0])for(e=(new SipFactory).createHeaderFactory(),
c=0;c<b.length;c++){d=b[c];var f=this.getHeader(d),g=a.getHeader(d);if(null==f&&null!=g||null==g&&null!=f)return!1;if(null!=f||null!=g)if(f=e.createHeader(d,RFC2396UrlDecoder.decode(f)),d=e.createHeader(d,RFC2396UrlDecoder.decode(g)),f!=d)return!1}return!0}return!1};SipUri.prototype.encode=function(){return this.encodeBuffer("")};
SipUri.prototype.encodeBuffer=function(a){a=a+this.scheme+this.COLON;null!=this.authority&&(a=this.authority.encodeBuffer(a));0!=this.uriParms.hmap.length&&(a+=this.SEMICOLON,a=this.uriParms.encodeBuffer(a));0!=this.qheaders.hmap.length&&(a+=this.QUESTION,a=this.qheaders.encodeBuffer(a));return a};
SipUri.prototype.encodeWithoutScheme=function(){var a="";null!=this.authority&&(a=this.authority.encodeBuffer(a));0!=this.uriParms.hmap.length&&(a+=this.SEMICOLON,a=this.uriParms.encodeBuffer(a));0!=this.qheaders.hmap.length&&(a+=this.QUESTION,a=this.qheaders.encodeBuffer(a));return a};SipUri.prototype.toString=function(){return this.encode()};
SipUri.prototype.getUserAtHost=function(){var a="";null!=this.authority.getUserInfo()&&(a=this.authority.getUserInfo().getUser());var b=this.authority.getHost().encode();return(""==a?null:":"+this.AT)+b};SipUri.prototype.getUserAtHostPort=function(){var a="";null!=this.authority.getUserInfo()&&(a=this.authority.getUserInfo().getUser());var b=this.authority.getHost().encode(),c=this.authority.getPort();a=""==a?null:":"+this.AT;return-1!=c?a=a+b+this.COLON+c:a+b};SipUri.prototype.getParm=function(a){return this.uriParms.getValue(a)};
SipUri.prototype.getMethod=function(){return this.getParm(this.METHOD)};SipUri.prototype.getParameters=function(){return this.uriParms};SipUri.prototype.removeParameters=function(){this.uriParms=new NameValueList};SipUri.prototype.getQheaders=function(){return this.qheaders};SipUri.prototype.getUserType=function(){return this.uriParms.getValue(this.USER)};SipUri.prototype.getUserPassword=function(){return null==this.authority?null:this.authority.getPassword()};
SipUri.prototype.setUserPassword=function(a){null==this.authority&&(this.authority=new Authority);this.authority.setPassword(a)};SipUri.prototype.getTelephoneSubscriber=function(){null==this.telephoneSubscriber&&(this.telephoneSubscriber=new TelephoneNumber);return this.telephoneSubscriber};SipUri.prototype.getHostPort=function(){return null==this.authority||null==this.authority.getHost()?null:this.authority.getHostPort()};
SipUri.prototype.getPort=function(){var a=this.getHostPort();return null==a?-1:a.getPort()};SipUri.prototype.getHost=function(){return null==this.authority?null:null==this.authority.getHost()?null:this.authority.getHost().encode()};SipUri.prototype.isUserTelephoneSubscriber=function(){var a=this.uriParms.getValue(this.USER);return null==a?!1:a.toLowerCase()==this.PHONE?!0:!1};SipUri.prototype.removeTTL=function(){null!=this.uriParms&&this.uriParms.delet(this.TTL)};
SipUri.prototype.removeMAddr=function(){null!=this.uriParms&&this.uriParms.delet(this.MADDR)};SipUri.prototype.removeTransport=function(){null!=this.uriParms&&this.uriParms.delet(this.TRANSPORT)};SipUri.prototype.removeHeader=function(a){null!=this.uriParms&&this.uriParms.delet(a)};SipUri.prototype.removeHeaders=function(){this.qheaders=new NameValueList};SipUri.prototype.removeUserType=function(){null!=this.uriParms&&this.uriParms.delet(this.USER)};SipUri.prototype.removePort=function(){this.authority.removePort()};
SipUri.prototype.removeMethod=function(){null!=this.uriParms&&this.uriParms.delet(this.METHOD)};SipUri.prototype.setUser=function(a){null==this.authority&&(this.authority=new Authority);this.authority.setUser(a)};SipUri.prototype.removeUser=function(){this.authority.removeUserInfo()};SipUri.prototype.setDefaultParm=function(a,b){null==this.uriParms.getValue(a)&&(a=new NameValue(a,b),this.uriParms.set_nv(a))};SipUri.prototype.setAuthority=function(a){this.authority=a};
SipUri.prototype.setHost_Host=function(a){null==this.authority&&(this.authority=new Authority);this.authority.setHost(a)};SipUri.prototype.setUriParms=function(a){this.uriParms=a};SipUri.prototype.setUriParm=function(a,b){a=new NameValue(a,b);this.uriParms.set_nv(a)};SipUri.prototype.setQheaders=function(a){this.qheaders=a};SipUri.prototype.setMAddr=function(a){var b=this.uriParms.getNameValue(this.MADDR),c=new Host;c.setAddress(a);null!=b?b.setValueAsObject(c):(b=new NameValue(this.MADDR,c),this.uriParms.set_nv(b))};
SipUri.prototype.setUserParam=function(a){this.uriParms.set_name_value(this.USER,a)};SipUri.prototype.setMethod=function(a){this.uriParms.set_name_value(this.METHOD,a)};SipUri.prototype.setIsdnSubAddress=function(a){null==this.telephoneSubscriber&&(this.telephoneSubscriber=new TelephoneNumber);this.telephoneSubscriber.setIsdnSubaddress(a)};SipUri.prototype.setTelephoneSubscriber=function(a){this.telephoneSubscriber=a};
SipUri.prototype.setPort=function(a){null==this.authority&&(this.authority=new Authority);this.authority.setPort(a)};SipUri.prototype.hasParameter=function(a){return null!=this.uriParms.getValue(a)?!0:!1};SipUri.prototype.setQHeader=function(a){this.qheaders.set_nv(a)};SipUri.prototype.setUriParameter=function(a){this.uriParms.set_nv(a)};SipUri.prototype.hasTransport=function(){return this.hasParameter(this.TRANSPORT)?!0:!1};SipUri.prototype.removeParameter=function(a){this.uriParms.delet(a)};
SipUri.prototype.setHostPort=function(a){null==this.authority&&(this.authority=new Authority);this.authority.setHostPort(a)};SipUri.prototype.getHeader=function(a){return null!=this.qheaders.getValue(a)?this.qheaders.getValue(a):null};SipUri.prototype.getHeaderNames=function(){return this.qheaders.getNames()};SipUri.prototype.getLrParam=function(){return this.hasParameter(this.LR)?"true":null};
SipUri.prototype.getMAddrParam=function(){var a=this.uriParms.getNameValue(this.MADDR);if(null==a)return null;a=a.getValueAsObject();"object"==typeof a&&(a=a.encode());return a};SipUri.prototype.getMethodParam=function(){return this.getParameter(this.METHOD)};SipUri.prototype.getParameter=function(a){a=this.uriParms.getValue(a);return null==a?null:a instanceof GenericObject?a.encode():a};SipUri.prototype.getParameterNames=function(){return this.uriParms.getNames()};
SipUri.prototype.getTTLParam=function(){var a=this.uriParms.getValue("ttl");return null!=a?a-0:-1};SipUri.prototype.getTransportParam=function(){return null!=this.uriParms?this.uriParms.getValue(this.TRANSPORT):null};SipUri.prototype.getUser=function(){return this.authority.getUser()};SipUri.prototype.isSecure=function(){return this.getScheme().toLowerCase()==this.SIPS?!0:!1};SipUri.prototype.isSipURI=function(){return!0};SipUri.prototype.setHeader=function(a,b){a=new NameValue(a,b);this.qheaders.set_nv(a)};
SipUri.prototype.setHost_String=function(a){a=new Host(a);this.setHost_Host(a)};SipUri.prototype.setLrParam=function(){this.uriParms.set_name_value("lr",null)};SipUri.prototype.setMAddrParam=function(a){if(null==a)throw console.error("SipUri:setMAddrParam(): bad maddr"),"SipUri:setMAddrParam(): bad maddr";this.setParameter("maddr",a)};SipUri.prototype.setMethodParam=function(a){this.setParameter("method",a)};
SipUri.prototype.setParameter=function(a,b){"ttl"==a.toLowerCase()&&(b-=0);this.uriParms.set_name_value(a,b)};SipUri.prototype.setSecure=function(a){this.scheme=a?this.SIPS:this.SIP};SipUri.prototype.setTTLParam=function(a){if(0>=a)throw console.error("SipUri:setTTLParam(): Bad ttl value"),"SipUri:setTTLParam(): Bad ttl value";null!=this.uriParms&&(a=new NameValue("ttl",a.valueOf()),this.uriParms.set_nv(a))};
SipUri.prototype.setTransportParam=function(a){if(null==a)throw console.error("SipUri:setTransportParam():  null transport arg"),"SipUri:setTransportParam(): null transport arg";if("UDP"==a==0||"TLS"==a==0||"TCP"==a==0||"SCTP"==a==0||"WS"==a==0||"WSS"==a==0)a=new NameValue(this.TRANSPORT,a.toLowerCase()),this.uriParms.set_nv(a);else throw console.error("SipUri:setTransportParam():  bad transport "+a),"SipUri:setTransportParam(): bad transport "+a;};SipUri.prototype.getUserParam=function(){return this.getParameter("user")};
SipUri.prototype.hasLrParam=function(){return null!=this.uriParms.getNameValue("lr")?!0:!1};SipUri.prototype.hasGrParam=function(){return null!=this.uriParms.getNameValue(this.GRUU)?!0:!1};SipUri.prototype.setGrParam=function(a){this.uriParms.set_name_value(this.GRUU,a)};SipUri.prototype.getGrParam=function(){return this.uriParms.getValue(this.GRUU)};function AddressImpl(){this.classname="AddressImpl";this.addressType=1;this.displayName=null;this.address=new GenericURI}
AddressImpl.prototype.NAME_ADDR=1;AddressImpl.prototype.ADDRESS_SPEC=2;AddressImpl.prototype.WILD_CARD=3;AddressImpl.prototype.DOUBLE_QUOTE='"';AddressImpl.prototype.SP=" ";AddressImpl.prototype.LESS_THAN="<";AddressImpl.prototype.GREATER_THAN=">";
AddressImpl.prototype.match=function(a){return null==a?!0:a instanceof AddressImpl?null!=a.getMatcher()?a.getMatcher().match(this.encode())?!0:!1:null!=a.displayName&&null==this.displayName?!1:null==a.displayName?this.address.match(a.address)?!0:!1:this.displayName.toLowerCase()==a.displayName&&this.address.match(a.address)?!0:!1:!1};
AddressImpl.prototype.getHostPort=function(){if(!(this.address instanceof SipUri))throw console.error("AddressImpl:getHostPort(): address is not a SipUri"),"AddressImpl:getHostPort(): address is not a SipUri";return this.address.getHostPort()};AddressImpl.prototype.getPort=function(){if(!(this.address instanceof SipUri))throw console.error("AddressImpl:getPort(): address is not a SipUri"),"AddressImpl:getPort(): address is not a SipUri";return this.address.getHostPort().getPort()};
AddressImpl.prototype.getUserAtHostPort=function(){return this.address instanceof SipUri?this.address.getUserAtHostPort():this.address};AddressImpl.prototype.getHost=function(){if(!(this.address instanceof SipUri))throw console.error("AddressImpl:getHost(): address is not a SipUri"),"AddressImpl:getHost(): address is not a SipUri";return this.address.getHostPort().getHost().getHostname()};
AddressImpl.prototype.removeParameter=function(a){if(!(this.address instanceof SipUri))throw console.error("AddressImpl:removeParameter(): address is not a SipUri"),"AddressImpl:removeParameter(): address is not a SipUri";this.address.removeParameter(a)};AddressImpl.prototype.encode=function(){return this.encodeBuffer("")};
AddressImpl.prototype.encodeBuffer=function(a){if(this.addressType==this.WILD_CARD)a+="*";else if(null!=this.displayName&&(a=a+this.DOUBLE_QUOTE+this.displayName+this.DOUBLE_QUOTE+this.SP),null!=this.address){if(this.addressType==this.NAME_ADDR||null!=this.displayName)a+=this.LESS_THAN;a=this.address.encodeBuffer(a);if(this.addressType==this.NAME_ADDR||null!=this.displayName)a+=this.GREATER_THAN}return a};
AddressImpl.prototype.encodeWithoutScheme=function(){return this.address instanceof SipUri?this.address.encodeWithoutScheme():encode()};AddressImpl.prototype.getAddressType=function(){return this.addressType};AddressImpl.prototype.setAddressType=function(a){this.addressType=a};AddressImpl.prototype.getDisplayName=function(){return this.displayName};AddressImpl.prototype.setDisplayName=function(a){this.displayName=a;this.addressType=this.NAME_ADDR};
AddressImpl.prototype.setAddress=function(a){this.address=a};AddressImpl.prototype.hashCode=function(){var a=0,b=this.address;if(null!=b&&""!=b.value)for(var c=0;c<b.length;c++)if(a=31*a+b.charCodeAt(c),2147483647<a||-2147483648>a)a&=4294967295;return a};AddressImpl.prototype.equals=function(a){return this==a||a instanceof AddressImpl&&this.getURI()==a.getURI()?!0:!1};AddressImpl.prototype.hasDisplayName=function(){return null!=this.displayName?!0:!1};
AddressImpl.prototype.removeDisplayName=function(){this.displayName=null};AddressImpl.prototype.isSIPAddress=function(){return this.address instanceof SipUri?!0:!1};AddressImpl.prototype.getURI=function(){return this.address};AddressImpl.prototype.isWildcard=function(){return this.addressType==this.WILD_CARD?!0:!1};AddressImpl.prototype.setURI=function(a){this.address=a};AddressImpl.prototype.setUser=function(a){this.address instanceof SipUri||(this.address=new SipUri);this.address.setUser(a)};
AddressImpl.prototype.setWildCardFlag=function(){this.addressType=this.WILD_CARD;this.address=new SipUri;this.address.setUser("*")};function AddressFactoryImpl(){this.classname="AddressFactoryImpl"}
AddressFactoryImpl.prototype.createAddress=function(){if(0==arguments.length){var a=new AddressImpl;return a}if(1==arguments.length){if("string"==typeof arguments[0])return this.createAddress_address(arguments[0]);if("object"==typeof arguments[0])return a=arguments[0],a=this.createAddress_uri(a)}else{if(2==arguments.length){var b=arguments[0];a=arguments[1];return a=this.createAddress_name_uri(b,a)}console.error("AddressFactoryImpl:createAddress():  too many arg");throw"AddressFactoryImpl:createAddress():  too many arg";
}};AddressFactoryImpl.prototype.createAddress_name_uri=function(a,b){if(null==b)throw console.error("AddressFactoryImpl:createAddress_name_uri():  null uri arg"),"AddressFactoryImpl:createAddress_name_uri():  null uri arg";var c=new AddressImpl;null!=a&&c.setDisplayName(a);c.setURI(b);return c};
AddressFactoryImpl.prototype.createSipURI=function(){if(0==arguments.length)throw console.error("AddressFactoryImpl:createSipURI(): missing uri arg"),"AddressFactoryImpl:createSipURI():  missing uri arg";if(1==arguments.length){var a=arguments[0];if(null==a)throw console.error("AddressFactoryImpl:createSipURI():  null uri arg"),"AddressFactoryImpl:createSipURI():  null uri arg";return a=(new StringMsgParser).parseSIPUrl(a)}if(2==arguments.length)return a=this.createSipURI_user_host(arguments[0],arguments[1])};
AddressFactoryImpl.prototype.createSipURI_user_host=function(a,b){if(null==b)throw console.error("AddressFactoryImpl:createSipURI_user_host(): null host arg"),"AddressFactoryImpl:createSipURI_user_host():  null host arg";var c="sip:";null!=a&&(c=c+a+"@");b.indexOf(":")!=b.lastIndexOf(":")&&"["!=b.trim().charAt(0)&&(b="["+b+"]");c+=b;return(new StringMsgParser).parseSIPUrl(c.toString())};
AddressFactoryImpl.prototype.createTelURL=function(a){if(null==a)throw console.error("AddressFactoryImpl:createTelURL(): null uri arg"),"AddressFactoryImpl:createTelURL():  null uri arg";a="tel:"+a;return(new StringMsgParser).parseUrl(a)};AddressFactoryImpl.prototype.createAddress_uri=function(a){if(null==a)throw console.error("AddressFactoryImpl:createAddress_uri(): null uri arg"),"AddressFactoryImpl:createAddress_uri():  null uri arg";var b=new AddressImpl;b.setURI(a);return b};
AddressFactoryImpl.prototype.createAddress_address=function(a){if(null==a)throw console.error("AddressFactoryImpl:createAddress_address(): null address arg"),"AddressFactoryImpl:createAddress_address():  null address arg";if("*"==a){var b=new AddressImpl;b.setAddressType(b.wild_card);a=new SipUri;a.setUser("*")}else b=new AddressImpl,a=this.createURI(a);b.setURI(a);return b};
AddressFactoryImpl.prototype.createURI=function(a){if(null==a)throw console.error("AddressFactoryImpl:createURI(): null uri arg"),"AddressFactoryImpl:createURI():  null uri arg";var b=new URLParser(a),c=b.peekScheme();if(null==c)throw console.error("AddressFactoryImpl:createURI(): bad scheme"),"AddressFactoryImpl:createURI():  bad scheme";return"sip"==c.toLowerCase()||"sips"==c.toLowerCase()?b.sipURL(!0):"tel"==c.toLowerCase()?b.telURL(!0):new GenericURI(a)};
function SIPObject(){this.classname="SIPObject"}SIPObject.prototype=new GenericObject;SIPObject.prototype.constructor=SIPObject;function SIPHeader(a){this.classname="SIPHeader";this.headerName=null;null!=a&&(this.headerName=a)}SIPHeader.prototype.COLON=":";SIPHeader.prototype.SP=" ";SIPHeader.prototype.NEWLINE="\r\n";SIPHeader.prototype.getHeaderName=function(){return this.headerName};SIPHeader.prototype.getName=function(){return this.headerName};
SIPHeader.prototype.setHeaderName=function(a){this.headerName=a};SIPHeader.prototype.getHeaderValue=function(){for(var a=this.encode();0<a.length&&":"!=a.charAt(0);)a=a.substring(1);0<a.length&&(a=a.substring(1));return a.toString().trim()};SIPHeader.prototype.isHeaderList=function(){return!1};SIPHeader.prototype.encode=function(){return this.encodeBuffer("").toString()};SIPHeader.prototype.encodeBuffer=function(a){a=a+this.headerName+this.COLON+this.SP;a=this.encodeBodyBuffer(a);return a+=this.NEWLINE};
SIPHeader.prototype.encodeBody=function(){};SIPHeader.prototype.encodeBodyBuffer=function(a){return a+=this.encodeBody()};SIPHeader.prototype.getValue=function(){return this.getHeaderValue()};SIPHeader.prototype.hashCode=function(){var a=0,b=this.headerName;if(null!=b&&""!=b.value)for(var c=0;c<b.length;c++)if(a=31*a+b.charCodeAt(c),2147483647<a||-2147483648>a)a&=4294967295;return a};SIPHeader.prototype.toString=function(){return this.encode()};
function SIPHeaderList(){this.classname="SIPHeaderList";this.prettyEncode=!1;this.hlist=[];this.myClass=null;if(0!=arguments.length){var a=arguments[0];this.headerName=arguments[1];this.myClass=a}}SIPHeaderList.prototype=new SIPHeader;SIPHeaderList.prototype.constructor=SIPHeaderList;SIPHeaderList.prototype.NEWLINE="\r\n";SIPHeaderList.prototype.WWW_AUTHENTICATE="WWW-Authenticate";SIPHeaderList.prototype.PROXY_AUTHENTICATE="Proxy-Authenticate";SIPHeaderList.prototype.AUTHORIZATION="Authorization";
SIPHeaderList.prototype.PROXY_AUTHORIZATION="Proxy-Authorization";SIPHeaderList.prototype.ROUTE="Route";SIPHeaderList.prototype.RECORD_ROUTE="Record-Route";SIPHeaderList.prototype.VIA="Via";SIPHeaderList.prototype.COLON=":";SIPHeaderList.prototype.SP=" ";SIPHeaderList.prototype.COMMA=",";SIPHeaderList.prototype.SEMICOLON=";";SIPHeaderList.prototype.getName=function(){return this.headerName};
SIPHeaderList.prototype.add=function(){if(1==arguments.length){for(var a=arguments[0],b=null,c=0;c<this.hlist.length;c++)a==this.hlist[c]&&(b=c);null==b&&this.hlist.push(a)}else if("object"==typeof arguments[0])c=arguments[0],arguments[1]?this.addFirst(c):this.add(c);else if("number"==typeof arguments[0])if(a=arguments[0],c=arguments[1],null!=this.hlist[a])for(b=this.hlist.slice(a),this.hlist[a]=c,c=0;c<b.length;c++)this.hlist[a+c+1]=b[c];else this.hlist[a]=c};SIPHeaderList.prototype.addFirst=function(a){this.hlist.unshift(a)};
SIPHeaderList.prototype.concatenate=function(a,b){b?this.addAll(0,a):this.addAll(a)};SIPHeaderList.prototype.encode=function(){return this.encodeBuffer("").toString()};
SIPHeaderList.prototype.encodeBuffer=function(a){if(0==this.hlist.length)a=a+this.headerName+":"+this.NEWLINE;else if(this.headerName==this.WWW_AUTHENTICATE||this.headerName==this.PROXY_AUTHENTICATE||this.headerName==this.AUTHORIZATION||this.headerName==this.PROXY_AUTHORIZATION||this.prettyEncode&&(this.headerName==this.VIA||this.headerName==this.ROUTE||this.headerName==this.RECORD_ROUTE)||"ExtensionHeaderList"==this.classname)for(var b=0;b<this.hlist.length;b++)a=this.hlist[b].encodeBuffer(a);else a=
a+this.headerName+this.COLON+this.SP,a=this.encodeBodyBuffer(a),a+=this.NEWLINE;return a};SIPHeaderList.prototype.getHeadersAsEncodedStrings=function(){for(var a=[],b=0;b<this.hlist.length;b++)a[b]=this.hlist[b].toString();return a};SIPHeaderList.prototype.getFirst=function(){return null==this.hlist||0==this.hlist.length?null:this.hlist[0]};SIPHeaderList.prototype.getLast=function(){return null==this.hlist||0==this.hlist.length?null:this.hlist[this.hlist.length-1]};
SIPHeaderList.prototype.getMyClass=function(){return this.myClass};SIPHeaderList.prototype.isEmpty=function(){return 0==this.hlist?!0:!1};SIPHeaderList.prototype.listIterator=function(){return 0==arguments.length?this.hlist:this.hlist.slice(arguments[0])};SIPHeaderList.prototype.getHeaderList=function(){return this.hlist};SIPHeaderList.prototype.removeFirst=function(){0!=this.hlist.length&&this.hlist.splice(0,1)};
SIPHeaderList.prototype.removeLast=function(){0!=this.hlist.length&&this.hlist.splice(this.hlist.length-1,1)};SIPHeaderList.prototype.remove=function(a){if("number"==typeof a){var b=this.hlist[a];this.hlist.splice(a,1);return b}if("object"==typeof a&&0!=this.hlist.length){b=null;for(var c=0;c<this.hlist.length;c++)this.hlist[c]==a&&(b=c);if(null!=b)return this.hlist.splice(b,1),!0}return!1};SIPHeaderList.prototype.setMyClass=function(a){this.myClass=a};SIPHeaderList.prototype.toArray=function(){return this.hlist};
SIPHeaderList.prototype.indexOf=function(a){for(var b=null,c=0;c<this.hlist.length;c++)this.hlist[c].classname.toLowerCase()==a.toLowerCase()&&(b=c);return null!=b?b:-1};SIPHeaderList.prototype.size=function(){return this.hlist.length};SIPHeaderList.prototype.isHeaderList=function(){return!0};SIPHeaderList.prototype.encodeBody=function(){return this.encodeBodyBuffer("").toString()};
SIPHeaderList.prototype.encodeBodyBuffer=function(a){for(var b=0;b<this.hlist.length;b++){var c=this.hlist[b];if("SIPHeaderList"==c.classname)throw console.error("SIPHeaderList:encodeBodyBuffer(): unexpected circularity in SipHeaderList"),"SIPHeaderList:encodeBodyBuffer(): unexpected circularity in SipHeaderList";a=c.encodeBodyBuffer(a);b!=this.hlist.length-1&&(a="Privacy"!=this.headerName?a+this.COMMA:a+this.SEMICOLON)}return a};
SIPHeaderList.prototype.addAll=function(){if(1==arguments.length){for(var a=arguments[0].hlist,b=this.hlist.length,c=0;c<a.length;c++){var d=c+b;this.hlist[d]=a[c]}if(this.hlist.length!=b)return!0}else if(2==arguments.length){var e=arguments[0];a=arguments[1].hlist;if(null!=this.hlist[e]){var f=this.hlist.slice(e);b=this.hlist.length;for(c=0;c<a.length;c++)d=c+e,this.hlist[d]=a[c];for(c=0;c<f.length;c++)d=e+c+a.length,this.hlist[d]=f[c]}else for(e=arguments[0],a=arguments[1].hlist,b=this.hlist.length,
c=0;c<a.length;c++)d=c+e,this.hlist[d]=a[c];if(this.hlist.length!=b)return!0}return!1};SIPHeaderList.prototype.containsAll=function(a){for(var b=0,c=0;c<a.length;c++)for(var d=0;d<this.hlist.length;d++)this.hlist[d].classname==a[c].classname&&(b+=1);return b==a.length?!0:!1};SIPHeaderList.prototype.clear=function(){this.hlist=[]};SIPHeaderList.prototype.contains=function(a){for(var b=0,c=0;c<this.hlist.length;c++)this.hlist[c].classname==a&&(b=1);return 1==b?!0:!1};SIPHeaderList.prototype.get=function(a){return this.hlist[a]};
SIPHeaderList.prototype.iterator=function(){return this.hlist};SIPHeaderList.prototype.lastIndexOf=function(a){for(var b=null,c=0;c<this.hlist.length;c++)this.hlist[c].classname==a&&(b=c);return null==b?b:-1};SIPHeaderList.prototype.removeAll=function(a){for(var b=[],c=0,d=0,e=0;e<this.hlist.length;e++){for(var f=0;f<a.length;f++)this.hlist[e].classname!=a[f].classname&&null!=a[f].classname&&(d+=1);d==a.length&&(b[c]=this.hlist[e],c+=1);d=0}return this.hlist.length!=b.length?(this.hlist=b,!0):!1};
SIPHeaderList.prototype.retainAll=function(a){for(var b=[],c=0,d=0;d<this.hlist.length;d++)for(var e=0;e<a.length;e++)this.hlist[d].classname==a[e].classname&&(b[c]=this.hlist[d],c+=1);return this.hlist.length!=b.length?(this.hlist=b,!0):!1};SIPHeaderList.prototype.subList=function(a,b){return this.hlist.slice(a,b)};
SIPHeaderList.prototype.hashCode=function(){var a=0,b=this.headerName;if(null!=b&&""!=b.value)for(var c=0;c<b.length;c++)if(a=31*a+b.charCodeAt(c),2147483647<a||-2147483648>a)a&=4294967295;return a};SIPHeaderList.prototype.set=function(a,b){var c=this.hlist[a];this.hlist[a]=b;return c};SIPHeaderList.prototype.setPrettyEncode=function(a){this.prettyEncode=a};
function ParametersHeader(a,b){this.classname="ParametersHeader";this.headerName=this.duplicates=this.parameters=null;null==a&&null==b?(this.parameters=new NameValueList,this.duplicates=new DuplicateNameValueList):null!=a&&null==b?(this.headerName=a,this.parameters=new NameValueList,this.duplicates=new DuplicateNameValueList):null!=a&&null!=b&&(this.headerName=a,this.parameters=new NameValueList(b),this.duplicates=new DuplicateNameValueList)}ParametersHeader.prototype=new SIPHeader;
ParametersHeader.prototype.constructor=ParametersHeader;ParametersHeader.prototype.getParameter=function(a){return this.parameters.getParameter(a)};ParametersHeader.prototype.getParameterValue=function(a){return this.parameters.getValue(a)};ParametersHeader.prototype.getParameterNames=function(){return this.parameters.getNames()};ParametersHeader.prototype.hasParameters=function(){return null!=this.parameters&&0!=this.parameters.hmap.length?!0:!1};ParametersHeader.prototype.removeParameter=function(a){this.parameters.delet(a)};
ParametersHeader.prototype.setQuotedParameter=function(a,b){var c=this.parameters.getNameValue(a);null!=c?(c.setValueAsObject(b),c.setQuotedValue()):(c=new NameValue(a,b),c.setQuotedValue(),this.parameters.set_nv(c))};
ParametersHeader.prototype.setParameter=function(a,b){if("object"==typeof b)this.parameters.set_name_value(a,c);else if("boolean"==typeof b){var c=new Boolean(b);this.parameters.set_name_value(a,c)}else if("number"==typeof b)if(0==b-[b])c=new Number(b),this.parameters.set_name_value(a,c);else{c=new Number(b);var d=this.parameters.getNameValue(a);null!=d?d.setValueAsObject(c):(d=new NameValue(a,c),this.parameters.set_nv(d))}else"string"==typeof b&&(d=this.parameters.getNameValue(a),null!=d?d.setValueAsObject(b):
(d=new NameValue(a,b),this.parameters.set_nv(d)))};ParametersHeader.prototype.hasParameter=function(a){return this.parameters.hasNameValue(a)};ParametersHeader.prototype.removeParameters=function(){this.parameters=new NameValueList};ParametersHeader.prototype.getParameters=function(){return this.parameters};ParametersHeader.prototype.setParameter_nv=function(a){this.parameters.set_nv(a)};ParametersHeader.prototype.setParameters=function(a){this.parameters=a};
ParametersHeader.prototype.getParameterAsNumber=function(a){return null!=this.getParameterValue(a)?this.getParameterValue(a)-0:-1};ParametersHeader.prototype.getParameterAsURI=function(a){a=this.getParameterValue(a);return a instanceof GenericURI?a:new GenericURI(a)};ParametersHeader.prototype.getParameterAsBoolean=function(a){a=this.getParameterValue(a);return null==a?!1:a instanceof Boolean?a:a instanceof String?new Boolean(a):!1};ParametersHeader.prototype.getNameValue=function(a){return this.parameters.getNameValue(a)};
ParametersHeader.prototype.setMultiParameter_name_value=function(a,b){var c=new NameValue;c.setName(a);c.setValue(b);this.duplicates.set_nv(c)};ParametersHeader.prototype.setMultiParameter_nv=function(a){this.duplicates.set_nv(a)};ParametersHeader.prototype.getMultiParameter=function(a){return this.duplicates.getParameter(a)};ParametersHeader.prototype.getMultiParameters=function(){return this.duplicates};ParametersHeader.prototype.getMultiParameterValue=function(a){return this.duplicates.getValue(a)};
ParametersHeader.prototype.getMultiParameterNames=function(){return this.duplicates.getNames()};ParametersHeader.prototype.hasMultiParameters=function(){return null!=this.duplicates&&this.duplicates.length!=o?!0:!1};ParametersHeader.prototype.removeMultiParameter=function(a){this.duplicates.delet(a)};ParametersHeader.prototype.hasMultiParameter=function(a){return this.duplicates.hasNameValue(a)};ParametersHeader.prototype.removeMultiParameters=function(){this.duplicates=new DuplicateNameValueList};
ParametersHeader.prototype.equalParameters=function(a){if(this==a)return!0;for(var b=this.getParameterNames(),c=0;c<b.length;c++){var d=b[c],e=this.getParameter(d);d=a.getParameter(d);if(null==e^null==d||null!=e&&e.toLowerCase()!=d)return!1}b=a.getParameterNames();for(c=0;c<b.length;c++)if(d=b[c],e=a.getParameter(d),d=this.getParameter(d),null==e^null==d||null!=e&&e.toLowerCase()!=d)return!1;return!0};ParametersHeader.prototype.encodeBody=function(){};
function RequestLine(a,b){this.classname="RequestLine";this.uri=new GenericURI;this.method=null;this.sipVersion="SIP/2.0";null!=a&&null!=b&&(this.uri=a,this.method=b)}RequestLine.prototype=new SIPObject;RequestLine.prototype.constructor=RequestLine;RequestLine.prototype.SP=" ";RequestLine.prototype.NEWLINE="\r\n";RequestLine.prototype.encode=function(){return this.encodeBuffer("").toString()};
RequestLine.prototype.encodeBuffer=function(a){null!=this.method&&(a=a+this.method+this.SP);null!=this.uri&&(a=this.uri.encodeBuffer(a),a+=this.SP);return a=a+this.sipVersion+this.NEWLINE};RequestLine.prototype.getUri=function(){return this.uri};RequestLine.prototype.getMethod=function(){return this.method};RequestLine.prototype.getSipVersion=function(){return this.sipVersion};RequestLine.prototype.setUri=function(a){return this.uri=a};RequestLine.prototype.setMethod=function(a){this.method=a};
RequestLine.prototype.setSipVersion=function(a){this.sipVersion=a};RequestLine.prototype.getVersionMajor=function(){if(null==this.sipVersion)return null;for(var a=null,b=!1,c=0;c<this.sipVersion.length&&"."!=this.sipVersion.charAt(c);c++)b&&(a=null==a?""+this.sipVersion.charAt(c):a+this.sipVersion.charAt(c)),"/"==this.sipVersion.charAt(c)&&(b=!0);return a};
RequestLine.prototype.getVersionMinor=function(){if(null==this.sipVersion)return null;for(var a=null,b=!1,c=0;c<this.sipVersion.length&&"."!=this.sipVersion.charAt(c);c++)b&&(a=null==a?""+this.sipVersion.charAt(c):a+this.sipVersion.charAt(c)),"/"==this.sipVersion.charAt(c)&&(b=!0);return a};function UserAgent(){this.classname="UserAgent";this.productTokens=[];this.headerName=this.NAME}UserAgent.prototype=new SIPHeader;UserAgent.prototype.constructor=UserAgent;UserAgent.prototype.NAME="User-Agent";
UserAgent.prototype.encodeProduct=function(){for(var a="",b=0;b<this.productTokens.length;b++)a+=this.productTokens[b];return a.toString()};UserAgent.prototype.addProductToken=function(a){this.productTokens[this.productTokens.length]=a};UserAgent.prototype.encodeBody=function(){return this.encodeProduct()};UserAgent.prototype.getProduct=function(){return null==this.productTokens||0==this.productTokens.length?null:this.productTokens};
UserAgent.prototype.setProduct=function(a){if(null==a)throw console.error("UserAgent:setProduct(): the product parameter is null"),"UserAgent:setProduct(): the product parameter is null";this.productTokens=a};function ContentLength(a){this.classname="ContentLength";this.headerName=this.NAME;this.contentLength=null;null==a?this.headerName=this.NAME:(this.headerName=this.NAME,this.contentLength=a)}ContentLength.prototype=new SIPHeader;ContentLength.prototype.constructor=ContentLength;
ContentLength.prototype.NAME="Content-Length";ContentLength.prototype.getContentLength=function(){return this.contentLength-0};ContentLength.prototype.setContentLength=function(a){if(0>a)throw console.error("ContentLength:setContentLength(): the contentLength parameter is < 0"),"ContentLength:setContentLength(): the contentLength parameter is < 0";this.contentLength=a};ContentLength.prototype.encodeBody=function(){return this.encodeBodyBuffer("").toString()};
ContentLength.prototype.encodeBodyBuffer=function(a){return a=null==this.contentLength?a+"0":a+this.contentLength.toString()};ContentLength.prototype.match=function(a){return a instanceof ContentLength?!0:!1};function ExtensionHeaderImpl(a){this.classname="ExtensionHeaderImpl";this.value=null;null!=a&&(this.headerName=a)}ExtensionHeaderImpl.prototype=new SIPHeader;ExtensionHeaderImpl.prototype.constructor=ExtensionHeaderImpl;ExtensionHeaderImpl.prototype.COLON=":";
ExtensionHeaderImpl.prototype.SP=" ";ExtensionHeaderImpl.prototype.NEWLINE="\r\n";ExtensionHeaderImpl.prototype.setName=function(a){this.headerName=a};ExtensionHeaderImpl.prototype.setValue=function(a){this.value=a};
ExtensionHeaderImpl.prototype.getHeaderValue=function(){if(null==this.value){var a=null;try{a=this.encode()}catch(d){return console.error("ExtensionHeaderImpl:getHeaderValue(): catched exception:"+d),null}for(var b=0,c=a.substring(b);0<c.length&&":"!=a.charAt(0);)b+=1,c=a.substring(b);c=a.substring(b+1);this.value=c.toString().trim()}return this.value};ExtensionHeaderImpl.prototype.encode=function(){return""+this.headerName+this.COLON+this.SP+this.value+this.NEWLINE};
ExtensionHeaderImpl.prototype.encodeBody=function(){return this.getHeaderValue()};function Server(a){this.classname="Server";this.productTokens=[];this.headerName=this.NAME}Server.prototype=new SIPHeader;Server.prototype.constructor=Server;Server.prototype.NAME="Server";Server.prototype.encodeProduct=function(){for(var a="",b=0;b<this.productTokens.length;b++)if(a+=this.productTokens[b],b!=this.productTokens.length-1)a+="/";else break;return a.toString()};Server.prototype.addProductToken=function(a){this.productTokens.push(a)};
Server.prototype.encodeBody=function(){return this.encodeProduct()};Server.prototype.getProduct=function(){return null==this.productTokens||0==this.productTokens.length?null:this.productTokens};Server.prototype.setProduct=function(a){if(null==a)throw console.error("Server:setProduct(): the product parameter is null"),"Server:setProduct(): the product parameter is null";this.productTokens=a};
function AddressParametersHeader(a,b){this.classname="AddressParametersHeader";this.address=new AddressImpl;this.headerName=null;null!=a&&null==b?(this.headerName=a,this.parameters=new NameValueList,this.duplicates=new DuplicateNameValueList):null!=a&&null!=b&&(this.headerName=a,this.parameters=new NameValueList(b),this.duplicates=new DuplicateNameValueList)}AddressParametersHeader.prototype=new ParametersHeader;AddressParametersHeader.prototype.constructor=AddressParametersHeader;
AddressParametersHeader.prototype.getAddress=function(){return this.address};AddressParametersHeader.prototype.setAddress=function(a){this.address=a};AddressParametersHeader.prototype.equals=function(a){return this==a||a instanceof ParametersHeader&&this.getAddress().equals(a.getAddress())&&this.equalParameters(a)?!0:!1};
function From(a){this.classname="From";this.duplicates=this.parameters=null;this.address=new AddressImpl;null==a?(this.headerName=this.NAME,this.parameters=new NameValueList,this.duplicates=new DuplicateNameValueList):(this.headerName=this.NAME,this.address=a.address,this.parameters=a.parameters)}From.prototype=new AddressParametersHeader;From.prototype.constructor=From;From.prototype.NAME="From";From.prototype.ADDRESS_SPEC=2;From.prototype.LESS_THAN="<";From.prototype.GREATER_THAN=">";
From.prototype.SEMICOLON=";";From.prototype.TAG="tag";From.prototype.encodeBody=function(){return this.encodeBodyBuffer("").toString()};From.prototype.encodeBodyBuffer=function(a){this.address.getAddressType()==this.ADDRESS_SPEC&&(a+=this.LESS_THAN);a=this.address.encodeBuffer(a);this.address.getAddressType()==this.ADDRESS_SPEC&&(a+=this.GREATER_THAN);0!=this.parameters.hmap.length&&(a+=this.SEMICOLON,a=this.parameters.encodeBuffer(a));return a};From.prototype.getHostPort=function(){return this.address.getHostPort()};
From.prototype.getDisplayName=function(){return this.address.getDisplayName()};From.prototype.getTag=function(){return null==this.parameters?null:this.getParameter(this.TAG)};From.prototype.hasTag=function(){return this.hasParameter(this.TAG)};From.prototype.removeTag=function(){this.parameters.delet(this.TAG)};From.prototype.setAddress=function(a){this.address=a};From.prototype.setTag=function(a){(new Parser).checkToken(a);this.setParameter(this.TAG,a)};From.prototype.getUserAtHostPort=function(){return this.address.getUserAtHostPort()};
From.prototype.equals=function(a){return a instanceof From&&Object.getPrototypeOf(this).equals(a)?!0:!1};From.prototype.getAddress=function(){return this.address};function To(a){this.classname="To";null==a?(this.headerName=this.NAME,this.parameters=new NameValueList,this.duplicates=new DuplicateNameValueList):(this.headerName=this.NAME,this.parameters=new NameValueList,this.duplicates=new DuplicateNameValueList,this.setAddress(a.address),this.setParameters(a.parameters))}To.prototype=new AddressParametersHeader;
To.prototype.constructor=To;To.prototype.NAME="To";To.prototype.ADDRESS_SPEC=2;To.prototype.LESS_THAN="<";To.prototype.GREATER_THAN=">";To.prototype.SEMICOLON=";";To.prototype.TAG="tag";To.prototype.COLON=":";To.prototype.SP=" ";To.prototype.NEWLINE="\r\n";To.prototype.encode=function(){return this.headerName+this.COLON+this.SP+this.encodeBody()+this.NEWLINE};To.prototype.encodeBody=function(){return this.encodeBodyBuffer("").toString()};
To.prototype.encodeBodyBuffer=function(a){null!=this.address&&(this.address.getAddressType()==this.ADDRESS_SPEC&&(a+=this.LESS_THAN),a=this.address.encodeBuffer(a),this.address.getAddressType()==this.ADDRESS_SPEC&&(a+=this.GREATER_THAN),this.parameters.isEmpty()||(a+=this.SEMICOLON,a=this.parameters.encodeBuffer(a)));return a};To.prototype.getHostPort=function(){return null==this.address?null:this.address.getHostPort()};To.prototype.getDisplayName=function(){return null==this.address?null:this.address.getDisplayName()};
To.prototype.getTag=function(){return null==this.parameters?null:this.getParameter(this.TAG)};To.prototype.hasTag=function(){return null==this.parameters?!1:this.hasParameter(this.TAG)};To.prototype.removeTag=function(){null!=this.parameters&&this.parameters.delet(this.TAG)};To.prototype.setTag=function(a){(new Parser).checkToken(a);this.setParameter(this.TAG,a)};To.prototype.getUserAtHostPort=function(){return null==this.address?null:this.address.getUserAtHostPort()};
function ReferTo(a,b){this.classname="ReferTo";null==a?(this.headerName=this.NAME,this.parameters=new NameValueList,this.duplicates=new DuplicateNameValueList,this.replaces=null):(this.headerName=this.NAME,this.parameters=new NameValueList,this.duplicates=new DuplicateNameValueList,this.setAddress(a.address),this.setParameters(a.parameters),this.setReplaces(b))}ReferTo.prototype=new AddressParametersHeader;ReferTo.prototype.constructor=ReferTo;ReferTo.prototype.NAME="Refer-To";
ReferTo.prototype.ADDRESS_SPEC=2;ReferTo.prototype.LESS_THAN="<";ReferTo.prototype.GREATER_THAN=">";ReferTo.prototype.SEMICOLON=";";ReferTo.prototype.TAG="tag";ReferTo.prototype.COLON=":";ReferTo.prototype.SP=" ";ReferTo.prototype.NEWLINE="\r\n";ReferTo.prototype.setReplaces=function(a){this.replaces=a};ReferTo.prototype.encode=function(){return this.headerName+this.COLON+this.SP+this.encodeBody()+this.NEWLINE};ReferTo.prototype.encodeBody=function(){return this.encodeBodyBuffer("").toString()};
ReferTo.prototype.encodeBodyBuffer=function(a){null!=this.address&&(this.address.getAddressType()==this.ADDRESS_SPEC&&(a+=this.LESS_THAN),a=this.address.encodeBuffer(a),null!=this.replaces&&(a=">"==a.charAt(a.length-1)?a.slice(0,a.length-1)+"?Replaces="+this.replaces.encodeBodyBuffer("")+this.GREATER_THAN:a+"?Replaces="+this.replaces.encodeBodyBuffer("")),this.address.getAddressType()==this.ADDRESS_SPEC&&(a+=this.GREATER_THAN),this.parameters.isEmpty()||(a+=this.SEMICOLON,a=this.parameters.encodeBuffer(a)));
return a};ReferTo.prototype.getHostPort=function(){return null==this.address?null:this.address.getHostPort()};ReferTo.prototype.getDisplayName=function(){return null==this.address?null:this.address.getDisplayName()};ReferTo.prototype.getTag=function(){return null==this.parameters?null:this.getParameter(this.TAG)};ReferTo.prototype.hasTag=function(){return null==this.parameters?!1:this.hasParameter(this.TAG)};ReferTo.prototype.removeTag=function(){null!=this.parameters&&this.parameters.delet(this.TAG)};
ReferTo.prototype.setTag=function(a){(new Parser).checkToken(a);this.setParameter(this.TAG,a)};ReferTo.prototype.getUserAtHostPort=function(){return null==this.address?null:this.address.getUserAtHostPort()};
function ReferredBy(a){this.classname="ReferredBy";null==a?(this.headerName=this.NAME,this.parameters=new NameValueList,this.duplicates=new DuplicateNameValueList):(this.headerName=this.NAME,this.parameters=new NameValueList,this.duplicates=new DuplicateNameValueList,this.setAddress(a.address),this.setParameters(a.parameters))}ReferredBy.prototype=new ReferTo;ReferredBy.prototype.constructor=ReferredBy;ReferredBy.prototype.NAME="Referred-By";
function Reason(){this.classname="Reason";this.headerName=this.NAME;this.parameters=new NameValueList;this.duplicates=new DuplicateNameValueList;this.protocol=null}Reason.prototype=new ParametersHeader;Reason.prototype.constructor=Reason;Reason.prototype.NAME="Reason";Reason.prototype.TEXT="text";Reason.prototype.CAUSE="cause";Reason.prototype.SEMICOLON=";";Reason.prototype.getCause=function(){return this.getParameterAsNumber(this.CAUSE)};
Reason.prototype.setCause=function(a){this.parameters.set_name_value("cause",a)};Reason.prototype.setProtocol=function(a){this.protocol=a};Reason.prototype.getProtocol=function(){return this.protocol};Reason.prototype.setText=function(a){'"'!=a.charAt(0)&&(a=Utils.prototype.getQuotedString(a));this.parameters.set_name_value("text",a)};Reason.prototype.getText=function(){return this.parameters.getParameter("text")};Reason.prototype.getName=function(){return this.NAME};
Reason.prototype.encodeBody=function(){var a=""+this.protocol;null!=this.parameters&&0!=this.parameters.hmap.length&&(a=a+this.SEMICOLON+this.parameters.encode());return a.toString()};function ReasonList(){this.classname="ReasonList";this.headerName=this.NAME;this.myClass="Reason"}ReasonList.prototype=new SIPHeaderList;ReasonList.prototype.constructor=ReasonList;ReasonList.prototype.NAME="Reason";ReasonList.prototype.clone=function(){};
function Protocol(){this.classname="Protocol";this.protocolName="SIP";this.protocolVersion="2.0";this.transport=SipStackImpl.prototype.DEFAULT_WS_TRANSPORT}Protocol.prototype=new SIPObject;Protocol.prototype.constructor=Protocol;Protocol.prototype.SLASH="/";Protocol.prototype.encode=function(){return this.encodeBuffer("").toString()};Protocol.prototype.encodeBuffer=function(a){return a=a+this.protocolName.toUpperCase()+this.SLASH+this.protocolVersion+this.SLASH+this.transport.toUpperCase()};
Protocol.prototype.getProtocolName=function(){return this.protocolName};Protocol.prototype.getProtocolVersion=function(){return this.protocolVersion};Protocol.prototype.getProtocol=function(){return this.protocolName+"/"+this.protocolVersion};
Protocol.prototype.setProtocol=function(a){var b=a.indexOf("/");if(0<b)this.protocolName=a.substring(0,b),this.protocolVersion=a.substring(b+1);else throw console.error("Event:setProtocol(): missing '/' in protocol",0),"Event:setProtocol(): missing '/' in protocol";};Protocol.prototype.getTransport=function(){return this.transport};Protocol.prototype.setProtocolName=function(a){this.protocolName=a};Protocol.prototype.setProtocolVersion=function(a){this.protocolVersion=a};
Protocol.prototype.setTransport=function(a){this.transport=a};function Via(){this.classname="Via";this.sentProtocol=new Protocol;this.sentBy=new HostPort;this.comment=null;this.rPortFlag=!0;this.headerName=this.NAME;this.parameters=new NameValueList;this.duplicates=new DuplicateNameValueList}Via.prototype=new ParametersHeader;Via.prototype.constructor=Via;Via.prototype.NAME="Via";Via.prototype.BRANCH="branch";Via.prototype.RECEIVED="received";Via.prototype.MADDR="maddr";Via.prototype.TTL="ttl";
Via.prototype.RPORT="rport";Via.prototype.SP=" ";Via.prototype.SEMICOLON=";";Via.prototype.LPAREN="(";Via.prototype.RPAREN=")";Via.prototype.getProtocolVersion=function(){return null==this.sentProtocol?null:this.sentProtocol.getProtocolVersion()};Via.prototype.getSentProtocol=function(){return this.sentProtocol};Via.prototype.getSentBy=function(){return this.sentBy};Via.prototype.getHop=function(){return new HopImpl(this.sentBy.getHost().getHostname())};Via.prototype.getViaParms=function(){return this.parameters};
Via.prototype.hasPort=function(){return this.getSentBy().hasPort()};Via.prototype.hasComment=function(){return null!=this.comment?!0:!1};Via.prototype.removePort=function(){this.sentBy.removePort()};Via.prototype.removeComment=function(){this.comment=null};Via.prototype.setProtocolVersion=function(){null==this.sentProtocol&&(this.sentProtocol=new Protocol);this.sentProtocol.setProtocolVersion(this.protocolVersion)};
Via.prototype.setHost=function(a){"object"==typeof a?(null==this.sentBy&&(this.sentBy=new HostPort),this.sentBy.setHost(a)):"string"==typeof a&&(null==this.sentBy&&(this.sentBy=new HostPort),a=new Host(a),this.sentBy.setHost(a))};Via.prototype.setSentProtocol=function(a){this.sentProtocol=a};Via.prototype.setSentBy=function(a){this.sentBy=a};Via.prototype.encodeBody=function(){return this.encodeBodyBuffer("").toString()};
Via.prototype.encodeBodyBuffer=function(a){a=this.sentProtocol.encodeBuffer(a);a+=this.SP;a=this.sentBy.encodeBuffer(a);0!=this.parameters.length&&(a+=this.SEMICOLON,a=this.parameters.encodeBuffer(a));null!=this.comment&&(a=a+this.SP+this.LPAREN+this.comment+this.RPAREN);this.rPortFlag&&null==this.getParameter(this.RPORT)&&(a+=";rport");return a};Via.prototype.getHost=function(){if(null==this.sentBy)return null;var a=this.sentBy.getHost();return null==a?null:a.getHostname()};
Via.prototype.setPort=function(a){if(-1!=a&&(1>a||65535<a))throw console.error("Via:setPort(): port value out of range -1, [1..65535]"),"Via:setPort(): port value out of range -1, [1..65535]";null==this.sentBy&&(this.sentBy=new HostPort);this.sentBy.setPort(a)};Via.prototype.setRPort=function(){this.rPortFlag=!0};Via.prototype.getPort=function(){return null==this.sentBy?-1:this.sentBy.getPort()};
Via.prototype.getRPort=function(){var a=this.getParameter(this.RPORT);return null==a||a.equals("")?-1:a-0};Via.prototype.getTransport=function(){return null==this.sentProtocol?"WSS":this.sentProtocol.getTransport()};Via.prototype.setTransport=function(a){if(null==a)throw console.error("Via:setTransport(): the transport parameter is null"),"Via:setTransport(): the transport parameter is null";null==this.sentProtocol&&(this.sentProtocol=new Protocol);this.sentProtocol.setTransport(a)};
Via.prototype.getProtocol=function(){return null==this.sentProtocol?null:this.sentProtocol.getProtocol()};Via.prototype.setProtocol=function(a){if(null==a)throw console.error("Via:setProtocol(): the transport parameter is null"),"Via:setProtocol(): the protocol parameter is null";null==this.sentProtocol&&(this.sentProtocol=new Protocol);this.sentProtocol.setProtocol(a)};Via.prototype.getTTL=function(){return this.getParameterAsNumber(this.TTL)};
Via.prototype.setTTL=function(a){if(0>a&&-1!=a)throw console.error("Via:setTTL():  the ttl parameter is < 0"),"Via:setTTL(): the ttl parameter is < 0";this.setParameter_nv(new NameValue(this.TTL,a-0))};Via.prototype.getMAddr=function(){return this.getParameter(this.MADDR)};Via.prototype.setMAddr=function(a){if(null==a)throw console.error("Via:setMAddr():  the mAddr parameter is < 0"),"Via:setMAddr(): the mAddr parameter is < 0";var b=new Host;b.setAddress(a);a=new NameValue(this.MADDR,b);this.setParameter_nv(a)};
Via.prototype.getReceived=function(){return this.getParameter(this.RECEIVED)};Via.prototype.setReceived=function(a){if(null==a)throw console.error("Via:setReceived():  the received parameter is < 0"),"Via:setReceived(): the received parameter is < 0";this.setParameter(this.RECEIVED,a)};Via.prototype.getBranch=function(){return this.getParameter(this.BRANCH)};
Via.prototype.setBranch=function(a){if(null==a||0==a.length)throw console.error("Via:setBranch():  branch parameter is null or length 0"),"Via:setBranch(): branch parameter is null or length 0";this.setParameter(this.BRANCH,a)};Via.prototype.getSentByField=function(){return null!=this.sentBy?this.sentBy.encode():null};Via.prototype.getSentProtocolField=function(){return null!=this.sentProtocol?this.sentProtocol.encode():null};
function Contact(){this.classname="Contact";this.headerName=this.NAME;this.parameters=new NameValueList;this.duplicates=new DuplicateNameValueList;this.address=new AddressImpl;this.Q=this.Q;this.contactList=new ContactList;this.wildCardFlag=null}Contact.prototype=new AddressParametersHeader;Contact.prototype.constructor=Contact;Contact.prototype.NAME="Contact";Contact.prototype.ACTION="action";Contact.prototype.PROXY="proxy";Contact.prototype.REDIRECT="redirect";Contact.prototype.EXPIRES="expires";
Contact.prototype.Q="q";Contact.prototype.NAME_ADDR=1;Contact.prototype.SEMICOLON=";";Contact.prototype.SIP_INSTANCE="+sip.instance";Contact.prototype.PUB_GRUU="pub-gruu";Contact.prototype.TEMP_GRUU="temp-gruu";Contact.prototype.setParameter=function(a,b){var c=this.parameters.getNameValue(a);null!=c?c.setValueAsObject(b):(c=new NameValue(a,b),"methods"==a.toLowerCase()&&c.setQuotedValue(),this.parameters.set_nv(c))};Contact.prototype.encodeBody=function(){return this.encodeBodyBuffer("")};
Contact.prototype.encodeBodyBuffer=function(a){this.wildCardFlag?a+="*":(this.address.getAddressType()==this.NAME_ADDR?a=this.address.encodeBuffer(a):(a=this.address.encodeBuffer(a+"<"),a+=">"),0!=this.parameters.hmap.length&&(a+=this.SEMICOLON,a=this.parameters.encodeBuffer(a)));return a};Contact.prototype.getContactList=function(){return this.contactList};Contact.prototype.getWildCardFlag=function(){return this.wildCardFlag};Contact.prototype.getAddress=function(){return this.address};
Contact.prototype.getContactParms=function(){return this.parameters};Contact.prototype.getExpires=function(){return this.getParameterAsNumber(this.EXPIRES)};Contact.prototype.setExpires=function(a){this.parameters.set_name_value(this.EXPIRES,a-0)};Contact.prototype.getQValue=function(){return this.getParameterAsNumber(Q)};Contact.prototype.setContactList=function(a){this.contactList=a};Contact.prototype.setWildCardFlag=function(a){this.wildCardFlag=!0;this.address=new AddressImpl;this.address.setWildCardFlag()};
Contact.prototype.setAddress=function(a){if(null==a)throw console.error("CSeq:setAddress(): the address parameter is null"),"CSeq:setAddress(): the address parameter is null";this.address=a;this.wildCardFlag=!1};Contact.prototype.setQValue=function(a){if(-1!=a&&(0>a||1<a))throw console.error("CSeq:setQValue(): the qValue is not between 0 and 1"),"CSeq:setQValue(): Jthe qValue is not between 0 and 1";a=new Number(a);this.parameters.set_name_value(Q,a)};Contact.prototype.setWildCard=function(){this.setWildCardFlag(!0)};
Contact.prototype.isWildCard=function(){return this.address.isWildcard()};Contact.prototype.removeSipInstanceParam=function(){null!=this.parameters&&this.parameters.delet(this.SIP_INSTANCE)};Contact.prototype.getSipInstanceParam=function(){return this.parameters.getValue(this.SIP_INSTANCE)};Contact.prototype.setSipInstanceParam=function(a){this.parameters.set_name_value(this.SIP_INSTANCE,a)};Contact.prototype.removePubGruuParam=function(){null!=this.parameters&&this.parameters.delet(this.PUB_GRUU)};
Contact.prototype.getPubGruuParam=function(){return this.parameters.getValue(this.PUB_GRUU)};Contact.prototype.setPubGruuParam=function(a){this.parameters.set_name_value(this.PUB_GRUU,a)};Contact.prototype.removeTempGruuParam=function(){null!=this.parameters&&this.parameters.delet(this.TEMP_GRUU)};Contact.prototype.getTempGruuParam=function(){return this.parameters.getValue(this.TEMP_GRUU)};Contact.prototype.setTempGruuParam=function(a){this.parameters.set_name_value(this.TEMP_GRUU,a)};
function MediaRange(){this.classname="MediaRange";this.subtype=this.type=null}MediaRange.prototype=new SIPObject;MediaRange.prototype.constructor=MediaRange;MediaRange.prototype.SLASH="/";MediaRange.prototype.getType=function(){return this.type};MediaRange.prototype.getSubtype=function(){return this.subtype};MediaRange.prototype.setType=function(a){this.type=a};MediaRange.prototype.setSubtype=function(a){this.subtype=a};MediaRange.prototype.encode=function(){return this.encodeBuffer("").toString()};
MediaRange.prototype.encodeBuffer=function(a){return a=a+this.type+this.SLASH+this.subtype};function AuthenticationHeader(a){this.classname="AuthenticationHeader";this.scheme=this.headerName=null;null==a?(this.parameters=new NameValueList,this.duplicates=new DuplicateNameValueList,this.parameters.setSeparator(this.COMMA)):(this.headerName=a,this.parameters=new NameValueList,this.duplicates=new DuplicateNameValueList,this.parameters.setSeparator(this.COMMA),this.scheme=this.DIGEST)}
AuthenticationHeader.prototype=new ParametersHeader;AuthenticationHeader.prototype.constructor=AuthenticationHeader;AuthenticationHeader.prototype.DOMAIN="domain";AuthenticationHeader.prototype.REALM="realm";AuthenticationHeader.prototype.OPAQUE="opaque";AuthenticationHeader.prototype.ALGORITHM="algorithm";AuthenticationHeader.prototype.QOP="qop";AuthenticationHeader.prototype.STALE="stale";AuthenticationHeader.prototype.SIGNATURE="signature";AuthenticationHeader.prototype.RESPONSE="response";
AuthenticationHeader.prototype.SIGNED_BY="signed-by";AuthenticationHeader.prototype.NC="nc";AuthenticationHeader.prototype.URI="uri";AuthenticationHeader.prototype.USERNAME="username";AuthenticationHeader.prototype.CNONCE="cnonce";AuthenticationHeader.prototype.NONCE="nonce";AuthenticationHeader.prototype.IK="ik";AuthenticationHeader.prototype.CK="ck";AuthenticationHeader.prototype.INTEGRITY_PROTECTED="integrity-protected";AuthenticationHeader.prototype.COMMA=",";
AuthenticationHeader.prototype.DIGEST="Digest";AuthenticationHeader.prototype.DOUBLE_QUOTE='"';AuthenticationHeader.prototype.SP=" ";
AuthenticationHeader.prototype.setParameter=function(a,b){var c=this.parameters.getNameValue(a.toLowerCase());if(null==c){c=new NameValue(a,b);if(a.toLowerCase()==this.QOP||a.toLowerCase()==this.REALM||a.toLowerCase()==this.CNONCE||a.toLowerCase()==this.NONCE||a.toLowerCase()==this.USERNAME||a.toLowerCase()==this.DOMAIN||a.toLowerCase()==this.OPAQUE||a.toLowerCase()==this.NEXT_NONCE||a.toLowerCase()==this.URI||a.toLowerCase()==this.RESPONSE||a.toLowerCase()==this.IK||a.toLowerCase()==this.CK||a.toLowerCase()==
this.INTEGRITY_PROTECTED){(this instanceof Authorization||this instanceof ProxyAuthorization)&&a.toLowerCase()==this.QOP||c.setQuotedValue();if(null==b)throw console.error("AuthenticationHeader:setParameter(): null value"),"AuthenticationHeader:setParameter(): null value";if(b.charAt(0)==this.DOUBLE_QUOTE)throw console.error("AuthenticationHeader:setParameter(): unexpected DOUBLE_QUOTE"),"AuthenticationHeader:setParameter(): unexpected DOUBLE_QUOTE";}this.parameters.set_nv(c)}else c.setValueAsObject(b)};
AuthenticationHeader.prototype.setChallenge=function(a){this.scheme=a.scheme;this.parameters=a.authParams};AuthenticationHeader.prototype.encodeBody=function(){this.parameters.setSeparator(this.COMMA);return this.scheme+this.SP+this.parameters.encode()};AuthenticationHeader.prototype.setScheme=function(a){this.scheme=a};AuthenticationHeader.prototype.getScheme=function(){return this.scheme};
AuthenticationHeader.prototype.setRealm=function(a){if(null==a)throw console.error("AuthenticationHeader:setRealm(): the realm parameter is null"),"AuthenticationHeader:setRealm(): the realm parameter is null";this.setParameter(this.REALM,a)};AuthenticationHeader.prototype.getRealm=function(){return this.getParameter(this.REALM)};
AuthenticationHeader.prototype.setNonce=function(a){if(null==a)throw console.error("AuthenticationHeader:setNonce(): the nonce parameter is null"),"AuthenticationHeader:setNonce(): the nonce parameter is null";this.setParameter(this.NONCE,a)};AuthenticationHeader.prototype.getNonce=function(){return this.getParameter(this.NONCE)};
AuthenticationHeader.prototype.setURI=function(a){if(null!=a)a=new NameValue(this.URI,a),a.setQuotedValue(),this.parameters.set_nv(a);else throw console.error("AuthenticationHeader:setNonce(): the uri parameter is null"),"AuthenticationHeader:setURI(): the uri parameter is null";};AuthenticationHeader.prototype.getURI=function(){return this.getParameterAsURI(this.URI)};
AuthenticationHeader.prototype.setAlgorithm=function(a){if(null==a)throw console.error("AuthenticationHeader:setAlgorithm(): the algorithm parameter is null"),"AuthenticationHeader:setAlgorithm(): the algorithm parameter is null";this.setParameter(this.ALGORITHM,a)};AuthenticationHeader.prototype.getAlgorithm=function(){return this.getParameter(this.ALGORITHM)};
AuthenticationHeader.prototype.setQop=function(a){if(null==a)throw console.error("AuthenticationHeader:setQop(): the qop parameter is null"),"AuthenticationHeader:setQop(): the qop parameter is null";this.setParameter(this.QOP,a)};AuthenticationHeader.prototype.getQop=function(){return this.getParameter(this.QOP)};
AuthenticationHeader.prototype.setOpaque=function(a){if(null==a)throw console.error("AuthenticationHeader:setOpaque(): the opaque parameter is null"),"AuthenticationHeader:setOpaque(): the opaque parameter is null";this.setParameter(this.OPAQUE,a)};AuthenticationHeader.prototype.getOpaque=function(){return this.getParameter(this.OPAQUE)};
AuthenticationHeader.prototype.setDomain=function(a){if(null==a)throw console.error("AuthenticationHeader:setDomain(): the domain parameter is null"),"AuthenticationHeader:setDomain(): the opaque parameter is null";this.setParameter(this.DOMAIN,a)};AuthenticationHeader.prototype.getDomain=function(){return this.getParameter(this.DOMAIN)};AuthenticationHeader.prototype.setStale=function(a){this.parameters.set_nv(new NameValue(this.STALE,new Boolean(a)))};AuthenticationHeader.prototype.isStale=function(){return this.getParameterAsBoolean(this.STALE)};
AuthenticationHeader.prototype.setCNonce=function(a){this.setParameter(this.CNONCE,a)};AuthenticationHeader.prototype.getCNonce=function(){return this.getParameter(this.CNONCE)};AuthenticationHeader.prototype.getNonceCount=function(){return this.getParameterAsNumber(this.NC)};
AuthenticationHeader.prototype.setNonceCount=function(a){if(0>a)throw console.error("AuthenticationHeader:setNonceCount(): bad parameter"),"AuthenticationHeader:setNonceCount(): bad parameter";a=new String(a);a="00000000".substring(0,8-a.length)+a;this.setParameter(this.NC,a)};AuthenticationHeader.prototype.getResponse=function(){return this.getParameter(this.RESPONSE)};
AuthenticationHeader.prototype.setResponse=function(a){if(null==a)throw console.error("AuthenticationHeader:setResponse(): the domain parameter is null"),"AuthenticationHeader:setResponse():  the opaque parameter is null";this.setParameter(this.RESPONSE,a)};AuthenticationHeader.prototype.getUsername=function(){return this.getParameter(this.USERNAME)};AuthenticationHeader.prototype.setUsername=function(a){this.setParameter(this.USERNAME,a)};
AuthenticationHeader.prototype.setIK=function(a){if(null==a)throw console.error("AuthenticationHeader:setIK(): the auth-param IK parameter is null"),"AuthenticationHeader:setIK(): the auth-param IK parameter is null";this.setParameter(this.IK,a)};AuthenticationHeader.prototype.getIK=function(){return this.getParameter(this.IK)};
AuthenticationHeader.prototype.setCK=function(a){if(null==a)throw console.error("AuthenticationHeader:setCK() the auth-param CK parameter is null"),"AuthenticationHeader:setCK(): the auth-param CK parameter is null";this.setParameter(this.CK,a)};AuthenticationHeader.prototype.getCK=function(){return this.getParameter(this.CK)};
AuthenticationHeader.prototype.setIntegrityProtected=function(a){if(null==a)throw console.error("AuthenticationHeader:setIntegrityProtected(): the integrity-protected parameter is null"),"AuthenticationHeader:setIntegrityProtected(): the integrity-protected parameter is null";this.setParameter(this.INTEGRITY_PROTECTED,a)};AuthenticationHeader.prototype.getIntegrityProtected=function(){return this.getParameter(this.INTEGRITY_PROTECTED)};
function WWWAuthenticate(){this.classname="WWWAuthenticate";this.headerName=this.NAME;this.parameters=new NameValueList;this.duplicates=new DuplicateNameValueList;this.parameters.setSeparator(this.COMMA);this.scheme=this.DIGEST}WWWAuthenticate.prototype=new AuthenticationHeader;WWWAuthenticate.prototype.constructor=WWWAuthenticate;WWWAuthenticate.prototype.NAME="WWW-Authenticate";WWWAuthenticate.prototype.COMMA=",";WWWAuthenticate.prototype.DIGEST="Digest";WWWAuthenticate.prototype.getURI=function(){return null};
WWWAuthenticate.prototype.setURI=function(a){};function Route(a){this.classname="Route";null==a?(this.headerName=this.NAME,this.parameters=new NameValueList,this.duplicates=new DuplicateNameValueList):(this.parameters=new NameValueList,this.duplicates=new DuplicateNameValueList,this.address=a)}Route.prototype=new AddressParametersHeader;Route.prototype.constructor=Route;Route.prototype.NAME="Route";Route.prototype.NAME_ADDR=1;Route.prototype.SEMICOLON=";";
Route.prototype.hashCode=function(){var a=0,b=this.address.getHostPort().encode().toLowerCase();if(null!=b&&""!=b.value)for(var c=0;c<b.length;c++)if(a=31*a+b.charCodeAt(c),2147483647<a||-2147483648>a)a&=4294967295;return a};Route.prototype.encodeBody=function(){return this.encodeBodyBuffer("").toString()};
Route.prototype.encodeBodyBuffer=function(a){this.address.getAddressType()!=this.NAME_ADDR?(a=this.address.encodeBuffer(a+"<"),a+=">"):a=this.address.encodeBuffer(a);0!=this.parameters.hmap.length&&(a+=this.SEMICOLON,a=this.parameters.encodeBuffer(a));return a};
function ProxyAuthenticate(){this.classname="ProxyAuthenticate";this.headerName=this.PROXY_AUTHENTICATE;this.parameters=new NameValueList;this.duplicates=new DuplicateNameValueList;this.parameters.setSeparator(this.COMMA);this.scheme=this.DIGEST}ProxyAuthenticate.prototype=new AuthenticationHeader;ProxyAuthenticate.prototype.constructor=ProxyAuthenticate;ProxyAuthenticate.prototype.PROXY_AUTHENTICATE="Proxy-Authenticate";ProxyAuthenticate.prototype.COMMA=",";ProxyAuthenticate.prototype.DIGEST="Digest";
ProxyAuthenticate.prototype.getURI=function(){return null};ProxyAuthenticate.prototype.setURI=function(a){};function ProxyAuthorization(){this.classname="ProxyAuthorization";this.scheme=null;this.headerName=this.PROXY_AUTHORIZATION;this.parameters=new NameValueList;this.duplicates=new DuplicateNameValueList;this.parameters.setSeparator(this.COMMA);this.scheme=this.DIGEST}ProxyAuthorization.prototype=new AuthenticationHeader;ProxyAuthorization.prototype.constructor=ProxyAuthorization;
ProxyAuthorization.prototype.PROXY_AUTHORIZATION="Proxy-Authorization";ProxyAuthorization.prototype.COMMA=",";ProxyAuthorization.prototype.DIGEST="Digest";function StatusLine(){this.classname="StatusLine";this.matchStatusClass=null;this.sipVersion=this.SIP_VERSION_STRING;this.reasonPhrase=this.statusCode=null}StatusLine.prototype=new SIPObject;StatusLine.prototype.constructor=StatusLine;StatusLine.prototype.SIP_VERSION_STRING="SIP/2.0";StatusLine.prototype.SP=" ";StatusLine.prototype.NEWLINE="\r\n";
StatusLine.prototype.match=function(){};StatusLine.prototype.setMatchStatusClass=function(a){this.matchStatusClass=a};StatusLine.prototype.encode=function(){var a=this.SIP_VERSION_STRING+this.SP+this.statusCode;null!=this.reasonPhrase&&(a=a+this.SP+this.reasonPhrase);return a+=this.NEWLINE};StatusLine.prototype.getSipVersion=function(){return this.sipVersion};StatusLine.prototype.getStatusCode=function(){return this.statusCode};StatusLine.prototype.getReasonPhrase=function(){return this.reasonPhrase};
StatusLine.prototype.setSipVersion=function(a){this.sipVersion=a};StatusLine.prototype.setStatusCode=function(a){this.statusCode=a};StatusLine.prototype.setReasonPhrase=function(a){this.reasonPhrase=a};StatusLine.prototype.getVersionMajor=function(){if(null==this.sipVersion)return null;for(var a=null,b=!1,c=0;c<this.sipVersion.length;c++)"."==this.sipVersion.charAt(c)&&(b=!1),b&&(a=null==a?""+this.sipVersion.charAt(c):a+this.sipVersion.charAt(c)),"/"==this.sipVersion.charAt(c)&&(b=!0);return a};
StatusLine.prototype.getVersionMinor=function(){if(null==this.sipVersion)return null;for(var a=null,b=!1,c=0;c<this.sipVersion.length;c++)b&&(a=null==a?""+this.sipVersion.charAt(c):a+this.sipVersion.charAt(c)),"."==this.sipVersion.charAt(c)&&(b=!0);return a};function Authorization(){this.classname="Authorization";this.headerName=this.NAME;this.parameters=new NameValueList;this.duplicates=new DuplicateNameValueList;this.parameters.setSeparator(this.COMMA);this.scheme=this.DIGEST}
Authorization.prototype=new AuthenticationHeader;Authorization.prototype.constructor=Authorization;Authorization.prototype.NAME="Authorization";Authorization.prototype.COMMA=",";Authorization.prototype.DIGEST="Digest";function Allow(a){this.classname="Allow";this.method=null;null==a?this.headerName=this.ALLOW:1==arguments.length&&(this.headerName=this.ALLOW,this.method=a)}Allow.prototype=new SIPHeader;Allow.prototype.constructor=Allow;Allow.prototype.ALLOW="Allow";Allow.prototype.getMethod=function(){return this.method};
Allow.prototype.setMethod=function(a){if(null==a)throw console.error("Allow:setMethod(): JAIN-SIP Exception, the method parameter is null."),"Allow:setMethod(): the method parameter is null.";this.method=a};Allow.prototype.encodeBody=function(){return this.method};
function RecordRoute(a){this.classname="RecordRoute";null==a?(this.headerName=this.RECORD_ROUTE,this.address=new AddressImpl):(this.headerName=this.NAME,this.address=a);this.parameters=new NameValueList;this.duplicates=new DuplicateNameValueList}RecordRoute.prototype=new AddressParametersHeader;RecordRoute.prototype.constructor=RecordRoute;RecordRoute.prototype.NAME="Record-Route";RecordRoute.prototype.RECORD_ROUTE="Record-Route";RecordRoute.prototype.ADDRESS_SPEC=2;
RecordRoute.prototype.LESS_THAN="<";RecordRoute.prototype.GREATER_THAN=">";RecordRoute.prototype.SEMICOLON=";";RecordRoute.prototype.encodeBody=function(){return this.encodeBodyBuffer("").toString()};
RecordRoute.prototype.encodeBodyBuffer=function(a){this.address.getAddressType()==this.ADDRESS_SPEC&&(a+=this.LESS_THAN);a=this.address.encodeBuffer(a);this.address.getAddressType()==this.ADDRESS_SPEC&&(a+=this.GREATER_THAN);0!=this.parameters.hmap.length&&(a+=this.SEMICOLON,a=this.parameters.encodeBuffer(a));return a};
function MaxForwards(a){this.classname="MaxForwards";this.headerName=this.NAME;this.maxForwards=null;null==a?this.headerName=this.NAME:(this.headerName=this.NAME,this.setMaxForwards(a))}MaxForwards.prototype=new SIPHeader;MaxForwards.prototype.constructor=MaxForwards;MaxForwards.prototype.NAME="Max-Forwards";MaxForwards.prototype.getMaxForwards=function(){return this.maxForwards};
MaxForwards.prototype.setMaxForwards=function(a){if(0>a||255<a)throw console.error("MaxForwards:setMaxForwards(): bad max forwards value "+a),"MaxForwards:setMaxForwards(): bad max forwards value "+a;this.maxForwards=a};MaxForwards.prototype.encodeBody=function(){return this.encodeBodyBuffer("").toString()};MaxForwards.prototype.encodeBodyBuffer=function(a){return a+=this.maxForwards};MaxForwards.prototype.hasReachedZero=function(){return 0==this.maxForwards?!0:!1};
MaxForwards.prototype.decrementMaxForwards=function(){if(0<this.maxForwards)this.maxForwards--;else throw console.error("MaxForwards:decrementMaxForwards(): has already reached 0!"),"MaxForwards:decrementMaxForwards(): has already reached 0!";};function ContentType(a,b){this.classname="ContentType";this.mediaRange=new MediaRange;this.headerName=this.NAME;this.parameters=new NameValueList;this.duplicates=new DuplicateNameValueList;null!=a&&null!=b&&this.setContentType(a,b)}ContentType.prototype=new ParametersHeader;
ContentType.prototype.constructor=ContentType;ContentType.prototype.NAME="Content-Type";ContentType.prototype.SEMICOLON=";";ContentType.prototype.compareMediaRange=function(a){var b=(this.mediaRange.type+"/"+this.mediaRange.subtype).toLowerCase();a=a.toLowerCase();var c=0;var d=b.length>=a.length?b.length:a.length;for(var e=0;e<d;e++)null!=b.charAt(e)&&(b.charAt(e)>a.charAt(e)?c+=1:b.charAt(e)<a.charAt(e)&&--c);return c};ContentType.prototype.encodeBody=function(){return this.encodeBodyBuffer("").toString()};
ContentType.prototype.encodeBodyBuffer=function(a){a=this.mediaRange.encodeBuffer(a);this.hasParameters()&&(a+=this.SEMICOLON,a=this.parameters.encodeBuffer(a));return a};ContentType.prototype.getMediaRange=function(){return this.mediaRange};ContentType.prototype.getMediaType=function(){return this.mediaRange.type};ContentType.prototype.getMediaSubType=function(){return this.mediaRange.subtype};ContentType.prototype.getContentSubType=function(){return null==this.mediaRange?null:this.mediaRange.getSubtype()};
ContentType.prototype.getContentType=function(){return null==this.mediaRange?null:this.mediaRange.getType()};ContentType.prototype.getCharset=function(){return this.getParameter("charset")};ContentType.prototype.setMediaRange=function(a){this.mediaRange=a};
ContentType.prototype.setContentType=function(){if(1==arguments){var a=arguments[0];if(null==a)throw console.error("ContentType:setContentType(): null argument"),"ContentType:setContentType(): null argument";null==this.mediaRange&&(this.mediaRange=new MediaRange);this.mediaRange.setType(a)}else{a=arguments[0];var b=arguments[1];null==this.mediaRange&&(this.mediaRange=new MediaRange);this.mediaRange.setType(a);this.mediaRange.setSubtype(b)}};
ContentType.prototype.setContentSubType=function(a){if(null==a)throw console.error("ContentType:setContentSubType(): null contentType parameter"),"ContentType:setContentSubType(): null contentType parameter";null==this.mediaRange&&(this.mediaRange=new MediaRange);this.mediaRange.setSubtype(a)};function TimeStamp(){this.classname="TimeStamp";this.timeStampFloat=this.delayFloat=this.delay=this.timeStamp=-1;this.headerName=this.TIMESTAMP}TimeStamp.prototype=new SIPHeader;
TimeStamp.prototype.constructor=TimeStamp;TimeStamp.prototype.TIMESTAMP="Timestamp";TimeStamp.prototype.getTimeStampAsString=function(){return-1==this.timeStamp&&-1==this.timeStampFloat?"":-1!=this.timeStamp?this.timeStamp.toString():this.timeStampFloat.toString()};TimeStamp.prototype.getDelayAsString=function(){return-1==this.delay&&-1==this.delayFloat?"":-1!=this.delay?this.delay.toString():this.delayFloat.toString()};
TimeStamp.prototype.encodeBody=function(){var a="",b=this.getTimeStampAsString(),c=this.getDelayAsString();if(""==b&&""==c)return"";""!=b&&(a+=b);""!=c&&(a=a+" "+c);return a.toString()};TimeStamp.prototype.hasDelay=function(){return-1!=this.delay?!0:!1};TimeStamp.prototype.removeDelay=function(){this.delay=-1};
TimeStamp.prototype.setTimeStamp=function(a){if(0>a)throw console.error("TimeStamp:setTimeStamp(): the timeStamp parameter is <0"),"TimeStamp:setTimeStamp(): the timeStamp parameter is <0";this.timeStamp=-1;this.timeStampFloat=a};TimeStamp.prototype.getTimeStamp=function(){return-1==this.timeStampFloat?this.timeStamp:this.timeStampFloat};TimeStamp.prototype.getDelay=function(){return-1==this.delayFloat?this.delay:this.delayFloat};
TimeStamp.prototype.setDelay=function(a){if(0>a&&-1!=a)throw console.error("TimeStamp:setDelay(): the delay parameter is <0"),"TimeStamp:setDelay(): the delay parameter is <0";this.delayFloat=a;this.delay=-1};TimeStamp.prototype.getTime=function(){return-1==this.timeStamp?this.timeStampFloat:this.timeStamp};TimeStamp.prototype.getTimeDelay=function(){return-1==this.delay?this.delayFloat:this.delay};
TimeStamp.prototype.setTime=function(a){if(-1>this.timeStamp)throw console.error("TimeStamp:setTime(): illegal timestamp"),"TimeStamp:setTime(): illegal timestamp";this.timeStamp=a;this.timeStampFloat=-1};TimeStamp.prototype.setTimeDelay=function(a){if(-1>a)throw console.error("TimeStamp:setTimeDelay(): value out of range "+a),"TimeStamp:setTimeDelay(): value out of range "+a;this.delay=a;this.delayFloat=-1};
function ContentDisposition(a){this.classname="ContentDisposition";this.dispositionType=null;this.headerName=this.NAME;this.parameters=new NameValueList;this.duplicates=new DuplicateNameValueList}ContentDisposition.prototype=new ParametersHeader;ContentDisposition.prototype.constructor=ContentDisposition;ContentDisposition.prototype.NAME="Content-Disposition";ContentDisposition.prototype.SEMICOLON=";";
ContentDisposition.prototype.encodeBody=function(){var a=this.dispositionType;0!=this.parameters.hmap.length&&(a=a+this.SEMICOLON+this.parameters.encode());return a.toString()};ContentDisposition.prototype.setDispositionType=function(a){if(null==a)throw console.error("ContentDisposition:setDispositionType(): the dispositionType parameter is null"),"ContentDisposition:setDispositionType(): the dispositionType parameter is null";this.dispositionType=a};
ContentDisposition.prototype.getDispositionType=function(){return this.dispositionType};ContentDisposition.prototype.getHandling=function(){return this.getParameter("handling")};ContentDisposition.prototype.setHandling=function(a){if(null==a)throw console.error("ContentDisposition:setHandling(): the handling parameter is null"),"ContentDisposition:setHandling(): the handling parameter is null";this.setParameter("handling",a)};ContentDisposition.prototype.getContentDisposition=function(){return this.encodeBody()};
function CallIdentifier(){this.classname="CallIdentifier";this.host=this.localId=null;if(2==arguments.length){var a=arguments[1];this.localId=arguments[0];this.host=a}else 1==arguments.length&&this.setCallID(arguments[0])}CallIdentifier.prototype=new SIPObject;CallIdentifier.prototype.constructor=CallIdentifier;CallIdentifier.prototype.AT="@";CallIdentifier.prototype.encode=function(){return this.encodeBuffer("").toString()};
CallIdentifier.prototype.encodeBuffer=function(a){a+=this.localId;null!=this.host&&(a=a+this.AT+this.host);return a};CallIdentifier.prototype.hashCode=function(){if(null==this.localId)throw console.error("CallIdentifier:hashCode(): hash code called before id is set"),"CallIdentifier:hashCode(): hash code called before id is set";var a=0,b=this.localId.toLowerCase();if(null!=b&&""!=b.value)for(var c=0;c<b.length;c++)if(a=31*a+b.charCodeAt(c),2147483647<a||-2147483648>a)a&=4294967295;return a};
CallIdentifier.prototype.getLocalId=function(){return this.localId};CallIdentifier.prototype.getHost=function(){return this.host};CallIdentifier.prototype.setLocalId=function(a){this.localId=a};
CallIdentifier.prototype.setCallID=function(a){if(null==a)throw console.error("CallIdentifier:setCallID(): cid parameter is null"),"CallIdentifier:setCallID(): cid parameter is null";var b=a.indexOf("@");if(-1==b)this.localId=a,this.host=null;else if(this.localId=a.substring(0,b),this.host=a.substring(b+1,a.length),null==this.localId||null==this.host)throw console.error("CallIdentifier:setCallID(): CallID  must be token@token or token"),"CallIdentifier:setCallID(): CallID  must be token@token or token";
};CallIdentifier.prototype.setHost=function(a){this.host=a};function CallID(){this.classname="CallID";this.headerName=this.NAME;this.callIdentifier=new CallIdentifier;0!=arguments.length&&(this.callIdentifier=new CallIdentifier(arguments[0]))}CallID.prototype=new SIPHeader;CallID.prototype.constructor=CallID;CallID.prototype.NAME="Call-ID";CallID.prototype.encodeBody=function(){return this.encodeBodyBuffer("").toString()};
CallID.prototype.encodeBodyBuffer=function(a){null!=this.callIdentifier&&(a=this.callIdentifier.encodeBuffer(a));return a};CallID.prototype.getCallId=function(){return this.encodeBody()};CallID.prototype.getCallIdentifer=function(){return this.callIdentifier};CallID.prototype.setCallId=function(a){this.callIdentifier=new CallIdentifier(a)};CallID.prototype.setCallIdentifier=function(a){this.callIdentifier=a};
function CSeq(){this.classname="CSeq";this.seqno=this.method=null;if(0==arguments.length)this.headerName=this.CSEQ;else{var a=arguments[0],b=arguments[1];this.headerName=this.CSEQ;this.seqno=a;this.method=(new SIPRequest).getCannonicalName(b)}}CSeq.prototype=new SIPHeader;CSeq.prototype.constructor=CSeq;CSeq.prototype.CSEQ="CSeq";CSeq.prototype.COLON=":";CSeq.prototype.SP=" ";CSeq.prototype.NEWLINE="\r\n";
CSeq.prototype.encode=function(){return this.headerName+this.COLON+this.SP+this.encodeBody()+this.NEWLINE};CSeq.prototype.encodeBody=function(){return this.encodeBodyBuffer("").toString()};CSeq.prototype.encodeBodyBuffer=function(a){return a=a+this.seqno+this.SP+this.method.toUpperCase()};CSeq.prototype.getMethod=function(){return this.method};
CSeq.prototype.setSeqNumber=function(a){if(0>a)throw console.error("CSeq:setSeqNumber(): the sequence number parameter is < 0 : "+a),"CSeq:setSeqNumber(): the sequence number parameter is < 0 : "+a;if(2147483647<a)throw console.error("CSeq:setSeqNumber(): the sequence number parameter is too large : "+a),"CSeq:setSeqNumber(): the sequence number parameter is too large : "+a;this.seqno=a};CSeq.prototype.setSequenceNumber=function(a){this.setSeqNumber(a)};
CSeq.prototype.setMethod=function(a){if(null==a)throw console.error("CSeq:setMethod(): the method parameter is null"),"CSeq:setMethod(): the meth parameter is null";this.method=(new SIPRequest).getCannonicalName(a)};CSeq.prototype.getSequenceNumber=function(){return null==this.seqno?0:this.seqno};CSeq.prototype.getSeqNumber=function(){return this.seqno};
function Supported(a){this.classname="Supported";this.optionTag=null;null!=a?(this.headerName="Supported",this.optionTag=a):(this.headerName="Supported",this.optionTag=null)}Supported.prototype=new SIPHeader;Supported.prototype.constructor=Supported;Supported.prototype.COLON=":";Supported.prototype.NEWLINE="\r\n";Supported.prototype.encode=function(){var a=this.headerName+this.COLON;null!=this.optionTag&&(a=a+this.SP+this.optionTag);return a+=this.NEWLINE};
Supported.prototype.encodeBody=function(){return null!=this.optionTag?this.optionTag:""};Supported.prototype.setOptionTag=function(a){if(null==a)throw console.error("Supported:setOptionTag(): the optionTag parameter is null"),"Supported:setOptionTag(): the optionTag parameter is null";this.optionTag=a};Supported.prototype.getOptionTag=function(){return this.optionTag};function Expires(){this.classname="Expires";this.headerName=this.NAME;this.expires=null}Expires.prototype=new SIPHeader;
Expires.prototype.constructor=Expires;Expires.prototype.NAME="Expires";Expires.prototype.encodeBody=function(){return this.encodeBodyBuffer("").toString()};Expires.prototype.encodeBodyBuffer=function(a){return a+=this.expires};Expires.prototype.getExpires=function(){return this.expires};Expires.prototype.setExpires=function(a){if(0>a)throw console.error("Expires:setExpires(): bad argument "+a),"Expires:setExpires(): bad argument "+a;this.expires=a};
function ContactList(){this.classname="ContactList";this.headerName=this.NAME;this.myClass="Contact";this.hlist=[]}ContactList.prototype=new SIPHeaderList;ContactList.prototype.constructor=ContactList;ContactList.prototype.NAME="Contact";ContactList.prototype.clone=function(){};function ViaList(){this.classname="ViaList";this.headerName=this.NAME;this.myClass="Via";this.hlist=[]}ViaList.prototype=new SIPHeaderList;ViaList.prototype.constructor=ViaList;ViaList.prototype.NAME="Via";
ViaList.prototype.clone=function(){};function WWWAuthenticateList(){this.classname="WWWAuthenticateList";this.headerName=this.NAME;this.myClass="WWWAuthenticate";this.hlist=[]}WWWAuthenticateList.prototype=new SIPHeaderList;WWWAuthenticateList.prototype.constructor=WWWAuthenticateList;WWWAuthenticateList.prototype.NAME="WWW-Authenticate";WWWAuthenticateList.prototype.clone=function(){};function RouteList(){this.classname="RouteList";this.headerName=this.NAME;this.myClass="Route";this.hlist=[]}
RouteList.prototype=new SIPHeaderList;RouteList.prototype.constructor=RouteList;RouteList.prototype.NAME="Route";RouteList.prototype.clone=function(){};RouteList.prototype.encode=function(){return 0==this.hlist.length?"":this.encodeBuffer("")};RouteList.prototype.equals=function(){};function ProxyAuthenticateList(){this.classname="ProxyAuthenticateList";this.headerName=this.NAME;this.myClass="ProxyAuthenticate";this.hlist=[]}ProxyAuthenticateList.prototype=new SIPHeaderList;
ProxyAuthenticateList.prototype.constructor=ProxyAuthenticateList;ProxyAuthenticateList.prototype.NAME="Proxy-Authenticate";ProxyAuthenticateList.prototype.clone=function(){};function ProxyAuthorizationList(){this.classname="ProxyAuthorizationList";this.headerName=this.NAME;this.myClass="ProxyAuthorization"}ProxyAuthorizationList.prototype=new SIPHeaderList;ProxyAuthorizationList.prototype.constructor=ProxyAuthorizationList;ProxyAuthorizationList.prototype.NAME="Proxy-Authorization";
ProxyAuthorizationList.prototype.clone=function(){};function AuthorizationList(){this.classname="AuthorizationList";this.headerName=this.NAME;this.myClass="Authorization"}AuthorizationList.prototype=new SIPHeaderList;AuthorizationList.prototype.constructor=AuthorizationList;AuthorizationList.prototype.NAME="Authorization";AuthorizationList.prototype.clone=function(){};function AllowList(){this.classname="AllowList";this.headerName=this.NAME;this.myClass="Allow";this.hlist=[]}AllowList.prototype=new SIPHeaderList;
AllowList.prototype.constructor=AllowList;AllowList.prototype.NAME="Allow";AllowList.prototype.clone=function(){};AllowList.prototype.getMethods=function(){for(var a=[],b=0;b<this.hlist.length;b++)a[b]=this.hlist[b].getMethod();return a};AllowList.prototype.setMethods=function(a){for(var b=0;b<a.length;b++){var c=new Allow;c.setMethod(a[b]);this.add(c)}return[]};
function AllowEvents(a){this.serialVersionUID="5281728373401351378L";this.classname="AllowEvents";this.eventType=null;null==a?this.headerName=this.ALLOW_EVENTS:(this.headerName=this.ALLOW_EVENTS,this.eventType=a)}AllowEvents.prototype=new SIPHeader;AllowEvents.prototype.constructor=AllowEvents;AllowEvents.prototype.ALLOW_EVENTS="Allow-Events";
AllowEvents.prototype.setEventType=function(a){if(null==a)throw console.error("AllowEvents:setEventType(): the eventType parameter is null"),"AllowEvents:setEventType(): the eventType parameter is null";this.eventType=a};AllowEvents.prototype.getEventType=function(){return this.eventType};AllowEvents.prototype.encodeBody=function(){return this.eventType};
function EventHeader(a){this.classname="Event";this.headerName=this.NAME;this.parameters=new NameValueList;this.duplicates=new DuplicateNameValueList;this.eventType=null;null!=a&&(this.eventType=a)}EventHeader.prototype=new ParametersHeader;EventHeader.prototype.constructor=EventHeader;EventHeader.prototype.NAME="Event";
EventHeader.prototype.setEventType=function(a){if(null==a)throw console.error("Event:setEventType(): the eventType parameter is null"),"Event:setEventType(): the eventType parameter is null";this.eventType=a};EventHeader.prototype.getEventType=function(){return this.eventType};EventHeader.prototype.encodeBody=function(){return this.eventType};
function AllowEventsList(){this.serialVersionUID="-684763195336212992L";this.classname="AllowEventsList";this.headerName=this.NAME;this.myClass="AllowEvents"}AllowEventsList.prototype=new SIPHeaderList;AllowEventsList.prototype.constructor=AllowEventsList;AllowEventsList.prototype.NAME="Allow-Events";AllowEventsList.prototype.clone=function(){};AllowEventsList.prototype.getMethods=function(){for(var a=Object.getPrototypeOf(this).hlist,b=[],c=0;c<a.length;c++)b[c]=a[c].getEventType();return b};
AllowEventsList.prototype.setMethods=function(a){for(var b=0;b<a.length;b++){var c=new AllowEvents;c.setEventType(a[b]);this.add(c)}};function RecordRouteList(){this.classname="RecordRouteList";this.headerName=this.NAME;this.myClass="RecordRoute";this.hlist=[]}RecordRouteList.prototype=new SIPHeaderList;RecordRouteList.prototype.constructor=RecordRouteList;RecordRouteList.prototype.NAME="Record-Route";RecordRouteList.prototype.clone=function(){};
function SupportedList(){this.classname="SupportedList";this.headerName=this.NAME;this.myClass="Supported";this.hlist=[]}SupportedList.prototype=new SIPHeaderList;SupportedList.prototype.constructor=SupportedList;SupportedList.prototype.NAME="Supported";SupportedList.prototype.clone=function(){};function HeaderFactoryImpl(){this.classname="HeaderFactoryImpl";this.stripAddressScopeZones=!1}HeaderFactoryImpl.prototype=new SIPHeaderList;HeaderFactoryImpl.prototype.constructor=HeaderFactoryImpl;
HeaderFactoryImpl.prototype.NAME="Authorization";HeaderFactoryImpl.prototype.setPrettyEncoding=function(a){(new SIPHeaderList).setPrettyEncode(a)};HeaderFactoryImpl.prototype.createAllowEventsHeader=function(a){if(null==a)throw console.error("HeaderFactoryImpl:createAllowEventsHeader(): null arg eventType"),"HeaderFactoryImpl:createAllowEventsHeader(): null arg eventType";var b=new AllowEvents;b.setEventType(a);return b};
HeaderFactoryImpl.prototype.createAllowHeader=function(a){if(null==a)throw console.error("HeaderFactoryImpl:createAllowHeader(): null arg method"),"HeaderFactoryImpl:createAllowHeader(): null arg method";var b=new Allow;b.setMethod(a);return b};
HeaderFactoryImpl.prototype.createCSeqHeader=function(a,b){if(0>a)throw console.error("HeaderFactoryImpl:createCSeqHeader(): bad arg "+a),"HeaderFactoryImpl:createCSeqHeader(): bad arg "+a;if(null==b)throw console.error("HeaderFactoryImpl:createCSeqHeader(): null arg method"),"HeaderFactoryImpl:createCSeqHeader(): null arg method";var c=new CSeq;c.setMethod(b);c.setSeqNumber(a);return c};
HeaderFactoryImpl.prototype.createCallIdHeader=function(a){null==a&&(a=new String((new Date).getTime()));var b=new CallID;b.setCallId(a);return b};HeaderFactoryImpl.prototype.createContactHeader=function(){if(0==arguments.length){var a=new Contact;a.setWildCardFlag(!0);a.setExpires(0)}else{var b=arguments[0];if(null==b)throw console.error("HeaderFactoryImpl:createContactHeader(): null arg address"),"HeaderFactoryImpl:createContactHeader(): null arg address";a=new Contact;a.setAddress(b)}return a};
HeaderFactoryImpl.prototype.createContentDispositionHeader=function(a){if(0>a)throw console.error("HeaderFactoryImpl:createContentDispositionHeader(): null arg contentDisposition"),"HeaderFactoryImpl:createContentDispositionHeader(): null arg contentDisposition";var b=new ContentDisposition;b.setDispositionType(a);return b};
HeaderFactoryImpl.prototype.createContentLengthHeader=function(a){if(0>a)throw console.error("HeaderFactoryImpl:createContentLengthHeader(): bad contentLength"),"HeaderFactoryImpl:createContentLengthHeader(): bad contentLength";var b=new ContentLength;b.setContentLength(a);return b};
HeaderFactoryImpl.prototype.createContentTypeHeader=function(a,b){if(null==a||null==b)throw console.error("HeaderFactoryImpl:createContentTypeHeader(): null contentType or subType"),"HeaderFactoryImpl:createContentTypeHeader(): null contentType or subType";var c=new ContentType;c.setContentType(a);c.setContentSubType(b);return c};
HeaderFactoryImpl.prototype.createEventHeader=function(a){if(null==a)throw console.error("HeaderFactoryImpl:createEventHeader(): null eventType"),"HeaderFactoryImpl:createEventHeader(): null eventType";return new EventHeader(a)};HeaderFactoryImpl.prototype.createExpiresHeader=function(a){if(0>a)throw console.error("HeaderFactoryImpl:createExpiresHeader(): bad value "+a),"HeaderFactoryImpl:createExpiresHeader(): bad value "+a;var b=new Expires;b.setExpires(a);return b};
HeaderFactoryImpl.prototype.createExtensionHeader=function(a,b){if(null==a)throw console.error("HeaderFactoryImpl:createExtensionHeader(): bad name"),"HeaderFactoryImpl:createExtensionHeader(): bad name";var c=new ExtensionHeaderImpl;c.setName(a);c.setValue(b);return c};
HeaderFactoryImpl.prototype.createFromHeader=function(a,b){if(null==a)throw console.error("HeaderFactoryImpl:createFromHeader(): null address arg"),"HeaderFactoryImpl:createFromHeader(): null address arg";var c=new From;c.setAddress(a);null!=b&&c.setTag(b);return c};
HeaderFactoryImpl.prototype.createMaxForwardsHeader=function(a){if(0>a||255<a)throw console.error("HeaderFactoryImpl:createMaxForwardsHeader(): bad maxForwards arg "+a),"HeaderFactoryImpl:createMaxForwardsHeader(): bad maxForwards arg "+a;var b=new MaxForwards;b.setMaxForwards(a);return b};
HeaderFactoryImpl.prototype.createProxyAuthenticateHeader=function(a){if(null==a)throw console.error("HeaderFactoryImpl:createProxyAuthenticateHeader(): null scheme arg"),"HeaderFactoryImpl:createProxyAuthenticateHeader(): null scheme arg";var b=new ProxyAuthenticate;b.setScheme(a);return b};
HeaderFactoryImpl.prototype.createProxyAuthorizationHeader=function(a){if(null==a)throw console.error("HeaderFactoryImpl:createProxyAuthorizationHeader(): null scheme arg"),"HeaderFactoryImpl:createProxyAuthorizationHeader():null scheme arg";var b=new ProxyAuthorization;b.setScheme(a);return b};
HeaderFactoryImpl.prototype.createReasonHeader=function(a,b,c){if(null==a)throw console.error("HeaderFactoryImpl:createReasonHeader(): null protocol arg"),"HeaderFactoryImpl:createReasonHeader(): null protocol arg";if(0>b)throw console.error("HeaderFactoryImpl:createReasonHeader(): bad cause"),"HeaderFactoryImpl:createReasonHeader():bad cause";var d=new Reason;d.setProtocol(a);d.setCause(b);d.setText(c);return d};
HeaderFactoryImpl.prototype.createRecordRouteHeader=function(a){if(null==a)throw console.error("HeaderFactoryImpl:createRecordRouteHeader(): null address arg"),"HeaderFactoryImpl:createRecordRouteHeader(): null address arg";var b=new RecordRoute;b.setAddress(a);return b};
HeaderFactoryImpl.prototype.createRouteHeader=function(a){if(null==a)throw console.error("HeaderFactoryImpl:createRouteHeader(): null address arg"),"HeaderFactoryImpl:createRouteHeader(): null address arg";var b=new Route;b.setAddress(a);return b};HeaderFactoryImpl.prototype.createSubjectHeader=function(a){if(null==a)throw console.error("HeaderFactoryImpl:createSubjectHeader(): null subject arg"),"HeaderFactoryImpl:createSubjectHeader():  null subject arg";var b=new Subject;b.setSubject(a);return b};
HeaderFactoryImpl.prototype.createSupportedHeader=function(a){if(null==a)throw console.error("HeaderFactoryImpl:createSupportedHeader(): null optionTag arg"),"HeaderFactoryImpl:createSupportedHeader(): null optionTag arg";var b=new Supported;b.setOptionTag(a);return b};
HeaderFactoryImpl.prototype.createTimeStampHeader=function(a){if(0>a)throw console.error("HeaderFactoryImpl:createTimeStampHeader(): illegal timeStamp"),"HeaderFactoryImpl:createTimeStampHeader(): illegal timeStamp";var b=new TimeStamp;b.setTimeStamp(a);return b};
HeaderFactoryImpl.prototype.createToHeader=function(a,b){if(null==a)throw console.error("HeaderFactoryImpl:createToHeader(): null address arg"),"HeaderFactoryImpl:createToHeader(): null address arg";var c=new To;c.setAddress(a);null!=b&&c.setTag(b);return c};
HeaderFactoryImpl.prototype.createReferToHeader=function(a,b){if(null==a)throw console.error("HeaderFactoryImpl:createReferToHeader(): null address arg"),"HeaderFactoryImpl:createReferToHeader(): null address arg";var c=new ReferTo;c.setAddress(a);c.setReplaces(b);return c};
HeaderFactoryImpl.prototype.createReferredByHeader=function(a){if(null==a)throw console.error("HeaderFactoryImpl:createReferredByHeader(): null address arg"),"HeaderFactoryImpl:createReferredByHeader(): null address arg";var b=new ReferredBy;b.setAddress(a);return b};
HeaderFactoryImpl.prototype.createUserAgentHeader=function(a){if(null==a)throw console.error("HeaderFactoryImpl:createUserAgentHeader(): null product arg"),"HeaderFactoryImpl:createUserAgentHeader(): null product arg";var b=new UserAgent;b.setProduct(a);return b};
HeaderFactoryImpl.prototype.createViaHeader=function(a,b,c,d){if(null==a||null==c)throw console.error("HeaderFactoryImpl:createViaHeader(): null host or  transport arg"),"HeaderFactoryImpl:createViaHeader(): null host or  transport arg";var e=new Via;null!=d&&e.setBranch(d);0<=a.indexOf(":")&&0>a.indexOf("[")&&(this.stripAddressScopeZones&&(d=a.indexOf("%"),-1!=d&&(a=a.substring(0,d))),a="["+a+"]");e.setHost(a);null!=b&&e.setPort(b);null!=c?e.setTransport(c):e.setTransport("WSS");return e};
HeaderFactoryImpl.prototype.createWWWAuthenticateHeader=function(a){if(null==a)throw console.error("HeaderFactoryImpl:createWWWAuthenticateHeader(): null scheme arg"),"HeaderFactoryImpl:createWWWAuthenticateHeader(): null scheme arg";var b=new WWWAuthenticate;b.setScheme(a);return b};
HeaderFactoryImpl.prototype.createHeader=function(){if(1==arguments.length){var a=arguments[0],b=(new StringMsgParser).parseSIPHeader(a.trim());if(b instanceof SIPHeaderList){if(1<b.size())throw console.error("HeaderFactoryImpl:createHeader(): only singleton allowed "+a),"HeaderFactoryImpl:createHeader():only singleton allowed "+a;return 0==b.size()?Object.assign({},b):b.getFirst()}return b}if(2==arguments.length){a=arguments[0];b=arguments[1];if(null==a)throw console.error("header name is null"),
console.error("HeaderFactoryImpl:createHeader(): header name is null"),"HeaderFactoryImpl:createHeader(): header name is null";return this.createHeader(a+":"+b)}};
HeaderFactoryImpl.prototype.createHeaders=function(a){if(null==a)throw console.error("HeaderFactoryImpl:createHeaders(): null headers arg"),"HeaderFactoryImpl:createHeaders(): null headers arg";a=(new StringMsgParser).parseSIPHeader(a);if(a instanceof SIPHeaderList)return a;console.error("HeaderFactoryImpl:createHeaders():List of headers of this type is not allowed in a message",0);throw"HeaderFactoryImpl:createHeaders(): list of headers of this type is not allowed in a message";};
HeaderFactoryImpl.prototype.createRouteList=function(a){if(null!=a){for(var b=new RouteList,c=a.getHeaderList().length-1;0<=c;c--){var d=a.getHeaderList()[c],e=new Route,f=d.getAddress();e.setAddress(f);e.setParameters(d.getParameters());b.add(e)}return b}return new RouteList};HeaderFactoryImpl.prototype.createRequestLine=function(a){return(new RequestLineParser(a)).parse()};HeaderFactoryImpl.prototype.createStatusLine=function(a){return(new StatusLineParser(a)).parse()};
HeaderFactoryImpl.prototype.createAuthorizationHeader=function(){return 1==arguments.length?this.createAuthorizationHeaderargu1(arguments[0]):this.createAuthorizationHeaderargu2(arguments[0],arguments[1],arguments[2],arguments[3])};
HeaderFactoryImpl.prototype.createAuthorizationHeaderargu1=function(a){if(null==a)throw console.error("HeaderFactoryImpl:createAuthorizationHeaderargu1(): null scheme arg"),"HeaderFactoryImpl:createAuthorizationHeaderargu1(): null scheme arg";var b=new Authorization;b.setScheme(a);return b};
HeaderFactoryImpl.prototype.createAuthorizationHeaderargu2=function(a,b,c,d){if(a.hasHeader("www-authenticate"))var e=a.getWWWAuthenticate().getRealm(),f=a.getWWWAuthenticate().getScheme(),g=a.getWWWAuthenticate().getNonce(),h=a.getWWWAuthenticate().getQop(),k=new Authorization;else if(a.hasHeader("proxy-authenticate")){e=a.getProxyAuthenticate().getRealm();f=a.getProxyAuthenticate().getScheme();g=a.getProxyAuthenticate().getNonce();h=a.getProxyAuthenticate().getQop();var l=new ProxyAuthorization}var m=
new MessageDigestAlgorithm,n=a.getCSeq().getMethod(),x=null,y=null;null!=h&&(x=Math.floor(16777215*Math.random()).toString(16),y="00000001");b=b.getRequestURI();c=m.calculateResponse(d,e,c,g,y,x,n,b.toString(),null,h);if(a.hasHeader("www-authenticate"))return k.setUsername(d),k.setRealm(e),k.setNonce(g),null!=x&&k.setCNonce(x),null!=y&&k.setNonceCount(y),k.setScheme(f),k.setResponse(c),k.setURI(b),k.setAlgorithm("MD5"),null!=h&&k.setQop(h),k;if(a.hasHeader("proxy-authenticate"))return l.setUsername(d),
l.setRealm(e),l.setNonce(g),null!=x&&l.setCNonce(x),null!=y&&l.setNonceCount(y),l.setScheme(f),l.setResponse(c),l.setURI(b),l.setAlgorithm("MD5"),null!=h&&l.setQop(h),l};function Parser(){this.classname="Parser"}Parser.prototype=new ParserCore;Parser.prototype.constructor=Parser;Parser.prototype.INVITE=LexerCore.prototype.START+5;Parser.prototype.ACK=LexerCore.prototype.START+6;Parser.prototype.OPTIONS=LexerCore.prototype.START+8;Parser.prototype.BYE=LexerCore.prototype.START+7;
Parser.prototype.REGISTER=LexerCore.prototype.START+4;Parser.prototype.CANCEL=LexerCore.prototype.START+9;Parser.prototype.SUBSCRIBE=LexerCore.prototype.START+53;Parser.prototype.NOTIFY=LexerCore.prototype.START+54;Parser.prototype.PUBLISH=LexerCore.prototype.START+67;Parser.prototype.MESSAGE=LexerCore.prototype.START+70;Parser.prototype.ID=LexerCore.prototype.ID;Parser.prototype.SIP=LexerCore.prototype.START+3;Parser.prototype.createParseException=function(){};Parser.prototype.getLexer=function(){return this.lexer};
Parser.prototype.sipVersion=function(){var a=this.lexer.match(this.SIP);"SIP"!=a.getTokenValue().toUpperCase()&&this.createParseException("Expecting SIP");this.lexer.match("/");a=this.lexer.match(this.ID);"2.0"!=a.getTokenValue()&&this.createParseException("Expecting SIP/2.0");return"SIP/2.0"};
Parser.prototype.method=function(){var a=this.lexer.peekNextToken(1)[0];if(a.getTokenType()==this.INVITE||a.getTokenType()==this.ACK||a.getTokenType()==this.OPTIONS||a.getTokenType()==this.BYE||a.getTokenType()==this.REGISTER||a.getTokenType()==this.CANCEL||a.getTokenType()==this.SUBSCRIBE||a.getTokenType()==this.NOTIFY||a.getTokenType()==this.PUBLISH||a.getTokenType()==this.MESSAGE||a.getTokenType()==this.ID)return this.lexer.consume(),a.getTokenValue();console.error("Parser:method(): invalid Method");
throw"Parser:method(): invalid Method";};Parser.prototype.checkToken=function(a){if(null==a||0==a.length)throw console.error("Parser:checkToken(): null or empty token"),"Parser:method(): null or empty token";for(var b=0;b<a.length;++b)if(!(new LexerCore).isTokenChar(a.charAt(b)))throw console.error("Parser:checkToken(): invalid character(s) in string (not allowed in 'token')",b),"Parser:method(): invalid character(s) in string (not allowed in 'token')";};
function Lexer(a,b){this.classname="Lexer";this.buffer=b;this.bufferLen=b.length;this.ptr=0;this.currentLexer=[];this.currentLexerName=a;this.selectLexer(a)}Lexer.prototype=new LexerCore;Lexer.prototype.constructor=Lexer;Lexer.prototype.ErrorInfoHeader="Error-Info";Lexer.prototype.AllowEventsHeader="Allow-Events";Lexer.prototype.AuthenticationInfoHeader="Authentication-Info";Lexer.prototype.EventHeader="Event";Lexer.prototype.MinExpiresHeader="Min-Expires";Lexer.prototype.RSeqHeader="RSeq";
Lexer.prototype.RAckHeader="RAck";Lexer.prototype.ReasonHeader="Reason";Lexer.prototype.ReplyToHeader="Reply-To";Lexer.prototype.SubscriptionStateHeader="Subscription-State";Lexer.prototype.TimeStampHeader="Timestamp";Lexer.prototype.InReplyToHeader="In-Reply-To";Lexer.prototype.MimeVersionHeader="MIME-Version";Lexer.prototype.AlertInfoHeader="Alert-Info";Lexer.prototype.FromHeader="From";Lexer.prototype.ToHeader="To";Lexer.prototype.ReferToHeader="Refer-To";Lexer.prototype.ViaHeader="Via";
Lexer.prototype.UserAgentHeader="User-Agent";Lexer.prototype.ServerHeader="Server";Lexer.prototype.AcceptEncodingHeader="Accept-Encoding";Lexer.prototype.AcceptHeader="Accept";Lexer.prototype.AllowHeader="Allow";Lexer.prototype.RouteHeader="Route";Lexer.prototype.AuthorizationHeader="Authorization";Lexer.prototype.ProxyAuthorizationHeader="Proxy-Authorization";Lexer.prototype.RetryAfterHeader="Retry-After";Lexer.prototype.ProxyRequireHeader="Proxy-Require";Lexer.prototype.ContentLanguageHeader="Content-Language";
Lexer.prototype.UnsupportedHeader="Unsupported";Lexer.prototype.SupportedHeader="Supported";Lexer.prototype.WarningHeader="Warning";Lexer.prototype.MaxForwardsHeader="Max-Forwards";Lexer.prototype.DateHeader="Date";Lexer.prototype.PriorityHeader="Priority";Lexer.prototype.ProxyAuthenticateHeader="Proxy-Authenticate";Lexer.prototype.ContentEncodingHeader="Content-Encoding";Lexer.prototype.ContentLengthHeader="Content-Length";Lexer.prototype.SubjectHeader="Subject";
Lexer.prototype.ContentTypeHeader="Content-Type";Lexer.prototype.ContactHeader="Contact";Lexer.prototype.CallIdHeader="Call-ID";Lexer.prototype.RequireHeader="Require";Lexer.prototype.ExpiresHeader="Expires";Lexer.prototype.RecordRouteHeader="Record-Route";Lexer.prototype.OrganizationHeader="Organization";Lexer.prototype.CSeqHeader="CSeq";Lexer.prototype.AcceptLanguageHeader="Accept-Language";Lexer.prototype.WWWAuthenticateHeader="WWW-Authenticate";Lexer.prototype.CallInfoHeader="Call-Info";
Lexer.prototype.ContentDispositionHeader="Content-Disposition";Lexer.prototype.SIPETagHeader="SIP-ETag";Lexer.prototype.SIPIfMatchHeader="SIP-If-Match";Lexer.prototype.SessionExpiresHeader="Session-Expires";Lexer.prototype.MinSEHeader="Min-SE";Lexer.prototype.ReferredByHeader="Referred-By";Lexer.prototype.ReplacesHeader="Replaces";Lexer.prototype.JoinHeader="Join";Lexer.prototype.PathHeader="Path";Lexer.prototype.ServiceRouteHeader="Service-Route";Lexer.prototype.PAssertedIdentityHeader="P-Asserted-Identity";
Lexer.prototype.PPreferredIdentityHeader="P-Preferred-Identity";Lexer.prototype.PrivacyHeader="Privacy";Lexer.prototype.PCalledPartyIDHeader="P-Called-Party-ID";Lexer.prototype.PAssociatedURIHeader="P-Associated-URI";Lexer.prototype.PVisitedNetworkIDHeader="P-Visited-Network-ID";Lexer.prototype.PChargingFunctionAddressesHeader="P-Charging-Function-Addresses";Lexer.prototype.PChargingVectorHeader="P-Charging-Vector";Lexer.prototype.PAccessNetworkInfoHeader="P-Access-Network-Info";
Lexer.prototype.PMediaAuthorizationHeader="P-Media-Authorization";Lexer.prototype.SecurityServerHeader="Security-Server";Lexer.prototype.SecurityVerifyHeader="Security-Verify";Lexer.prototype.SecurityClientHeader="Security-Client";Lexer.prototype.PUserDatabaseHeader="P-User-Database";Lexer.prototype.PProfileKeyHeader="P-Profile-Key";Lexer.prototype.PServedUserHeader="P-Served-User";Lexer.prototype.PPreferredServiceHeader="P-Preferred-Service";Lexer.prototype.PAssertedServiceHeader="P-Asserted-Service";
Lexer.prototype.ReferencesHeader="References";Lexer.prototype.AcceptContact="Accept-Contact";Lexer.prototype.getHeaderName=function(a){if(null==a)return null;var b=null;try{var c=a.indexOf(":");b=null;1<=c&&(b=a.substring(0,c).trim())}catch(d){return console.error("Lexer:getHeaderName(): catched exception:"+d),null}return b};
Lexer.prototype.getHeaderValue=function(a){if(null==a)return null;var b=null;try{var c=a.indexOf(":");b=a.substring(c+1)}catch(d){return console.error("Lexer:getHeaderValue(): catched exception:"+d),null}return b};
Lexer.prototype.selectLexer=function(a){for(var b=null,c=0;c<this.lexerTables.length;c++)this.lexerTables[c][0]==a&&(b=c);null!=b&&(this.currentLexer=this.lexerTables[b][1]);this.currentLexerName=a;0==this.currentLexer.length&&(this.addLexer(a),"method_keywordLexer"==a?(this.addKeyword(TokenNames.prototype.REGISTER,TokenTypes.prototype.REGISTER),this.addKeyword(TokenNames.prototype.ACK,TokenTypes.prototype.ACK),this.addKeyword(TokenNames.prototype.OPTIONS,TokenTypes.prototype.OPTIONS),this.addKeyword(TokenNames.prototype.BYE,
TokenTypes.prototype.BYE),this.addKeyword(TokenNames.prototype.INVITE,TokenTypes.prototype.INVITE),this.addKeyword(TokenNames.prototype.SIP.toUpperCase(),TokenTypes.prototype.SIP),this.addKeyword(TokenNames.prototype.SIPS.toUpperCase(),TokenTypes.prototype.SIPS),this.addKeyword(TokenNames.prototype.SUBSCRIBE,TokenTypes.prototype.SUBSCRIBE),this.addKeyword(TokenNames.prototype.NOTIFY,TokenTypes.prototype.NOTIFY),this.addKeyword(TokenNames.prototype.MESSAGE,TokenTypes.prototype.MESSAGE),this.addKeyword(TokenNames.prototype.PUBLISH,
TokenTypes.prototype.PUBLISH)):"command_keywordLexer"==a?(this.addKeyword(this.ErrorInfoHeader.toUpperCase(),TokenTypes.prototype.ERROR_INFO),this.addKeyword(this.AllowEventsHeader.toUpperCase(),TokenTypes.prototype.ALLOW_EVENTS),this.addKeyword(this.AuthenticationInfoHeader.toUpperCase(),TokenTypes.prototype.AUTHENTICATION_INFO),this.addKeyword(this.EventHeader.toUpperCase(),TokenTypes.prototype.EVENT),this.addKeyword(this.MinExpiresHeader.toUpperCase(),TokenTypes.prototype.MIN_EXPIRES),this.addKeyword(this.RSeqHeader.toUpperCase(),
TokenTypes.prototype.RSEQ),this.addKeyword(this.RAckHeader.toUpperCase(),TokenTypes.prototype.RACK),this.addKeyword(this.ReasonHeader.toUpperCase(),TokenTypes.prototype.REASON),this.addKeyword(this.ReplyToHeader.toUpperCase(),TokenTypes.prototype.REPLY_TO),this.addKeyword(this.SubscriptionStateHeader.toUpperCase(),TokenTypes.prototype.SUBSCRIPTION_STATE),this.addKeyword(this.TimeStampHeader.toUpperCase(),TokenTypes.prototype.TIMESTAMP),this.addKeyword(this.InReplyToHeader.toUpperCase(),TokenTypes.prototype.IN_REPLY_TO),
this.addKeyword(this.MimeVersionHeader.toUpperCase(),TokenTypes.prototype.MIME_VERSION),this.addKeyword(this.AlertInfoHeader.toUpperCase(),TokenTypes.prototype.ALERT_INFO),this.addKeyword(this.FromHeader.toUpperCase(),TokenTypes.prototype.FROM),this.addKeyword(this.ToHeader.toUpperCase(),TokenTypes.prototype.TO),this.addKeyword(this.ReferToHeader.toUpperCase(),TokenTypes.prototype.REFER_TO),this.addKeyword(this.ViaHeader.toUpperCase(),TokenTypes.prototype.VIA),this.addKeyword(this.UserAgentHeader.toUpperCase(),
TokenTypes.prototype.USER_AGENT),this.addKeyword(this.ServerHeader.toUpperCase(),TokenTypes.prototype.SERVER),this.addKeyword(this.AcceptEncodingHeader.toUpperCase(),TokenTypes.prototype.ACCEPT_ENCODING),this.addKeyword(this.AcceptHeader.toUpperCase(),TokenTypes.prototype.ACCEPT),this.addKeyword(this.AllowHeader.toUpperCase(),TokenTypes.prototype.ALLOW),this.addKeyword(this.RouteHeader.toUpperCase(),TokenTypes.prototype.ROUTE),this.addKeyword(this.AuthorizationHeader.toUpperCase(),TokenTypes.prototype.AUTHORIZATION),
this.addKeyword(this.ProxyAuthorizationHeader.toUpperCase(),TokenTypes.prototype.PROXY_AUTHORIZATION),this.addKeyword(this.RetryAfterHeader.toUpperCase(),TokenTypes.prototype.RETRY_AFTER),this.addKeyword(this.ProxyRequireHeader.toUpperCase(),TokenTypes.prototype.PROXY_REQUIRE),this.addKeyword(this.ContentLanguageHeader.toUpperCase(),TokenTypes.prototype.CONTENT_LANGUAGE),this.addKeyword(this.UnsupportedHeader.toUpperCase(),TokenTypes.prototype.UNSUPPORTED),this.addKeyword(this.SupportedHeader.toUpperCase(),
TokenTypes.prototype.SUPPORTED),this.addKeyword(this.WarningHeader.toUpperCase(),TokenTypes.prototype.WARNING),this.addKeyword(this.MaxForwardsHeader.toUpperCase(),TokenTypes.prototype.MAX_FORWARDS),this.addKeyword(this.DateHeader.toUpperCase(),TokenTypes.prototype.DATE),this.addKeyword(this.PriorityHeader.toUpperCase(),TokenTypes.prototype.PRIORITY),this.addKeyword(this.ProxyAuthenticateHeader.toUpperCase(),TokenTypes.prototype.PROXY_AUTHENTICATE),this.addKeyword(this.ContentEncodingHeader.toUpperCase(),
TokenTypes.prototype.CONTENT_ENCODING),this.addKeyword(this.ContentLengthHeader.toUpperCase(),TokenTypes.prototype.CONTENT_LENGTH),this.addKeyword(this.SubjectHeader.toUpperCase(),TokenTypes.prototype.SUBJECT),this.addKeyword(this.ContentTypeHeader.toUpperCase(),TokenTypes.prototype.CONTENT_TYPE),this.addKeyword(this.ContactHeader.toUpperCase(),TokenTypes.prototype.CONTACT),this.addKeyword(this.CallIdHeader.toUpperCase(),TokenTypes.prototype.CALL_ID),this.addKeyword(this.RequireHeader.toUpperCase(),
TokenTypes.prototype.REQUIRE),this.addKeyword(this.ExpiresHeader.toUpperCase(),TokenTypes.prototype.EXPIRES),this.addKeyword(this.RecordRouteHeader.toUpperCase(),TokenTypes.prototype.RECORD_ROUTE),this.addKeyword(this.OrganizationHeader.toUpperCase(),TokenTypes.prototype.ORGANIZATION),this.addKeyword(this.CSeqHeader.toUpperCase(),TokenTypes.prototype.CSEQ),this.addKeyword(this.AcceptLanguageHeader.toUpperCase(),TokenTypes.prototype.ACCEPT_LANGUAGE),this.addKeyword(this.WWWAuthenticateHeader.toUpperCase(),
TokenTypes.prototype.WWW_AUTHENTICATE),this.addKeyword(this.CallInfoHeader.toUpperCase(),TokenTypes.prototype.CALL_INFO),this.addKeyword(this.ContentDispositionHeader.toUpperCase(),TokenTypes.prototype.CONTENT_DISPOSITION),this.addKeyword(TokenNames.prototype.K.toUpperCase(),TokenTypes.prototype.SUPPORTED),this.addKeyword(TokenNames.prototype.C.toUpperCase(),TokenTypes.prototype.CONTENT_TYPE),this.addKeyword(TokenNames.prototype.E.toUpperCase(),TokenTypes.prototype.CONTENT_ENCODING),this.addKeyword(TokenNames.prototype.F.toUpperCase(),
TokenTypes.prototype.FROM),this.addKeyword(TokenNames.prototype.I.toUpperCase(),TokenTypes.prototype.CALL_ID),this.addKeyword(TokenNames.prototype.M.toUpperCase(),TokenTypes.prototype.CONTACT),this.addKeyword(TokenNames.prototype.L.toUpperCase(),TokenTypes.prototype.CONTENT_LENGTH),this.addKeyword(TokenNames.prototype.S.toUpperCase(),TokenTypes.prototype.SUBJECT),this.addKeyword(TokenNames.prototype.T.toUpperCase(),TokenTypes.prototype.TO),this.addKeyword(TokenNames.prototype.U.toUpperCase(),TokenTypes.prototype.ALLOW_EVENTS),
this.addKeyword(TokenNames.prototype.V.toUpperCase(),TokenTypes.prototype.VIA),this.addKeyword(TokenNames.prototype.R.toUpperCase(),TokenTypes.prototype.REFER_TO),this.addKeyword(TokenNames.prototype.O.toUpperCase(),TokenTypes.prototype.EVENT),this.addKeyword(TokenNames.prototype.X.toUpperCase(),TokenTypes.prototype.SESSIONEXPIRES_TO),this.addKeyword(this.SIPETagHeader.toUpperCase(),TokenTypes.prototype.SIP_ETAG),this.addKeyword(this.SIPIfMatchHeader.toUpperCase(),TokenTypes.prototype.SIP_IF_MATCH),
this.addKeyword(this.SessionExpiresHeader.toUpperCase(),TokenTypes.prototype.SESSIONEXPIRES_TO),this.addKeyword(this.MinSEHeader.toUpperCase(),TokenTypes.prototype.MINSE_TO),this.addKeyword(this.ReferredByHeader.toUpperCase(),TokenTypes.prototype.REFERREDBY_TO),this.addKeyword(TokenNames.prototype.B.toUpperCase(),TokenTypes.prototype.REFERREDBY_TO),this.addKeyword(this.ReplacesHeader.toUpperCase(),TokenTypes.prototype.REPLACES_TO),this.addKeyword(this.JoinHeader.toUpperCase(),TokenTypes.prototype.JOIN_TO),
this.addKeyword(this.PathHeader.toUpperCase(),TokenTypes.prototype.PATH),this.addKeyword(this.ServiceRouteHeader.toUpperCase(),TokenTypes.prototype.SERVICE_ROUTE),this.addKeyword(this.PAssertedIdentityHeader.toUpperCase(),TokenTypes.prototype.P_ASSERTED_IDENTITY),this.addKeyword(this.PPreferredIdentityHeader.toUpperCase(),TokenTypes.prototype.P_PREFERRED_IDENTITY),this.addKeyword(this.PrivacyHeader.toUpperCase(),TokenTypes.prototype.PRIVACY),this.addKeyword(this.PCalledPartyIDHeader.toUpperCase(),
TokenTypes.prototype.P_CALLED_PARTY_ID),this.addKeyword(this.PAssociatedURIHeader.toUpperCase(),TokenTypes.prototype.P_ASSOCIATED_URI),this.addKeyword(this.PVisitedNetworkIDHeader.toUpperCase(),TokenTypes.prototype.P_VISITED_NETWORK_ID),this.addKeyword(this.PChargingFunctionAddressesHeader.toUpperCase(),TokenTypes.prototype.P_CHARGING_FUNCTION_ADDRESSES),this.addKeyword(this.PChargingVectorHeader.toUpperCase(),TokenTypes.prototype.P_VECTOR_CHARGING),this.addKeyword(this.PAccessNetworkInfoHeader.toUpperCase(),
TokenTypes.prototype.P_ACCESS_NETWORK_INFO),this.addKeyword(this.PMediaAuthorizationHeader.toUpperCase(),TokenTypes.prototype.P_MEDIA_AUTHORIZATION),this.addKeyword(this.SecurityServerHeader.toUpperCase(),TokenTypes.prototype.SECURITY_SERVER),this.addKeyword(this.SecurityVerifyHeader.toUpperCase(),TokenTypes.prototype.SECURITY_VERIFY),this.addKeyword(this.SecurityClientHeader.toUpperCase(),TokenTypes.prototype.SECURITY_CLIENT),this.addKeyword(this.PUserDatabaseHeader.toUpperCase(),TokenTypes.prototype.P_USER_DATABASE),
this.addKeyword(this.PProfileKeyHeader.toUpperCase(),TokenTypes.prototype.P_PROFILE_KEY),this.addKeyword(this.PServedUserHeader.toUpperCase(),TokenTypes.prototype.P_SERVED_USER),this.addKeyword(this.PPreferredServiceHeader.toUpperCase(),TokenTypes.prototype.P_PREFERRED_SERVICE),this.addKeyword(this.PAssertedServiceHeader.toUpperCase(),TokenTypes.prototype.P_ASSERTED_SERVICE),this.addKeyword(this.ReferencesHeader.toUpperCase(),TokenTypes.prototype.REFERENCES),this.addKeyword(this.AcceptContact.toUpperCase(),
TokenTypes.prototype.ACCEPT_CONTACT)):"status_lineLexer"==a?this.addKeyword(TokenNames.prototype.SIP.toUpperCase(),TokenTypes.prototype.SIP):"request_lineLexer"==a?this.addKeyword(TokenNames.prototype.SIP.toUpperCase(),TokenTypes.prototype.SIP):"sip_urlLexer"==a&&(this.addKeyword(TokenNames.prototype.TEL.toUpperCase(),TokenTypes.prototype.TEL),this.addKeyword(TokenNames.prototype.SIP.toUpperCase(),TokenTypes.prototype.SIP),this.addKeyword(TokenNames.prototype.SIPS.toUpperCase(),TokenTypes.prototype.SIPS)))};
function HeaderParser(a){this.classname="HeaderParser";"string"==typeof a?this.lexer=new Lexer("command_keywordLexer",a):"object"==typeof a&&(this.lexer=a,this.lexer.selectLexer("command_keywordLexer"))}HeaderParser.prototype=new Parser;HeaderParser.prototype.constructor=HeaderParser;
HeaderParser.prototype.wkday=function(){var a=this.lexer.ttoken().toLowerCase();if(TokenNames.prototype.MON==a.toLowerCase())return 2;if(TokenNames.prototype.TUE.toLowerCase()==a.toLowerCase())return 3;if(TokenNames.prototype.WED.toLowerCase()==a.toLowerCase())return 4;if(TokenNames.prototype.THU.toLowerCase()==a.toLowerCase())return 5;if(TokenNames.prototype.FRI.toLowerCase()==a.toLowerCase())return 6;if(TokenNames.prototype.SAT.toLowerCase()==a.toLowerCase())return 7;if(TokenNames.prototype.SUN.toLowerCase()==
a.toLowerCase())return 1;console.error("HeaderParser:wkday(): bad wkday");throw"HeaderParser:wkday(): bad wkday";};
HeaderParser.prototype.date=function(){try{var a=new Date,b=this.lexer.number()+0;if(0>=b||31<b)throw console.error("HeaderParser:date(): bad day"),"HeaderParser:date():  bad day";a.set(5,b);this.lexer.match(" ");var c=this.lexer.ttoken().toLowerCase();c.equals("jan")?a.setMonth(0):"feb"==c?a.setMonth(1):"mar"==c?a.setMonth(2):"apr"==c?a.setMonth(3):"may"==c?a.setMonth(4):"jun"==c?a.setMonth(5):"jul"==c?a.setMonth(6):"aug"==c?a.setMonth(7):"sep"==c?a.setMonth(8):"oct"==c?a.setMonth(9):"nov"==c?a.setMonth(10):
"dec"==c&&a.setMonth(11);this.lexer.match(" ");var d=this.lexer.number();a.setYear(d);return a}catch(e){throw console.error("HeaderParser:date(): bad date field"),"HeaderParser:date(): bad date field";}};
HeaderParser.prototype.time=function(a){try{var b=this.lexer.number();a.setHours(b);this.lexer.match(":");b=this.lexer.number();a.setMinutes(b);this.lexer.match(":");b=this.lexer.number();a.setSeconds(b)}catch(c){throw console.error("HeaderParser:time(): error processing time "),"HeaderParser:time():error processing time ";}};
HeaderParser.prototype.parse=function(){var a=this.lexer.getNextToken(":");this.lexer.consume(1);var b=this.lexer.getLine().replace(/^(\s)+|(\s)+$/g,"");a=new ExtensionHeaderImpl(a);a.setValue(b);return a};HeaderParser.prototype.headerName=function(a){this.lexer.match(a);this.lexer.SPorHT();this.lexer.match(":");this.lexer.SPorHT()};
function ParametersParser(a){this.classname="ParametersParser";"object"==typeof a?(this.lexer=a,this.lexer.selectLexer("command_keywordLexer")):"string"==typeof a&&(this.lexer=new Lexer("command_keywordLexer",a))}ParametersParser.prototype=new HeaderParser;ParametersParser.prototype.constructor=ParametersParser;ParametersParser.prototype.parse=function(a){for(this.lexer.SPorHT();";"==this.lexer.lookAhead(0);){this.lexer.consume(1);this.lexer.SPorHT();var b=this.nameValue();a.setParameter_nv(b);this.lexer.SPorHT()}};
ParametersParser.prototype.parseNameValueList=function(a){for(a.removeParameters();;){this.lexer.SPorHT();var b=nameValue();a.setParameter(b.getName(),b.getValueAsObject());this.lexer.SPorHT();if(";"!=this.lexer.lookAhead(0))break;else this.lexer.consume(1)}};function TokenTypes(){this.classname="TokenTypes"}TokenTypes.prototype.constructor=Parser;TokenTypes.prototype.START=LexerCore.prototype.START;TokenTypes.prototype.END=LexerCore.prototype.END;
TokenTypes.prototype.SIP=LexerCore.prototype.START+3;TokenTypes.prototype.REGISTER=LexerCore.prototype.START+4;TokenTypes.prototype.INVITE=LexerCore.prototype.START+5;TokenTypes.prototype.ACK=LexerCore.prototype.START+6;TokenTypes.prototype.BYE=LexerCore.prototype.START+7;TokenTypes.prototype.OPTIONS=LexerCore.prototype.START+8;TokenTypes.prototype.CANCEL=LexerCore.prototype.START+9;TokenTypes.prototype.ERROR_INFO=LexerCore.prototype.START+10;
TokenTypes.prototype.IN_REPLY_TO=LexerCore.prototype.START+11;TokenTypes.prototype.MIME_VERSION=LexerCore.prototype.START+12;TokenTypes.prototype.ALERT_INFO=LexerCore.prototype.START+13;TokenTypes.prototype.FROM=LexerCore.prototype.START+14;TokenTypes.prototype.TO=LexerCore.prototype.START+15;TokenTypes.prototype.VIA=LexerCore.prototype.START+16;TokenTypes.prototype.USER_AGENT=LexerCore.prototype.START+17;TokenTypes.prototype.SERVER=LexerCore.prototype.START+18;
TokenTypes.prototype.ACCEPT_ENCODING=LexerCore.prototype.START+19;TokenTypes.prototype.ACCEPT=LexerCore.prototype.START+20;TokenTypes.prototype.ALLOW=LexerCore.prototype.START+21;TokenTypes.prototype.ROUTE=LexerCore.prototype.START+22;TokenTypes.prototype.AUTHORIZATION=LexerCore.prototype.START+23;TokenTypes.prototype.PROXY_AUTHORIZATION=LexerCore.prototype.START+24;TokenTypes.prototype.RETRY_AFTER=LexerCore.prototype.START+25;TokenTypes.prototype.PROXY_REQUIRE=LexerCore.prototype.START+26;
TokenTypes.prototype.CONTENT_LANGUAGE=LexerCore.prototype.START+27;TokenTypes.prototype.UNSUPPORTED=LexerCore.prototype.START+28;TokenTypes.prototype.SUPPORTED=LexerCore.prototype.START+20;TokenTypes.prototype.WARNING=LexerCore.prototype.START+30;TokenTypes.prototype.MAX_FORWARDS=LexerCore.prototype.START+31;TokenTypes.prototype.DATE=LexerCore.prototype.START+32;TokenTypes.prototype.PRIORITY=LexerCore.prototype.START+33;TokenTypes.prototype.PROXY_AUTHENTICATE=LexerCore.prototype.START+34;
TokenTypes.prototype.CONTENT_ENCODING=LexerCore.prototype.START+35;TokenTypes.prototype.CONTENT_LENGTH=LexerCore.prototype.START+36;TokenTypes.prototype.SUBJECT=LexerCore.prototype.START+37;TokenTypes.prototype.CONTENT_TYPE=LexerCore.prototype.START+38;TokenTypes.prototype.CONTACT=LexerCore.prototype.START+39;TokenTypes.prototype.CALL_ID=LexerCore.prototype.START+40;TokenTypes.prototype.REQUIRE=LexerCore.prototype.START+41;TokenTypes.prototype.EXPIRES=LexerCore.prototype.START+42;
TokenTypes.prototype.ENCRYPTION=LexerCore.prototype.START+43;TokenTypes.prototype.RECORD_ROUTE=LexerCore.prototype.START+44;TokenTypes.prototype.ORGANIZATION=LexerCore.prototype.START+45;TokenTypes.prototype.CSEQ=LexerCore.prototype.START+46;TokenTypes.prototype.ACCEPT_LANGUAGE=LexerCore.prototype.START+47;TokenTypes.prototype.WWW_AUTHENTICATE=LexerCore.prototype.START+48;TokenTypes.prototype.RESPONSE_KEY=LexerCore.prototype.START+49;TokenTypes.prototype.HIDE=LexerCore.prototype.START+50;
TokenTypes.prototype.CALL_INFO=LexerCore.prototype.START+51;TokenTypes.prototype.CONTENT_DISPOSITION=LexerCore.prototype.START+52;TokenTypes.prototype.SUBSCRIBE=LexerCore.prototype.START+53;TokenTypes.prototype.NOTIFY=LexerCore.prototype.START+54;TokenTypes.prototype.TIMESTAMP=LexerCore.prototype.START+55;TokenTypes.prototype.SUBSCRIPTION_STATE=LexerCore.prototype.START+56;TokenTypes.prototype.TEL=LexerCore.prototype.START+57;TokenTypes.prototype.REPLY_TO=LexerCore.prototype.START+58;
TokenTypes.prototype.REASON=LexerCore.prototype.START+59;TokenTypes.prototype.RSEQ=LexerCore.prototype.START+60;TokenTypes.prototype.RACK=LexerCore.prototype.START+61;TokenTypes.prototype.MIN_EXPIRES=LexerCore.prototype.START+62;TokenTypes.prototype.EVENT=LexerCore.prototype.START+63;TokenTypes.prototype.AUTHENTICATION_INFO=LexerCore.prototype.START+64;TokenTypes.prototype.ALLOW_EVENTS=LexerCore.prototype.START+65;TokenTypes.prototype.REFER_TO=LexerCore.prototype.START+66;
TokenTypes.prototype.PUBLISH=LexerCore.prototype.START+67;TokenTypes.prototype.SIP_ETAG=LexerCore.prototype.START+68;TokenTypes.prototype.SIP_IF_MATCH=LexerCore.prototype.START+69;TokenTypes.prototype.MESSAGE=LexerCore.prototype.START+70;TokenTypes.prototype.PATH=LexerCore.prototype.START+71;TokenTypes.prototype.SERVICE_ROUTE=LexerCore.prototype.START+72;TokenTypes.prototype.P_ASSERTED_IDENTITY=LexerCore.prototype.START+73;TokenTypes.prototype.P_PREFERRED_IDENTITY=LexerCore.prototype.START+74;
TokenTypes.prototype.P_VISITED_NETWORK_ID=LexerCore.prototype.START+75;TokenTypes.prototype.P_CHARGING_FUNCTION_ADDRESSES=LexerCore.prototype.START+76;TokenTypes.prototype.P_VECTOR_CHARGING=LexerCore.prototype.START+77;TokenTypes.prototype.PRIVACY=LexerCore.prototype.START+78;TokenTypes.prototype.P_ACCESS_NETWORK_INFO=LexerCore.prototype.START+79;TokenTypes.prototype.P_CALLED_PARTY_ID=LexerCore.prototype.START+80;TokenTypes.prototype.P_ASSOCIATED_URI=LexerCore.prototype.START+81;
TokenTypes.prototype.P_MEDIA_AUTHORIZATION=LexerCore.prototype.START+82;TokenTypes.prototype.P_MEDIA_AUTHORIZATION_TOKEN=LexerCore.prototype.START+83;TokenTypes.prototype.REFERREDBY_TO=LexerCore.prototype.START+84;TokenTypes.prototype.SESSIONEXPIRES_TO=LexerCore.prototype.START+85;TokenTypes.prototype.MINSE_TO=LexerCore.prototype.START+86;TokenTypes.prototype.REPLACES_TO=LexerCore.prototype.START+87;TokenTypes.prototype.SIPS=LexerCore.prototype.START+88;
TokenTypes.prototype.SECURITY_SERVER=LexerCore.prototype.START+89;TokenTypes.prototype.SECURITY_CLIENT=LexerCore.prototype.START+90;TokenTypes.prototype.SECURITY_VERIFY=LexerCore.prototype.START+91;TokenTypes.prototype.JOIN_TO=LexerCore.prototype.START+92;TokenTypes.prototype.P_USER_DATABASE=LexerCore.prototype.START+93;TokenTypes.prototype.P_PROFILE_KEY=LexerCore.prototype.START+94;TokenTypes.prototype.P_SERVED_USER=LexerCore.prototype.START+95;
TokenTypes.prototype.P_PREFERRED_SERVICE=LexerCore.prototype.START+96;TokenTypes.prototype.P_ASSERTED_SERVICE=LexerCore.prototype.START+97;TokenTypes.prototype.REFERENCES=LexerCore.prototype.START+98;TokenTypes.prototype.ACCEPT_CONTACT=LexerCore.prototype.START+99;TokenTypes.prototype.ALPHA=LexerCore.prototype.ALPHA;TokenTypes.prototype.DIGIT=LexerCore.prototype.DIGIT;TokenTypes.prototype.ID=LexerCore.prototype.ID;TokenTypes.prototype.WHITESPACE=LexerCore.prototype.WHITESPACE;
TokenTypes.prototype.BACKSLASH=LexerCore.prototype.BACKSLASH;TokenTypes.prototype.QUOTE=LexerCore.prototype.QUOTE;TokenTypes.prototype.AT=LexerCore.prototype.AT;TokenTypes.prototype.SP=LexerCore.prototype.SP;TokenTypes.prototype.HT=LexerCore.prototype.HT;TokenTypes.prototype.COLON=LexerCore.prototype.COLON;TokenTypes.prototype.STAR=LexerCore.prototype.STAR;TokenTypes.prototype.DOLLAR=LexerCore.prototype.DOLLAR;TokenTypes.prototype.PLUS=LexerCore.prototype.PLUS;TokenTypes.prototype.POUND=LexerCore.prototype.POUND;
TokenTypes.prototype.MINUS=LexerCore.prototype.MINUS;TokenTypes.prototype.DOUBLEQUOTE=LexerCore.prototype.DOUBLEQUOTE;TokenTypes.prototype.TILDE=LexerCore.prototype.TILDE;TokenTypes.prototype.BACK_QUOTE=LexerCore.prototype.BACK_QUOTE;TokenTypes.prototype.NULL=LexerCore.prototype.NULL;TokenTypes.prototype.EQUALS=61;TokenTypes.prototype.SEMICOLON=59;TokenTypes.prototype.SLASH=47;TokenTypes.prototype.L_SQUARE_BRACKET=91;TokenTypes.prototype.R_SQUARE_BRACKET=93;TokenTypes.prototype.R_CURLY=125;
TokenTypes.prototype.L_CURLY=123;TokenTypes.prototype.HAT=94;TokenTypes.prototype.BAR=124;TokenTypes.prototype.DOT=46;TokenTypes.prototype.EXCLAMATION=33;TokenTypes.prototype.LPAREN=40;TokenTypes.prototype.RPAREN=41;TokenTypes.prototype.GREATER_THAN=62;TokenTypes.prototype.LESS_THAN=60;TokenTypes.prototype.PERCENT=37;TokenTypes.prototype.QUESTION=63;TokenTypes.prototype.AND=38;TokenTypes.prototype.UNDERSCORE=95;function TokenNames(){this.classname="TokenNames"}TokenNames.prototype.INVITE="INVITE";
TokenNames.prototype.ACK="ACK";TokenNames.prototype.BYE="BYE";TokenNames.prototype.SUBSCRIBE="SUBSCRIBE";TokenNames.prototype.NOTIFY="NOTIFY";TokenNames.prototype.OPTIONS="OPTIONS";TokenNames.prototype.REGISTER="REGISTER";TokenNames.prototype.MESSAGE="MESSAGE";TokenNames.prototype.PUBLISH="PUBLISH";TokenNames.prototype.SIP="sip";TokenNames.prototype.SIPS="sips";TokenNames.prototype.TEL="tel";TokenNames.prototype.GMT="GMT";TokenNames.prototype.MON="Mon";TokenNames.prototype.TUE="Tue";
TokenNames.prototype.WED="Wed";TokenNames.prototype.THU="Thu";TokenNames.prototype.FRI="Fri";TokenNames.prototype.SAT="Sat";TokenNames.prototype.SUN="Sun";TokenNames.prototype.JAN="Jan";TokenNames.prototype.FEB="Feb";TokenNames.prototype.MAR="Mar";TokenNames.prototype.APR="Apr";TokenNames.prototype.MAY="May";TokenNames.prototype.JUN="Jun";TokenNames.prototype.JUL="Jul";TokenNames.prototype.AUG="Aug";TokenNames.prototype.SEP="Sep";TokenNames.prototype.OCT="Oct";TokenNames.prototype.NOV="Nov";
TokenNames.prototype.DEC="Dec";TokenNames.prototype.K="K";TokenNames.prototype.C="C";TokenNames.prototype.E="E";TokenNames.prototype.F="F";TokenNames.prototype.I="I";TokenNames.prototype.M="M";TokenNames.prototype.L="L";TokenNames.prototype.S="S";TokenNames.prototype.T="T";TokenNames.prototype.U="U";TokenNames.prototype.V="V";TokenNames.prototype.R="R";TokenNames.prototype.O="O";TokenNames.prototype.X="X";TokenNames.prototype.B="B";
function StringMsgParser(a){this.classname="StringMsgParser";this.readBody=!0;this.rawStringMessage=this.parseExceptionListener=null;this.strict=!0;this.computeContentLengthFromMessage=!1;this.viaCount=0;null!=a&&(this.parseExceptionListener=a)}StringMsgParser.prototype.SIP_VERSION_STRING="SIP/2.0";StringMsgParser.prototype.setParseExceptionListener=function(a){this.parseExceptionListener=a};
StringMsgParser.prototype.parseSIPMessage=function(a){if("string"==typeof a)return this.parseSIPMessagestring(a);if("object"==typeof a)return this.parseSIPMessagebyte(a)};
StringMsgParser.prototype.parseSIPMessagestring=function(a){if(null==a||0==a.length)return null;this.rawStringMessage=a;var b=0;try{for(;32>a.charCodeAt(b);)b++}catch(h){return console.error("StringMsgParser:parseSIPMessagestring(): catched exception:"+h),null}if(b>=a.length)return null;var c=null,d=!0,e=null;do{var f=b;try{for(var g=a.charAt(b);"\r"!=g&&"\n"!=g;)g=a.charAt(++b)}catch(h){console.error("StringMsgParser:parseSIPMessagestring(): catched exception:"+h);break}f=a.substring(f,b);f=this.trimEndOfLine(f);
if(0==f.length)null!=c&&this.processHeader(c,e);else if(d)e=this.processFirstLine(f);else if(d=f.charAt(0),"\t"==d||" "==d){if(null==c)throw console.error("StringMsgParser:parseSIPMessagestring(): bad header continuation."),"StringMsgParser:parseSIPMessagestring(): bad header continuation.";c+=f.substring(1)}else null!=c&&this.processHeader(c,e),c=f;"\r"==a.charAt(b)&&a.length>b+1&&"\n"==a.charAt(b+1)&&b++;b++;d=!1}while(0<f.length);e.setSize(b);if(this.readBody&&null!=e.getContentLength())if(0!=
e.getContentLength().getContentLength())a=a.substring(b),e.setMessageContent(a,this.strict,this.computeContentLengthFromMessage,e.getContentLength().getContentLength());else if(!this.computeContentLengthFromMessage&&0==e.getContentLength().getContentLength()&&this.strict&&0==a.substring(a.length-4,4))throw console.error("StringMsgParser:parse(): extraneous characters at the end of the message",b),"StringMsgParser:parse(): extraneous characters at the end of the message";return e};
StringMsgParser.prototype.parseSIPMessagebyte=function(a){if(null==a||0==a.length)return null;var b=0;try{for(;32>a[b].charCodeAt(0);)b++}catch(l){return console.error("StringMsgParser:parseSIPMessagebyte(): catched exception:"+l),null}if(b>=a.length)return null;var c="",d=null,e=!0,f=null;do{var g=b;try{for(;"\r"!=a[b]&&"\n"!=a[b];)b++}catch(l){console.error("StringMsgParser:parseSIPMessagebyte(): catched exception:"+l);break}var h=b-g;try{for(var k=0;k<h;k++)c+=a[k+g]}catch(l){throw console.error("StringMsgParser:parseSIPMessagebyte(): bad message encoding!"),
"StringMsgParser:parseSIPMessagebyte():bad message encoding!";}c=this.trimEndOfLine(c);if(0==c.length())null!=d&&null!=f&&this.processHeader(d,f);else if(e)f=this.processFirstLine(c);else if(k=c.charAt(0),"\t"==k||" "==k){if(null==d)throw console.error("StringMsgParser:parseSIPMessagebyte(): bad header continuation"),"StringMsgParser:parseSIPMessagebyte(): bad header continuation";d+=c.substring(1)}else null!=d&&null!=f&&this.processHeader(d,f),d=c;"\r"==a[b]&&a.length>b+1&&"\n"==a[b+1]&&b++;b++;
e=!1}while(0<c.length);if(null==f)throw console.error("StringMsgParser:parseSIPMessagebyte(): bad message"),"StringMsgParser:parseSIPMessagebyte(): bad message";f.setSize(b);if(this.readBody&&null!=f.getContentLength()&&0!=f.getContentLength().getContentLength()){c=a.length-b;d=[];for(k=0;k<c;k++)d[k]=a[b],b+=1;f.setMessageContent(d,this.computeContentLengthFromMessage,f.getContentLength().getContentLength())}return f};
StringMsgParser.prototype.trimEndOfLine=function(a){if(null==a)return a;for(var b=a.length-1;0<=b&&32>=a.charCodeAt(b);)b--;return b==a.length-1?a:-1==b?"":a.substring(0,b+1)};
StringMsgParser.prototype.processFirstLine=function(a){var b=this.SIP_VERSION_STRING.length;for(var c=0,d=0;d<b;d++)a.charAt(d)==this.SIP_VERSION_STRING.charAt(d)&&(c+=1);if(c!=b){b=new SIPRequest;try{var e=(new RequestLineParser(a+"\n")).parse();b.setRequestLine(e)}catch(g){if(console.error("StringMsgParser:processFirstLine(): catched exception:"+g),null!=this.parseExceptionListener)e=new RequestLine,this.parseExceptionListener.handleException(g,b,e.classname,a,this.rawStringMessage);else throw g;
}}else{b=new SIPResponse;try{var f=(new StatusLineParser(a+"\n")).parse();b.setStatusLine(f)}catch(g){if(console.error("StringMsgParser:processFirstLine(): catched exception:"+g),null!=this.parseExceptionListener)f=new StatusLine,this.parseExceptionListener.handleException(g,b,f.classname,a,this.rawStringMessage);else throw g;}}return b};
StringMsgParser.prototype.processHeader=function(a,b){if(null!=a&&0!=a.length){var c=null;try{c=(new ParserFactory).createParser(a+"\n")}catch(e){console.error("StringMsgParser:processHeader(): catched exception:"+e);this.parseExceptionListener.handleException(e,b,null,a,this.rawStringMessage);return}try{var d=c.parse();d instanceof ViaList?(this.viaCount+=1,1==this.viaCount?b.attachHeader(d,!1):b.addViaHeaderList(d)):b.attachHeader(d,!1)}catch(e){console.error("StringMsgParser:processHeader(): catched exception:"+
e),null!=this.parseExceptionListener&&(c=(new Lexer).getHeaderName(a),new NameMap,this.parseExceptionListener.handleException(e,b,c,a,this.rawStringMessage))}}};StringMsgParser.prototype.parseAddress=function(a){return(new AddressParser(a)).address(!0)};StringMsgParser.prototype.parseHost=function(a){a=new Lexer("charLexer",a);return(new HostNameParser(a)).host()};StringMsgParser.prototype.parseTelephoneNumber=function(a){return(new URLParser(a)).parseTelephoneNumber(!0)};
StringMsgParser.prototype.parseSIPUrl=function(a){try{return(new URLParser(a)).sipURL(!0)}catch(b){throw console.error("StringMsgParser:parseSIPUrl(): "+a+" is not a SIP URL "),"StringMsgParser:parseSIPUrl(): "+a+" is not a SIP URL ";}};StringMsgParser.prototype.parseUrl=function(a){return(new URLParser(a)).parse()};
StringMsgParser.prototype.parseSIPHeader=function(a){var b=0,c=a.length-1;try{for(;32>=a.charCodeAt(b);)b++;for(;32>=a.charCodeAt(c);)c--}catch(h){throw console.error("StringMsgParser:parseSIPHeader(): empty header"),"StringMsgParser:parseSIPHeader(): eEmpty header";}for(var d="",e=b,f=!1;e<=c;){var g=a.charAt(e);"\r"==g||"\n"==g?f||(d+=a.substring(b,e),f=!0):f&&(f=!1," "==g||"\t"==g?(d+=" ",b=e+1):b=e);e++}d+=a.substring(b,e);d+="\n";a=(new ParserFactory).createParser(d.toString());if(null==a)throw console.error("StringMsgParser:parseSIPHeader(): could not create parser"),
"StringMsgParser:parseSIPHeader(): could not create parser";return a.parse()};StringMsgParser.prototype.parseSIPRequestLine=function(a){return(new RequestLineParser(a+"\n")).parse()};StringMsgParser.prototype.parseSIPStatusLine=function(a){return(new StatusLineParser(a+"\n")).parse()};StringMsgParser.prototype.setComputeContentLengthFromMessage=function(a){this.computeContentLengthFromMessage=a};StringMsgParser.prototype.setStrict=function(a){this.strict=a};
function AddressParametersParser(a){this.classname="AddressParametersParser";"object"==typeof a?(this.lexer=a,this.lexer.selectLexer("command_keywordLexer")):"string"==typeof a&&(this.lexer=new Lexer("command_keywordLexer",a))}AddressParametersParser.prototype=new ParametersParser;AddressParametersParser.prototype.constructor=AddressParametersParser;
AddressParametersParser.prototype.parse=function(a){try{var b=(new AddressParser(this.getLexer())).address(!1);a.setAddress(b);this.lexer.SPorHT();var c=this.lexer.lookAhead(0);this.lexer.hasMoreChars()&&""!=c&&"\n"!=c&&this.lexer.startsId()?ParametersParser.prototype.parseNameValueList.call(this,a):ParametersParser.prototype.parse.call(this,a)}catch(d){throw console.error("AddressParametersParser:parse(): address Error"),d;}};
function ChallengeParser(a){this.classname="ChallengeParser";"object"==typeof a?(this.lexer=a,this.lexer.selectLexer("command_keywordLexer")):"string"==typeof a&&(this.lexer=new Lexer("command_keywordLexer",a))}ChallengeParser.prototype=new HeaderParser;ChallengeParser.prototype.constructor=ChallengeParser;
ChallengeParser.prototype.parse=function(a){this.lexer.SPorHT();this.lexer.match(TokenTypes.prototype.ID);var b=this.lexer.getNextToken();this.lexer.SPorHT();for(a.setScheme(b.getTokenValue());"\n"!=this.lexer.lookAhead(0);){this.parseParameter(a);this.lexer.SPorHT();b=this.lexer.lookAhead(0);if("\n"==b||"'\x00'"==b)break;this.lexer.match(",");this.lexer.SPorHT()}};ChallengeParser.prototype.parseParameter=function(a){var b=this.nameValue("=");a.setParameter_nv(b)};
function URLParser(a){this.classname="URLParser";"object"==typeof a?(this.lexer=a,this.lexer.selectLexer("sip_urlLexer")):"string"==typeof a&&(this.lexer=new Lexer("sip_urlLexer",a))}URLParser.prototype=new Parser;URLParser.prototype.constructor=URLParser;URLParser.prototype.PLUS=TokenTypes.prototype.PLUS;URLParser.prototype.SEMICOLON=TokenTypes.prototype.SEMICOLON;
URLParser.prototype.isMark=function(a){switch(a){case "-":case "_":case ".":case "!":case "~":case "*":case "'":case "(":case ")":return!0;default:return!1}};URLParser.prototype.isUnreserved=function(a){return(new Lexer("","")).isAlphaDigit(a)||this.isMark(a)?!0:!1};URLParser.prototype.isReservedNoSlash=function(a){switch(a){case ";":case "?":case ":":case "@":case "&":case "+":case "$":case ",":return!0;default:return!1}};
URLParser.prototype.isUserUnreserved=function(a){switch(a){case "&":case "?":case "+":case "$":case "#":case "/":case ",":case ";":case "=":return!0;default:return!1}};URLParser.prototype.unreserved=function(){var a=this.lexer.lookAhead(0);if(this.isUnreserved(a))return this.lexer.consume(1),a;console.error("URLParser:unreserved(): unreserved");throw"URLParser:unreserved(): unreserved";};
URLParser.prototype.paramNameOrValue=function(){for(var a=this.lexer.getPtr();this.lexer.hasMoreChars();){var b=this.lexer.lookAhead(0),c=!1;switch(b){case "[":case "]":case "/":case ":":case "&":case "+":case "$":c=!0}if(c||this.isUnreserved(b))this.lexer.consume(1);else if(this.isEscaped())this.lexer.consume(3);else break}return this.lexer.getBuffer().substring(a,this.lexer.getPtr())};
URLParser.prototype.uriParam=function(){var a="",b=this.paramNameOrValue(),c=!0;"="==this.lexer.lookAhead(0)&&(this.lexer.consume(1),a=this.paramNameOrValue(),c=!1);return 0!=b.length||null!=a&&0!=a.length?new NameValue(b,a,c):null};URLParser.prototype.isReserved=function(a){switch(a){case ";":case "/":case "?":case ":":case "=":case "@":case "&":case "+":case "$":case ",":return!0;default:return!1}};
URLParser.prototype.reserved=function(){var a=this.lexer.lookAhead(0);if(this.isReserved(a))return this.lexer.consume(1),(""+a).toString();console.error("URLParser:reserved(): reserved");throw"URLParser:reserved(): reserved";};URLParser.prototype.isEscaped=function(){try{var a=new Lexer("","");return"%"==this.lexer.lookAhead(0)&&a.isHexDigit(this.lexer.lookAhead(1))&&a.isHexDigit(this.lexer.lookAhead(2))?!0:!1}catch(b){return console.error("URLParser:isEscaped(): catched exception:"+b),!1}};
URLParser.prototype.escaped=function(){var a=new Lexer("",""),b=this.lexer.lookAhead(0),c=this.lexer.lookAhead(1),d=this.lexer.lookAhead(2);if("%"==b&&a.isHexDigit(c)&&a.isHexDigit(d))this.lexer.consume(3);else throw console.error("URLParser:escaped(): escaped"),"URLParser:escaped(): escaped";return(""+b+c+d).toString()};
URLParser.prototype.mark=function(){var a=this.lexer.lookAhead(0);if(this.isMark(a))return this.lexer.consume(1),a;console.error("URLParser:mark(): marked");throw"URLParser:mark(): marked";};
URLParser.prototype.uric=function(){try{var a=new Lexer("",""),b=this.lexer.lookAhead(0);if(this.isUnreserved(b)||this.isReserved(b))return this.lexer.consume(1),a.charAsString(b);if(this.isEscaped()){var c=this.lexer.charAsString(3);this.lexer.consume(3);return c}return null}catch(d){return console.error("URLParser:uric(): catched exception:"+d),null}};
URLParser.prototype.uricNoSlash=function(){try{var a=new Lexer("",""),b=this.lexer.lookAhead(0);if(this.isEscaped()){var c=this.lexer.charAsString(3);this.lexer.consume(3);return c}return this.isUnreserved(b)||this.isReservedNoSlash(b)?(this.lexer.consume(1),a.charAsString(b)):null}catch(d){return console.error("URLParser:uricNoSlash(): catched exception:"+d),null}};
URLParser.prototype.uricString=function(){for(var a="";;){var b=this.uric();if(null==b){if("["==this.lexer.lookAhead(0)){b=(new HostNameParser(this.getLexer())).hostPort(!1);a+=b.toString();continue}break}a+=b}return a.toString()};
URLParser.prototype.uriReference=function(a){var b=null,c=this.lexer.peekNextToken(2),d=c[0];c=c[1];if(d.getTokenType()==TokenTypes.prototype.SIP||d.getTokenType()==TokenTypes.prototype.SIPS)if(":"==c.getTokenType())b=this.sipURL(a);else throw console.error("URLParser:uriReference(): expecting ':'"),"URLParser:uriReference(): expecting ':'";else if(d.getTokenType()==TokenTypes.prototype.TEL)if(":"==c.getTokenType())b=this.telURL(a);else throw console.error("URLParser:uriReference(): expecting ':'"),
"URLParser:uriReference(): expecting ':'";else{a=this.uricString();try{b=new GenericURI(a)}catch(e){throw console.error("URLParser:uriReference(): "+e),"URLParser:uriReference(): "+e;}}return b};
URLParser.prototype.base_phone_number=function(){for(var a="",b=new Lexer("",""),c=0;this.lexer.hasMoreChars();){var d=this.lexer.lookAhead(0);if(b.isDigit(d)||"-"==d||"."==d||"("==d||")"==d)this.lexer.consume(1),a+=d,c++;else if(0<c)break;else throw console.error("URLParser:base_phone_number(): unexpected"+d),"URLParser:base_phone_number(): unexpected"+d;}return a.toString()};
URLParser.prototype.local_number=function(){for(var a="",b=new Lexer("",""),c=0;this.lexer.hasMoreChars();){var d=this.lexer.lookAhead(0);if("*"==d||"#"==d||"-"==d||"."==d||"("==d|")"==d||b.isHexDigit(d))this.lexer.consume(1),a+=d,c++;else if(0<c)break;else throw console.error("URLParser:local_number(): unexpected"+d),"URLParser:local_number(): unexpected"+d;}return a.toString()};
URLParser.prototype.parseTelephoneNumber=function(a){this.lexer.selectLexer("charLexer");var b=new Lexer("",""),c=this.lexer.lookAhead(0);if("+"==c)a=this.global_phone_number(a);else if(b.isHexDigit(c)||"#"==c||"*"==c||"-"==c||"."==c||"("==c||")"==c)a=this.local_phone_number(a);else throw console.error("URLParser:parseTelephoneNumber(): unexpected char "+c),"URLParser:parseTelephoneNumber(): unexpected char "+c;return a};
URLParser.prototype.global_phone_number=function(a){var b=new TelephoneNumber;b.setGlobal(!0);this.lexer.match("+");var c=this.base_phone_number();b.setPhoneNumber(c);this.lexer.hasMoreChars()&&";"==this.lexer.lookAhead(0)&&a&&(this.lexer.consume(1),a=tel_parameters(),b.setParameters(a));return b};
URLParser.prototype.local_phone_number=function(a){var b=new TelephoneNumber;b.setGlobal(!1);var c=this.local_number();b.setPhoneNumber(c);if(this.lexer.hasMoreChars())switch(this.lexer.peekNextToken().getTokenType()){case this.SEMICOLON:a&&(this.lexer.consume(1),a=this.tel_parameters(),b.setParameters(a))}return b};
URLParser.prototype.tel_parameters=function(){for(var a=new NameValueList,b;;){b=this.paramNameOrValue();if("phone-context"==b.toLowerCase())b=this.phone_context();else if("="==this.lexer.lookAhead(0)){this.lexer.consume(1);var c=this.paramNameOrValue();b=new NameValue(b,c,!1)}else b=new NameValue(b,"",!0);a.set(b);if(";"==this.lexer.lookAhead(0))this.lexer.consume(1);else return a}};
URLParser.prototype.phone_context=function(){this.lexer.match("=");var a=this.lexer.lookAhead(0);if("+"==a)this.lexer.consume(1),a="+"+this.base_phone_number();else if(Lexer.isAlphaDigit(a))a=this.lexer.match(Lexer.prototype.ID).getTokenValue();else throw console.error("URLParser:phone_context(): invalid phone-context:"+a),"URLParser:phone_context(): invalid phone-context:"+a;return new NameValue("phone-context",a,!1)};
URLParser.prototype.telURL=function(a){this.lexer.match(TokenTypes.prototype.TEL);this.lexer.match(":");a=this.parseTelephoneNumber(a);var b=new TelURLImpl;b.setTelephoneNumber(a);return b};
URLParser.prototype.sipURL=function(a){var b=new SipUri,c=this.lexer.peekNextToken(),d=TokenTypes.prototype.SIP,e=TokenNames.prototype.SIP;c.getTokenType()==TokenTypes.prototype.SIPS&&(d=TokenTypes.prototype.SIPS,e=TokenNames.prototype.SIPS);this.lexer.match(d);this.lexer.match(":");b.setScheme(e);c=this.lexer.markInputPosition();d=this.user();e=null;":"==this.lexer.lookAhead()&&(this.lexer.consume(1),e=this.password());"@"==this.lexer.lookAhead()?(this.lexer.consume(1),b.setUser(d),null!=e&&b.setUserPassword(e)):
this.lexer.rewindInputPosition(c);c=(new HostNameParser(this.getLexer())).hostPort(!1);b.setHostPort(c);for(this.lexer.selectLexer("charLexer");this.lexer.hasMoreChars()&&";"==this.lexer.lookAhead(0)&&a;)this.lexer.consume(1),c=this.uriParam(),null!=c&&b.setUriParameter(c);if(this.lexer.hasMoreChars()&&"?"==this.lexer.lookAhead(0))for(this.lexer.consume(1);this.lexer.hasMoreChars()&&(c=this.qheader(),b.setQHeader(c),!this.lexer.hasMoreChars()||"&"==this.lexer.lookAhead(0));)this.lexer.consume(1);
return b};URLParser.prototype.peekScheme=function(){var a=this.lexer.peekNextToken(1);return 0==a.length?null:a[0].getTokenValue()};URLParser.prototype.qheader=function(){for(var a=this.lexer.ptr;;){var b=this.lexer.lookAhead(0);if("="==b)break;else if(""==b)throw console.error("URLParser:qheader(): EOL reached"),"URLParser:qheader(): EOL reached";this.lexer.consume(1)}a=this.lexer.getBuffer().substring(a,this.lexer.ptr);this.lexer.consume(1);b=this.hvalue();return new NameValue(a,b,!1)};
URLParser.prototype.hvalue=function(){for(var a="";this.lexer.hasMoreChars();){var b=this.lexer.lookAhead(0),c=!1;switch(b){case "+":case "?":case ":":case "[":case "]":case "/":case "$":case "_":case "-":case '"':case "!":case "~":case "*":case ".":case "(":case ")":c=!0}var d=new Lexer("","");if(c||d.isAlphaDigit(b))this.lexer.consume(1),a+=b;else if("%"==b)a+=this.escaped();else break}return a.toString()};
URLParser.prototype.urlString=function(){var a="";for(this.lexer.selectLexer("charLexer");this.lexer.hasMoreChars();){var b=this.lexer.lookAhead(0);if(" "==b||"\t"==b||"\n"==b||">"==b||"<"==b)break;this.lexer.consume(0);a+=b}return a.toString()};
URLParser.prototype.user=function(){for(var a=this.lexer.getPtr();this.lexer.hasMoreChars();){var b=this.lexer.lookAhead(0);if(this.isUnreserved(b)||this.isUserUnreserved(b))this.lexer.consume(1);else if(this.isEscaped())this.lexer.consume(3);else break}return this.lexer.getBuffer().substring(a,this.lexer.getPtr())};
URLParser.prototype.password=function(){for(var a=this.lexer.getPtr();this.lexer.hasMoreChars();){var b=this.lexer.lookAhead(0),c=!1;switch(b){case "&":case "=":case "+":case "$":case ",":c=!0}if(c||this.isUnreserved(b))this.lexer.consume(1);else if(this.isEscaped())this.lexer.consume(3);else break}return this.lexer.getBuffer().substring(a,this.lexer.getPtr())};URLParser.prototype.parse=function(){return this.uriReference(!0)};
function AddressParser(a){this.classname="AddressParser";"object"==typeof a?(this.lexer=a,this.lexer.selectLexer("command_keywordLexer")):"string"==typeof a&&(this.lexer=new Lexer("command_keywordLexer",a))}AddressParser.prototype=new Parser;AddressParser.prototype.constructor=AddressParser;AddressParser.prototype.NAME_ADDR=1;AddressParser.prototype.ADDRESS_SPEC=2;
AddressParser.prototype.nameAddr=function(){if("<"==this.lexer.lookAhead(0)){this.lexer.consume(1);this.lexer.selectLexer("sip_urlLexer");this.lexer.SPorHT();var a=new URLParser(this.lexer);a=a.uriReference(!0);var b=new AddressImpl;b.setAddressType(this.NAME_ADDR);b.setURI(a);this.lexer.SPorHT();this.lexer.match(">");return b}b=new AddressImpl;b.setAddressType(this.NAME_ADDR);'"'==this.lexer.lookAhead(0)?(a=this.lexer.quotedString(),this.lexer.SPorHT()):a=this.lexer.getNextToken("<");b.setDisplayName(a.trim());
this.lexer.match("<");this.lexer.SPorHT();a=new URLParser(this.lexer);a=a.uriReference(!0);new AddressImpl;b.setAddressType(this.NAME_ADDR);b.setURI(a);this.lexer.SPorHT();this.lexer.match(">");return b};
AddressParser.prototype.address=function(a){var b;for(b=0;this.lexer.hasMoreChars();){var c=this.lexer.lookAhead(b);if("<"==c||'"'==c||":"==c||"/"==c)break;else{if(""==c)throw console.error("AddressParser:address(): unexpected EOL"),"AddressParser:parse(): unexpected EOL";b++}}c=this.lexer.lookAhead(b);if("<"==c||'"'==c)b=this.nameAddr();else if(":"==c||"/"==c)b=new AddressImpl,a=(new URLParser(this.lexer)).uriReference(a),b.setAddressType(this.ADDRESS_SPEC),b.setURI(a);else throw console.error("AddressParser:address(): bad address spec"),
"AddressParser:parse(): bad address spec";return b};function ToParser(a){this.classname="ToParser";"object"==typeof a?(this.lexer=a,this.lexer.selectLexer("command_keywordLexer")):"string"==typeof a&&(this.lexer=new Lexer("command_keywordLexer",a))}ToParser.prototype=new AddressParametersParser;ToParser.prototype.constructor=ToParser;
ToParser.prototype.parse=function(){this.headerName(TokenTypes.prototype.TO);var a=new To;AddressParametersParser.prototype.parse.call(this,a);this.lexer.match("\n");return a};function ReferToParser(a){this.classname="ReferToParser";"object"==typeof a?(this.lexer=a,this.lexer.selectLexer("command_keywordLexer")):"string"==typeof a&&(this.lexer=new Lexer("command_keywordLexer",a))}ReferToParser.prototype=new AddressParametersParser;ReferToParser.prototype.constructor=ReferToParser;
ReferToParser.prototype.parse=function(){this.headerName(TokenTypes.prototype.REFER_TO);var a=new ReferTo;AddressParametersParser.prototype.parse.call(this,a);this.lexer.match("\n");return a};function ReferredByParser(a){this.classname="ReferredByParser";"object"==typeof a?(this.lexer=a,this.lexer.selectLexer("command_keywordLexer")):"string"==typeof a&&(this.lexer=new Lexer("command_keywordLexer",a))}ReferredByParser.prototype=new AddressParametersParser;ReferredByParser.prototype.constructor=ReferredByParser;
ReferredByParser.prototype.parse=function(){this.headerName(TokenTypes.prototype.REFERREDBY_TO);var a=new ReferredBy;AddressParametersParser.prototype.parse.call(this,a);this.lexer.match("\n");return a};function FromParser(a){this.classname="FromParser";"object"==typeof a?(this.lexer=a,this.lexer.selectLexer("command_keywordLexer")):"string"==typeof a&&(this.lexer=new Lexer("command_keywordLexer",a))}FromParser.prototype=new AddressParametersParser;FromParser.prototype.constructor=FromParser;
FromParser.prototype.parse=function(){var a=new From;this.lexer.match(TokenTypes.prototype.FROM);this.lexer.SPorHT();this.lexer.match(":");this.lexer.SPorHT();AddressParametersParser.prototype.parse.call(this,a);this.lexer.match("\n");return a};function CSeqParser(a){this.classname="CSeqParser";"object"==typeof a?(this.lexer=a,this.lexer.selectLexer("command_keywordLexer")):"string"==typeof a&&(this.lexer=new Lexer("command_keywordLexer",a))}CSeqParser.prototype=new HeaderParser;
CSeqParser.prototype.constructor=CSeqParser;CSeqParser.prototype.parse=function(){var a=new CSeq;this.lexer.match(TokenTypes.prototype.CSEQ);this.lexer.SPorHT();this.lexer.match(":");this.lexer.SPorHT();var b=this.lexer.number();a.setSeqNumber(b);this.lexer.SPorHT();b=(new SIPRequest).getCannonicalName(this.method());a.setMethod(b);this.lexer.SPorHT();this.lexer.match("\n");return a};
function ViaParser(a){this.classname="ViaParser";"object"==typeof a?(this.lexer=a,this.lexer.selectLexer("command_keywordLexer")):"string"==typeof a&&(this.lexer=new Lexer("command_keywordLexer",a))}ViaParser.prototype=new HeaderParser;ViaParser.prototype.constructor=ViaParser;ViaParser.prototype.RECEIVED="received";ViaParser.prototype.BRANCH="branch";
ViaParser.prototype.parseVia=function(a){this.lexer.match(TokenTypes.prototype.ID);var b=this.lexer.getNextToken();this.lexer.SPorHT();this.lexer.match("/");this.lexer.SPorHT();this.lexer.match(TokenTypes.prototype.ID);this.lexer.SPorHT();var c=this.lexer.getNextToken();this.lexer.SPorHT();this.lexer.match("/");this.lexer.SPorHT();this.lexer.match(TokenTypes.prototype.ID);this.lexer.SPorHT();var d=this.lexer.getNextToken();this.lexer.SPorHT();var e=new Protocol;e.setProtocolName(b.getTokenValue());
e.setProtocolVersion(c.getTokenValue());e.setTransport(d.getTokenValue());a.setSentProtocol(e);b=(new HostNameParser(this.getLexer())).hostPort(!0);a.setSentBy(b);for(this.lexer.SPorHT();";"==this.lexer.lookAhead(0);){this.lexer.consume(1);this.lexer.SPorHT();b=this.nameValue();if(b.getName()==this.BRANCH&&null==b.getValueAsObject())throw console.error("ViaParser:parseVia(): null branch Id",this.lexer.getPtr()),"ViaParser:parseVia(): null branch Id"+this.lexer.getPtr();a.setParameter_nv(b);this.lexer.SPorHT()}if("("==
this.lexer.lookAhead(0)){this.lexer.selectLexer("charLexer");this.lexer.consume(1);for(b="";;)if(c=this.lexer.lookAhead(0),")"==c){this.lexer.consume(1);break}else if("\\"==c)c=this.lexer.getNextToken(),b+=c.getTokenValue(),this.lexer.consume(1),c=this.lexer.getNextToken(),b+=c.getTokenValue(),this.lexer.consume(1);else if("\n"==c)break;else b+=c,this.lexer.consume(1);a.setComment(b.toString())}};
ViaParser.prototype.nameValue=function(){this.lexer.match(LexerCore.prototype.ID);var a=this.lexer.getNextToken();this.lexer.SPorHT();try{var b=!1;if("="==this.lexer.lookAhead(0)){this.lexer.consume(1);this.lexer.SPorHT();var c=null;a.getTokenValue().toLowerCase()==this.RECEIVED.toLowerCase()?c=this.lexer.byteStringNoSemicolon():'"'==this.lexer.lookAhead(0)?(c=this.lexer.quotedString(),b=!0):(this.lexer.match(LexerCore.prototype.ID),c=this.lexer.getNextToken().getTokenValue());var d=new NameValue(a.getTokenValue().toLowerCase(),
c);b&&d.setQuotedValue();return d}return new NameValue(a.getTokenValue().toLowerCase(),null)}catch(e){return console.error("ViaParser:nameValue(): catched exception:"+e),new NameValue(a.getTokenValue(),null)}};
ViaParser.prototype.parse=function(){var a=new ViaList;this.lexer.match(TokenTypes.prototype.VIA);this.lexer.SPorHT();this.lexer.match(":");for(this.lexer.SPorHT();;){var b=new Via;this.parseVia(b);a.add(b);this.lexer.SPorHT();","==this.lexer.lookAhead(0)&&(this.lexer.consume(1),this.lexer.SPorHT());if("\n"==this.lexer.lookAhead(0))break}this.lexer.match("\n");return a};
function ContactParser(a){this.classname="ContactParser";"object"==typeof a?(this.lexer=a,this.lexer.selectLexer("command_keywordLexer")):"string"==typeof a&&(this.lexer=new Lexer("command_keywordLexer",a))}ContactParser.prototype=new AddressParametersParser;ContactParser.prototype.constructor=ContactParser;
ContactParser.prototype.parse=function(){this.headerName(TokenTypes.prototype.CONTACT);for(var a=new ContactList;;){var b=new Contact;if("*"==this.lexer.lookAhead(0)){var c=this.lexer.lookAhead(1);" "==c||"\t"==c||"\r"==c||"\n"==c?(this.lexer.match("*"),b.setWildCardFlag(!0)):AddressParametersParser.prototype.parse.call(this,b)}else AddressParametersParser.prototype.parse.call(this,b);a.add(b);this.lexer.SPorHT();b=this.lexer.lookAhead(0);if(","==b)this.lexer.match(","),this.lexer.SPorHT();else if("\n"==
b||""==b)break;else throw console.error("ContactParser:address(): unexpected char"),"ContactParser:parse(): unexpected char";}return a};
ContactParser.prototype.nameValue=function(){this.lexer.match(LexerCore.prototype.ID);var a=this.lexer.getNextToken();this.lexer.SPorHT();try{var b=!1;if("="==this.lexer.lookAhead(0)){this.lexer.consume(1);this.lexer.SPorHT();var c=null;'"'==this.lexer.lookAhead(0)?(c=this.lexer.quotedString(),b=!0):c=this.lexer.byteStringNoSemicolon();var d=new NameValue(a.getTokenValue().toLowerCase(),c);b&&d.setQuotedValue();return d}return new NameValue(a.getTokenValue().toLowerCase(),null)}catch(e){return console.error("ContactParser:nameValue(): catched exception:"+
e),new NameValue(a.getTokenValue(),null)}};function ContentTypeParser(a){this.classname="ContentTypeParser";"object"==typeof a?(this.lexer=a,this.lexer.selectLexer("command_keywordLexer")):"string"==typeof a&&(this.lexer=new Lexer("command_keywordLexer",a))}ContentTypeParser.prototype=new ParametersParser;ContentTypeParser.prototype.constructor=ContentTypeParser;
ContentTypeParser.prototype.parse=function(){var a=new ContentType;this.headerName(TokenTypes.prototype.CONTENT_TYPE);this.lexer.match(TokenTypes.prototype.ID);var b=this.lexer.getNextToken();this.lexer.SPorHT();a.setContentType(b.getTokenValue());this.lexer.match("/");this.lexer.match(TokenTypes.prototype.ID);b=this.lexer.getNextToken();this.lexer.SPorHT();a.setContentSubType(b.getTokenValue());ParametersParser.prototype.parse.call(this,a);this.lexer.match("\n");return a};
function ContentLengthParser(a){this.classname="ContentLengthParser";"object"==typeof a?(this.lexer=a,this.lexer.selectLexer("command_keywordLexer")):"string"==typeof a&&(this.lexer=new Lexer("command_keywordLexer",a))}ContentLengthParser.prototype=new HeaderParser;ContentLengthParser.prototype.constructor=ContentLengthParser;
ContentLengthParser.prototype.parse=function(){var a=new ContentLength;this.headerName(TokenTypes.prototype.CONTENT_LENGTH);var b=this.lexer.number();a.setContentLength(b);this.lexer.SPorHT();this.lexer.match("\n");return a};function AuthorizationParser(a){this.classname="AuthorizationParser";"object"==typeof a?(this.lexer=a,this.lexer.selectLexer("command_keywordLexer")):"string"==typeof a&&(this.lexer=new Lexer("command_keywordLexer",a))}AuthorizationParser.prototype=new ChallengeParser;
AuthorizationParser.prototype.constructor=AuthorizationParser;AuthorizationParser.prototype.parse=function(){this.headerName(TokenTypes.prototype.AUTHORIZATION);var a=new Authorization;ChallengeParser.prototype.parse.call(this,a);return a};function WWWAuthenticateParser(a){this.classname="WWWAuthenticateParser";"object"==typeof a?(this.lexer=a,this.lexer.selectLexer("command_keywordLexer")):"string"==typeof a&&(this.lexer=new Lexer("command_keywordLexer",a))}WWWAuthenticateParser.prototype=new ChallengeParser;
WWWAuthenticateParser.prototype.constructor=WWWAuthenticateParser;WWWAuthenticateParser.prototype.parse=function(){this.headerName(TokenTypes.prototype.WWW_AUTHENTICATE);var a=new WWWAuthenticate;ChallengeParser.prototype.parse.call(this,a);return a};function CallIDParser(a){this.classname="CallIDParser";"object"==typeof a?(this.lexer=a,this.lexer.selectLexer("command_keywordLexer")):"string"==typeof a&&(this.lexer=new Lexer("command_keywordLexer",a))}CallIDParser.prototype=new HeaderParser;
CallIDParser.prototype.constructor=CallIDParser;CallIDParser.prototype.parse=function(){this.lexer.match(TokenTypes.prototype.CALL_ID);this.lexer.SPorHT();this.lexer.match(":");this.lexer.SPorHT();var a=new CallID;this.lexer.SPorHT();var b=this.lexer.getRest();a.setCallId(b.trim());return a};function RouteParser(a){this.classname="RouteParser";"object"==typeof a?(this.lexer=a,this.lexer.selectLexer("command_keywordLexer")):"string"==typeof a&&(this.lexer=new Lexer("command_keywordLexer",a))}
RouteParser.prototype=new AddressParametersParser;RouteParser.prototype.constructor=RouteParser;
RouteParser.prototype.parse=function(){var a=new RouteList;this.lexer.match(TokenTypes.prototype.ROUTE);this.lexer.SPorHT();this.lexer.match(":");for(this.lexer.SPorHT();;){var b=new Route;AddressParametersParser.prototype.parse.call(this,b);a.add(b);this.lexer.SPorHT();b=this.lexer.lookAhead(0);if(","==b)this.lexer.match(","),this.lexer.SPorHT();else if("\n"==b)break;else throw console.error("RouteParser:parse(): unexpected char"),"RouteParser:parse(): unexpected char";}return a};
function RecordRouteParser(a){this.classname="RecordRouteParser";"object"==typeof a?(this.lexer=a,this.lexer.selectLexer("command_keywordLexer")):"string"==typeof a&&(this.lexer=new Lexer("command_keywordLexer",a))}RecordRouteParser.prototype=new AddressParametersParser;RecordRouteParser.prototype.constructor=RecordRouteParser;
RecordRouteParser.prototype.parse=function(){var a=new RecordRouteList;this.lexer.match(TokenTypes.prototype.RECORD_ROUTE);this.lexer.SPorHT();this.lexer.match(":");for(this.lexer.SPorHT();;){var b=new RecordRoute;AddressParametersParser.prototype.parse.call(this,b);a.add(b);this.lexer.SPorHT();b=this.lexer.lookAhead(0);if(","==b)this.lexer.match(","),this.lexer.SPorHT();else if("\n"==b)break;else throw console.error("RecordRouteParser:parse(): unexpected char"),"RecordRouteParser:parse(): unexpected char";
}return a};function ProxyAuthenticateParser(a){this.classname="ProxyAuthenticateParser";"object"==typeof a?(this.lexer=a,this.lexer.selectLexer("command_keywordLexer")):"string"==typeof a&&(this.lexer=new Lexer("command_keywordLexer",a))}ProxyAuthenticateParser.prototype=new ChallengeParser;ProxyAuthenticateParser.prototype.constructor=ProxyAuthenticateParser;
ProxyAuthenticateParser.prototype.parse=function(){this.headerName(TokenTypes.prototype.PROXY_AUTHENTICATE);var a=new ProxyAuthenticate;ChallengeParser.prototype.parse.call(this,a);return a};function ProxyAuthorizationParser(a){this.classname="ProxyAuthorizationParser";"object"==typeof a?(this.lexer=a,this.lexer.selectLexer("command_keywordLexer")):"string"==typeof a&&(this.lexer=new Lexer("command_keywordLexer",a))}ProxyAuthorizationParser.prototype=new ChallengeParser;
ProxyAuthorizationParser.prototype.constructor=ProxyAuthorizationParser;ProxyAuthorizationParser.prototype.parse=function(){this.headerName(TokenTypes.prototype.PROXY_AUTHORIZATION);var a=new ProxyAuthorization;ChallengeParser.prototype.parse.call(this,a);return a};function TimeStampParser(a){this.classname="TimeStampParser";"object"==typeof a?(this.lexer=a,this.lexer.selectLexer("command_keywordLexer")):"string"==typeof a&&(this.lexer=new Lexer("command_keywordLexer",a))}
TimeStampParser.prototype=new HeaderParser;TimeStampParser.prototype.constructor=TimeStampParser;TimeStampParser.prototype.TIMESTAMP="Timestamp";
TimeStampParser.prototype.parse=function(){var a=new TimeStamp;this.headerName(TokenTypes.prototype.TIMESTAMP);a.setHeaderName(this.TIMESTAMP);this.lexer.SPorHT();var b=this.lexer.number();if("."==this.lexer.lookAhead(0)){this.lexer.match(".");var c=this.lexer.number();a.setTimeStamp(b+"."+c)}else a.setTime(b);this.lexer.SPorHT();"\n"!=this.lexer.lookAhead(0)&&(b=this.lexer.number());"."==this.lexer.lookAhead(0)?(this.lexer.match("."),c=this.lexer.number(),a.setDelay(b+"."+c)):a.setDelay(b);return a};
function UserAgentParser(a){this.classname="UserAgentParser";"object"==typeof a?(this.lexer=a,this.lexer.selectLexer("command_keywordLexer")):"string"==typeof a&&(this.lexer=new Lexer("command_keywordLexer",a))}UserAgentParser.prototype=new HeaderParser;UserAgentParser.prototype.constructor=UserAgentParser;
UserAgentParser.prototype.parse=function(){var a=new UserAgent;this.headerName(TokenTypes.prototype.USER_AGENT);if("\n"==this.lexer.lookAhead(0))throw console.error("UserAgentParser:parse(): empty header"),"UserAgentParser:parse(): empty header";for(;"\n"!=this.lexer.lookAhead(0)&&""!=this.lexer.lookAhead(0);){if("("==this.lexer.lookAhead(0)){var b=this.lexer.comment();a.addProductToken("("+b+")")}else{this.getLexer().SPorHT();b=this.lexer.byteStringNoSlash();if(null==b)throw console.error("UserAgentParser:parse(): expected product string"),
"UserAgentParser:parse():expected product string";if("/"==this.lexer.peekNextToken().getTokenValue()){this.lexer.match("/");this.getLexer().SPorHT();var c=this.lexer.byteStringNoWhiteSpace();if(null==c)throw console.error("UserAgentParser:parse(): expected product version"),"UserAgentParser:parse(): expected product version";b=b+"/"+c}a.addProductToken(b.toString())}this.lexer.SPorHT()}return a};
function SupportedParser(a){this.classname="SupportedParser";"object"==typeof a?(this.lexer=a,this.lexer.selectLexer("command_keywordLexer")):"string"==typeof a&&(this.lexer=new Lexer("command_keywordLexer",a))}SupportedParser.prototype=new HeaderParser;SupportedParser.prototype.constructor=SupportedParser;SupportedParser.prototype.SUPPORTED="Supported";
SupportedParser.prototype.parse=function(){var a=new SupportedList;for(this.headerName(TokenTypes.prototype.SUPPORTED);"\n"!=this.lexer.lookAhead(0);){this.lexer.SPorHT();var b=new Supported;b.setHeaderName(this.SUPPORTED);this.lexer.match(TokenTypes.prototype.ID);var c=this.lexer.getNextToken();b.setOptionTag(c.getTokenValue());this.lexer.SPorHT();for(a.add(b);","==this.lexer.lookAhead(0);)this.lexer.match(","),this.lexer.SPorHT(),b=new Supported,this.lexer.match(TokenTypes.prototype.ID),c=this.lexer.getNextToken(),
b.setOptionTag(c.getTokenValue()),this.lexer.SPorHT(),a.add(b)}return a};function ServerParser(a){this.classname="ServerParser";"object"==typeof a?(this.lexer=a,this.lexer.selectLexer("command_keywordLexer")):"string"==typeof a&&(this.lexer=new Lexer("command_keywordLexer",a))}ServerParser.prototype=new HeaderParser;ServerParser.prototype.constructor=ServerParser;
ServerParser.prototype.parse=function(){var a=new Server;this.headerName(TokenTypes.prototype.SERVER);if("\n"==this.lexer.lookAhead(0))throw console.error("ServerParser:parse(): empty header"),"ServerParser:parse():  empty header";a.addProductToken(this.lexer.getRest().trim());return a};function SubjectParser(a){this.classname="SubjectParser";"object"==typeof a?(this.lexer=a,this.lexer.selectLexer("command_keywordLexer")):"string"==typeof a&&(this.lexer=new Lexer("command_keywordLexer",a))}
SubjectParser.prototype=new HeaderParser;SubjectParser.prototype.constructor=SubjectParser;SubjectParser.prototype.parse=function(){var a=new Subject;this.headerName(TokenTypes.prototype.SUBJECT);this.lexer.SPorHT();var b=this.lexer.getRest();a.setSubject(b.trim());return a};function MaxForwardsParser(a){this.classname="MaxForwardsParser";"object"==typeof a?(this.lexer=a,this.lexer.selectLexer("command_keywordLexer")):"string"==typeof a&&(this.lexer=new Lexer("command_keywordLexer",a))}
MaxForwardsParser.prototype=new HeaderParser;MaxForwardsParser.prototype.constructor=MaxForwardsParser;MaxForwardsParser.prototype.parse=function(){var a=new MaxForwards;this.headerName(TokenTypes.prototype.MAX_FORWARDS);var b=this.lexer.number();a.setMaxForwards(b);this.lexer.SPorHT();this.lexer.match("\n");return a};
function ReasonParser(a){this.classname="ReasonParser";"object"==typeof a?(this.lexer=a,this.lexer.selectLexer("command_keywordLexer")):"string"==typeof a&&(this.lexer=new Lexer("command_keywordLexer",a))}ReasonParser.prototype=new ParametersParser;ReasonParser.prototype.constructor=ReasonParser;
ReasonParser.prototype.parse=function(){var a=new ReasonList;this.headerName(TokenTypes.prototype.REASON);for(this.lexer.SPorHT();"\n"!=this.lexer.lookAhead(0);){var b=new Reason;this.lexer.match(TokenTypes.prototype.ID);var c=this.lexer.getNextToken().getTokenValue();b.setProtocol(c);ParametersParser.prototype.parse.call(this,b);a.add(b);","==this.lexer.lookAhead(0)&&this.lexer.match(",");this.lexer.SPorHT();return a}};
function RequestLineParser(a){this.classname="RequestLineParser";"string"==typeof a?this.lexer=new Lexer("method_keywordLexer",a):"object"==typeof a&&(this.lexer=a,this.lexer.selectLexer("method_keywordLexer"))}RequestLineParser.prototype=new Parser;RequestLineParser.prototype.constructor=RequestLineParser;
RequestLineParser.prototype.parse=function(){var a=new RequestLine,b=this.method();this.lexer.SPorHT();a.setMethod(b);this.lexer.selectLexer("sip_urlLexer");b=(new URLParser(this.getLexer())).uriReference(!0);this.lexer.SPorHT();a.setUri(b);this.lexer.selectLexer("request_lineLexer");b=this.sipVersion();a.setSipVersion(b);this.lexer.SPorHT();this.lexer.match("\n");return a};
function ExpiresParser(a){this.classname="ExpiresParser";"object"==typeof a?(this.lexer=a,this.lexer.selectLexer("command_keywordLexer")):"string"==typeof a&&(this.lexer=new Lexer("command_keywordLexer",a))}ExpiresParser.prototype=new HeaderParser;ExpiresParser.prototype.constructor=ExpiresParser;
ExpiresParser.prototype.parse=function(){var a=new Expires;this.lexer.match(TokenTypes.prototype.EXPIRES);this.lexer.SPorHT();this.lexer.match(":");this.lexer.SPorHT();var b=this.lexer.getNextId();this.lexer.match("\n");a.setExpires(b+0);return a};function EventParser(a){this.classname="EventParser";"object"==typeof a?(this.lexer=a,this.lexer.selectLexer("command_keywordLexer")):"string"==typeof a&&(this.lexer=new Lexer("command_keywordLexer",a))}EventParser.prototype=new ParametersParser;
EventParser.prototype.constructor=EventParser;EventParser.prototype.parse=function(){this.headerName(TokenTypes.prototype.EVENT);this.lexer.SPorHT();var a=new EventHeader(null);this.lexer.match(TokenTypes.prototype.ID);var b=this.lexer.getNextToken().getTokenValue();a.setEventType(b);ParametersParser.prototype.parse.call(this,a);this.lexer.SPorHT();this.lexer.match("\n");return a};
function StatusLineParser(a){this.classname="StatusLineParser";"string"==typeof a?this.lexer=new Lexer("status_lineLexer",a):"object"==typeof a&&(this.lexer=a,this.lexer.selectLexer("status_lineLexer"))}StatusLineParser.prototype=new Parser;StatusLineParser.prototype.constructor=StatusLineParser;StatusLineParser.prototype.statusCode=function(){return this.lexer.number()};StatusLineParser.prototype.reasonPhrase=function(){return this.lexer.getRest().trim()};
StatusLineParser.prototype.parse=function(){var a=new StatusLine,b=this.sipVersion();a.setSipVersion(b);this.lexer.SPorHT();b=this.statusCode();a.setStatusCode(b);this.lexer.SPorHT();b=this.reasonPhrase();a.setReasonPhrase(b);this.lexer.SPorHT();return a};function ContentDispositionParser(a){this.classname="ContentDispositionParser";"object"==typeof a?(this.lexer=a,this.lexer.selectLexer("command_keywordLexer")):"string"==typeof a&&(this.lexer=new Lexer("command_keywordLexer",a))}
ContentDispositionParser.prototype=new ParametersParser;ContentDispositionParser.prototype.constructor=ContentDispositionParser;ContentDispositionParser.prototype.CONTENT_DISPOSITION="Content-Disposition";
ContentDispositionParser.prototype.parse=function(){this.headerName(TokenTypes.prototype.CONTENT_DISPOSITION);var a=new ContentDisposition;a.setHeaderName(this.CONTENT_DISPOSITION);this.lexer.SPorHT();this.lexer.match(TokenTypes.prototype.ID);var b=this.lexer.getNextToken();a.setDispositionType(b.getTokenValue());this.lexer.SPorHT();ParametersParser.prototype.parse.call(this,a);this.lexer.SPorHT();this.lexer.match("\n");return a};
function AllowParser(a){this.classname="AllowParser";"object"==typeof a?(this.lexer=a,this.lexer.selectLexer("command_keywordLexer")):"string"==typeof a&&(this.lexer=new Lexer("command_keywordLexer",a))}AllowParser.prototype=new HeaderParser;AllowParser.prototype.constructor=AllowParser;AllowParser.prototype.ALLOW="Allow";
AllowParser.prototype.parse=function(){var a=new AllowList;this.headerName(TokenTypes.prototype.ALLOW);var b=new Allow;b.setHeaderName(this.ALLOW);this.lexer.SPorHT();this.lexer.match(TokenTypes.prototype.ID);var c=this.lexer.getNextToken();b.setMethod(c.getTokenValue());a.add(b);for(this.lexer.SPorHT();","==this.lexer.lookAhead(0);)this.lexer.match(","),this.lexer.SPorHT(),b=new Allow,this.lexer.match(TokenTypes.prototype.ID),c=this.lexer.getNextToken(),b.setMethod(c.getTokenValue()),a.add(b),this.lexer.SPorHT();
this.lexer.SPorHT();this.lexer.match("\n");return a};function AllowEventsParser(a){this.classname="AllowEventsParser";"object"==typeof a?(this.lexer=a,this.lexer.selectLexer("command_keywordLexer")):"string"==typeof a&&(this.lexer=new Lexer("command_keywordLexer",a))}AllowEventsParser.prototype=new HeaderParser;AllowEventsParser.prototype.constructor=AllowEventsParser;AllowEventsParser.prototype.ALLOW_EVENTS="Allow-Events";
AllowEventsParser.prototype.parse=function(){var a=new AllowEventsList;this.headerName(TokenTypes.prototype.ALLOW_EVENTS);var b=new AllowEvents;b.setHeaderName(this.ALLOW_EVENTS);this.lexer.SPorHT();this.lexer.match(TokenTypes.prototype.ID);var c=this.lexer.getNextToken();b.setEventType(c.getTokenValue());a.add(b);for(this.lexer.SPorHT();","==this.lexer.lookAhead(0);)this.lexer.match(","),this.lexer.SPorHT(),b=new AllowEvents,this.lexer.match(TokenTypes.prototype.ID),c=this.lexer.getNextToken(),b.setEventType(c.getTokenValue()),
a.add(b),this.lexer.SPorHT();this.lexer.SPorHT();this.lexer.match("\n");return a};
function ParserFactory(){this.classname="ParserFactory";this.parserTable=[];this.constructorArgs=null;this.parserConstructorCache=[];this.put(this.parserTable,"t",ToParser.prototype.constructor);this.put(this.parserTable,"to",ToParser.prototype.constructor);this.put(this.parserTable,"from",FromParser.prototype.constructor);this.put(this.parserTable,"f",FromParser.prototype.constructor);this.put(this.parserTable,"cseq",CSeqParser.prototype.constructor);this.put(this.parserTable,"via",ViaParser.prototype.constructor);
this.put(this.parserTable,"v",ViaParser.prototype.constructor);this.put(this.parserTable,"contact",ContactParser.prototype.constructor);this.put(this.parserTable,"m",ContactParser.prototype.constructor);this.put(this.parserTable,"content-type",ContentTypeParser.prototype.constructor);this.put(this.parserTable,"c",ContentTypeParser.prototype.constructor);this.put(this.parserTable,"content-length",ContentLengthParser.prototype.constructor);this.put(this.parserTable,"l",ContentLengthParser.prototype.constructor);
this.put(this.parserTable,"authorization",AuthorizationParser.prototype.constructor);this.put(this.parserTable,"www-authenticate",WWWAuthenticateParser.prototype.constructor);this.put(this.parserTable,"call-id",CallIDParser.prototype.constructor);this.put(this.parserTable,"i",CallIDParser.prototype.constructor);this.put(this.parserTable,"route",RouteParser.prototype.constructor);this.put(this.parserTable,"record-route",RecordRouteParser.prototype.constructor);this.put(this.parserTable,"proxy-authorization",
ProxyAuthorizationParser.prototype.constructor);this.put(this.parserTable,"proxy-authenticate",ProxyAuthenticateParser.prototype.constructor);this.put(this.parserTable,"timestamp",TimeStampParser.prototype.constructor);this.put(this.parserTable,"user-agent",UserAgentParser.prototype.constructor);this.put(this.parserTable,"supported",SupportedParser.prototype.constructor);this.put(this.parserTable,"k",SupportedParser.prototype.constructor);this.put(this.parserTable,"server",ServerParser.prototype.constructor);
this.put(this.parserTable,"subject",SubjectParser.prototype.constructor);this.put(this.parserTable,"s",SubjectParser.prototype.constructor);this.put(this.parserTable,"max-forwards",MaxForwardsParser.prototype.constructor);this.put(this.parserTable,"reason",ReasonParser.prototype.constructor);this.put(this.parserTable,"expires",ExpiresParser.prototype.constructor);this.put(this.parserTable,"event",EventParser.prototype.constructor);this.put(this.parserTable,"o",EventParser.prototype.constructor);this.put(this.parserTable,
"content-disposition",ContentDispositionParser.prototype.constructor);this.put(this.parserTable,"allow",AllowParser.prototype.constructor);this.put(this.parserTable,"allow-events",AllowEventsParser.prototype.constructor);this.put(this.parserTable,"u",AllowEventsParser.prototype.constructor);this.put(this.parserTable,"refer-to",ReferToParser.prototype.constructor);this.put(this.parserTable,"referred-by",ReferredByParser.prototype.constructor)}
ParserFactory.prototype.createParser=function(a){var b=new Lexer("",""),c=b.getHeaderName(a);b=b.getHeaderValue(a);if(null==c||null==b)throw console.error("ParserFactory:createParser(): the header name or value is null"),"ParserFactory:createParser(): the header name or value is null";b=null;c=c.toLowerCase();for(var d=0;d<this.parserTable.length;d++)this.parserTable[d][0]==c&&(b=this.parserTable[d][1]);if(null!=b){for(d=0;d<this.parserConstructorCache.length;d++)this.parserConstructorCache[d][0]==
b&&(b=this.parserConstructorCache[d][1]);c=new b;this.put(this.parserConstructorCache,b,c);return new b(a)}return new HeaderParser(a)};ParserFactory.prototype.put=function(a,b,c){for(var d=0,e=0;e<a.length;e++){var f=a[e][0];if(f==b){d=1;var g=[];g[0]=f;g[1]=c;a[e]=g}}0==d&&(g=[],g[0]=b,g[1]=c,a.push(g));return a};function WSMsgParser(a){this.classname="WSMsgParser";this.messageChannel=a}WSMsgParser.prototype.RPORT="rport";WSMsgParser.prototype.RECEIVED="received";
WSMsgParser.prototype.parsermessage=function(a){a=(new StringMsgParser).parseSIPMessage(a);var b=a.getContentLength();0==(null!=b?b.getContentLength():0)&&a.removeContent();console.info("SIP message received: "+a.encode());this.processMessage(a)};
WSMsgParser.prototype.processMessage=function(a){if(null!=a.getFrom()&&null!=a.getTo()&&null!=a.getCallId()&&null!=a.getCSeq()&&null!=a.getViaHeaders())if(a instanceof SIPRequest){var b=this.messageChannel.messageProcessor.sipStack.newSIPServerRequest(a,this.messageChannel);null!=b&&b.processRequest(a,this.messageChannel)}else{try{a.checkHeaders()}catch(c){console.error("WSMsgParser:processMessage(): catched exception:"+c);return}b=this.messageChannel.messageProcessor.sipStack.newSIPServerResponse(a,
this.messageChannel);null==b||b instanceof SIPClientTransaction&&!b.checkFromTag(a)||b.processResponse(a,this.messageChannel)}};function MessageObject(){this.classname="MessageObject"}MessageObject.prototype=new GenericObject;MessageObject.prototype.constructor=MessageObject;MessageObject.prototype.encode=function(){};function ListMap(){this.classname="ListMap";this.headerListTable=[];this.initialized=null;this.initializeListMap()}
ListMap.prototype.put=function(a,b,c){for(var d=0,e=0;e<a.length;e++)if(a[e][0].classname==b){d=1;var f=[];f[0]=b;f[1]=c;a[e]=f}0==d&&(d=a.length,f=[],f[0]=b,f[1]=c,a[d]=f)};
ListMap.prototype.initializeListMap=function(){this.put(this.headerListTable,"Contact",ContactList.prototype.constructor);this.put(this.headerListTable,"Via",ViaList.prototype.constructor);this.put(this.headerListTable,"WWW-Authenticate",WWWAuthenticateList.prototype.constructor);this.put(this.headerListTable,"Route",RouteList.prototype.constructor);this.put(this.headerListTable,"Proxy-Authenticate",ProxyAuthenticateList.prototype.constructor);this.put(this.headerListTable,"Allow",AllowList.prototype.constructor);
this.put(this.headerListTable,"Record-Route",RecordRouteList.prototype.constructor);this.put(this.headerListTable,"Supported",SupportedList.prototype.constructor);this.initialized=!0};ListMap.prototype.hasList=function(a){this.initialized||initializeListMap();if("object"==typeof a){if(a instanceof SIPHeaderList)return!1;a=a.classname;var b=null}else b=null;for(var c=0;c<this.headerListTable.length;c++)this.headerListTable[c][0]==a&&(b=this.headerListTable[c][1]);return null!=b?!0:!1};
ListMap.prototype.getListClass=function(a){this.initialized||initializeListMap();for(var b=null,c=0;c<this.headerListTable.length;c++)this.headerListTable[c][0]==a&&(b=this.headerListTable[c][1]);return b};ListMap.prototype.getList=function(a){this.initialized||initializeListMap();for(var b=a.headerName,c=null,d=0;d<this.headerListTable.length;d++)this.headerListTable[d][0]==b&&(c=this.headerListTable[d][1]);return null!=c?(b=new c,b.setHeaderName(a.getName()),b):null};
function SIPMessage(){this.classname="SIPMessage";this.contentEncodingCharset=(new MessageFactoryImpl).getDefaultContentEncodingCharset();this.nullRequest=null;this.unrecognizedHeaders=[];this.headers=[];this.fromHeader=new From;this.toHeader=new To;this.cSeqHeader=new CSeq;this.callIdHeader=new CallID;this.contentLengthHeader=new ContentDisposition;this.maxForwardsHeader=new MaxForwards;this.messageContent=this.size=null;this.nameTable=[];this.applicationData=null;var a=new ContentLength(0);this.stackTransaction=
null;this.attachHeader(a,!1)}SIPMessage.prototype=new MessageObject;SIPMessage.prototype.constructor=SIPMessage;SIPMessage.prototype.NEWLINE="\r\n";SIPMessage.prototype.ViaHeader="Via";SIPMessage.prototype.BRANCH_MAGIC_COOKIE_UPPER_CASE="Z9HG4BK";SIPMessage.prototype.CANCEL="CANCEL";SIPMessage.prototype.CONTENT_TYPE_LOWERCASE="content-type";SIPMessage.prototype.AUTHORIZATION_LOWERCASE="authorization";SIPMessage.prototype.PROXYAUTHORIZATION_LOWERCASE="proxy-authorization";
SIPMessage.prototype.CONTACT_LOWERCASE="contact";SIPMessage.prototype.VIA_LOWERCASE="via";SIPMessage.prototype.ROUTE_LOWERCASE="route";SIPMessage.prototype.RECORDROUTE_LOWERCASE="record-route";SIPMessage.prototype.CONTENT_DISPOSITION_LOWERCASE="content-disposition";SIPMessage.prototype.EXPIRES_LOWERCASE="expires";SIPMessage.prototype.listMap=new ListMap;
SIPMessage.prototype.isRequestHeader=function(a){return a instanceof Authorization||a instanceof MaxForwards||a instanceof UserAgent||a instanceof ProxyAuthorization||a instanceof Route||a instanceof RouteList||a instanceof Subject?!0:!1};SIPMessage.prototype.isResponseHeader=function(a){return a instanceof WWWAuthenticate||a instanceof ProxyAuthenticate?!0:!1};
SIPMessage.prototype.getMessageAsEncodedStrings=function(){for(var a=[],b=0;b<this.headers.length;b++){var c=this.headers[b];if(c instanceof SIPHeaderList)for(var d=0;d<c.getHeadersAsEncodedStrings().length;d++)a[a.length]=c.getHeadersAsEncodedStrings()[d];else a[a.length]=c.encode()}return a};
SIPMessage.prototype.encodeSIPHeaders=function(){for(var a="",b=0;b<this.headers.length;b++){var c=this.headers[b];c instanceof ContentLength||(a+=c.encodeBuffer(""))}return a=(a+this.contentLengthHeader.encodeBuffer("")+this.NEWLINE).toString()};SIPMessage.prototype.encodeMessage=function(){};SIPMessage.prototype.getDialogId=function(a){};
SIPMessage.prototype.encode=function(){for(var a="",b=0;b<this.headers.length;b++){var c=this.headers[b];c instanceof ContentLength||(a+=c.encode())}for(b=0;b<this.unrecognizedHeaders.length;b++)a=a+this.unrecognizedHeaders[b]+this.NEWLINE;a=a+this.contentLengthHeader.encode()+this.NEWLINE;null!=this.messageContent&&(a+=this.messageContent);return a.toString()};
SIPMessage.prototype.encodeAsBytes=function(a){if(this instanceof SIPRequest&&this.isNullRequest())return this.getBytes("\r\n\r\n");this.getHeader(this.ViaHeader).setTransport(a);a="";for(var b=0;b<this.headers.length;b++){var c=this.headers[b];c instanceof ContentLength||c.encode(a)}this.contentLengthHeader.encode(a);a+=this.NEWLINE;b=this.getRawContent();return null!=b?this.getBytes(a.toString()).concat(b):this.getBytes(a.toString())};
SIPMessage.prototype.attachHeader=function(){if(1==arguments.length){var a=arguments[0];this.attachHeaderargu1(a)}else if(2==arguments.length){a=arguments[0];var b=arguments[1];this.attachHeaderargu2(a,b)}else 3==arguments.length&&(a=arguments[0],b=arguments[1],this.attachHeaderargu3(a,b,arguments[2]))};
SIPMessage.prototype.attachHeaderargu1=function(a){if(null==a)throw console.error("MessageFactoryImpl:attachHeaderargu1(): null header!"),"MessageFactoryImpl:attachHeaderargu1(): null header!";a instanceof SIPHeaderList&&0==a.hlist.length||this.attachHeaderargu3(a,!1,!1)};SIPMessage.prototype.attachHeaderargu2=function(a,b){this.attachHeaderargu3(a,b,!1)};
SIPMessage.prototype.attachHeaderargu3=function(a,b,c){if(null==a)throw console.error("MessageFactoryImpl:attachHeaderargu3(): null header!"),"MessageFactoryImpl:attachHeaderargu3(): null header!";if(!SIPMessage.prototype.listMap.hasList(a)||a instanceof SIPHeaderList)var d=a;else d=SIPMessage.prototype.listMap.getList(a),d.add(a);for(var e=d.getName().toLowerCase(),f=null,g=0;g<this.nameTable.length;g++)this.nameTable[g][0]==e&&(f=g);if(b)null!=f&&this.nameTable.splice(f,1);else if(null!=f&&!(d instanceof
SIPHeaderList)){d instanceof ContentLength&&this.contentLengthHeader.setContentLength(d.getContentLength());return}a=this.getHeader(a.getName());if(null!=a){b=this.headers;var h=0;for(g=0;g<this.headers.length;g++){var k=this.headers[g];k!=a&&(b[h]=k,h+=1)}this.headers=b}null==f?(c=[],c[0]=e,c[1]=d,this.nameTable.push(c),this.headers.push(d)):d instanceof SIPHeaderList?(f=this.nameTable[f][1],null!=f?f.concatenate(d,c):(c=[],c[0]=e,c[1]=d,this.nameTable.push(c))):(c=[],c[0]=e,c[1]=d,this.nameTable.push(c));
d instanceof From?this.fromHeader=d:d instanceof ContentLength?this.contentLengthHeader=d:d instanceof To?this.toHeader=d:d instanceof CSeq?this.cSeqHeader=d:d instanceof CallID?this.callIdHeader=d:d instanceof MaxForwards&&(this.maxForwardsHeader=d)};
SIPMessage.prototype.setHeader=function(a){if(null==a)throw console.error("MessageFactoryImpl:setHeader(): null header!"),"MessageFactoryImpl:setHeader(): null header!";a instanceof SIPHeaderList&&0==a.hlist.length||(this.removeHeader(a.getHeaderName()),this.attachHeader(a,!0,!1))};SIPMessage.prototype.setHeaders=function(a){for(var b=0;b<a.length;b++)this.attachHeader(a[b],!1)};
SIPMessage.prototype.removeHeader=function(){if(1==arguments.length){var a=arguments[0];this.removeHeaderargu1(a)}else 2==arguments.length&&(a=arguments[0],this.removeHeaderargu2(a,arguments[1]))};
SIPMessage.prototype.removeHeaderargu1=function(a){if(null==a)throw console.error("MessageFactoryImpl:removeHeaderargu1(): null header!"),"MessageFactoryImpl:removeHeaderargu1(): null header!";a=a.toLowerCase();for(var b=null,c=null,d=0;d<this.nameTable.length;d++)this.nameTable[d][0]==a&&(c=d,b=this.nameTable[d][0]);if(null!=b){this.nameTable.splice(c,1);b instanceof From?this.fromHeader=null:b instanceof To?this.toHeader=null:b instanceof CSeq?this.cSeqHeader=null:b instanceof CallID?this.callIdHeader=
null:b instanceof MaxForwards?this.maxForwardsHeader=null:b instanceof ContentLength&&(this.contentLengthHeader=null);for(d=0;d<this.headers.length;d++)this.headers[d].getName().toLowerCase()==a&&(c=d);this.headers.splice(c,1)}};
SIPMessage.prototype.removeHeaderargu2=function(a,b){a=a.toLowerCase();for(var c=null,d=null,e=null,f=0;f<this.nameTable.length;f++)this.nameTable[f][0]==a&&(d=f,c=this.nameTable[f][1]);if(null!=c&&c instanceof SIPHeaderList){b?c.removeFirst():c.removeLast();if(0==c.hlist.length)for(f=0;f<this.headers.length;f++)this.headers[f].getName().toLowerCase()==a&&(e=f);this.nameTable.splice(d,1);this.headers.splice(e,1)}};
SIPMessage.prototype.getTransactionId=function(){var a=new Via;0!=this.getViaHeaders().hlist.length&&(a=this.getViaHeaders().getFirst());if(null!=a&&null!=a.getBranch()&&a.getBranch().toUpperCase().substr(0,7)==this.BRANCH_MAGIC_COOKIE_UPPER_CASE)return this.getCSeq().getMethod()==this.CANCEL?(a.getBranch()+":"+this.getCSeq().getMethod()).toLowerCase():a.getBranch().toLowerCase();var b="",c=this.getFrom();this.getTo();c.hasTag()&&(b=b+c.getTag()+"-");c=this.callIdHeader.getCallId();b=b+c+"-"+this.cSeqHeader.getSequenceNumber()+
"-"+this.cSeqHeader.getMethod();null!=a&&(b=b+"-"+a.getSentBy().encode(),a.getSentBy().hasPort()||(b+="-5060"));this.getCSeq().getMethod()==this.CANCEL&&(b+=this.CANCEL);return b=b.toString().toLowerCase().replace(":","-").replace("@","-")+Utils.prototype.getSignature()};
SIPMessage.prototype.hashCode=function(){if(null==this.callIdHeader)throw console.error("MessageFactoryImpl:hashCode(): invalid message! Cannot compute hashcode! call-id header is missing !"),"MessageFactoryImpl:hashCode(): invalid message! Cannot compute hashcode! call-id header is missing !";var a=0,b=this.callIdHeader.getCallId();if(null!=b&&""!=b.value)for(var c=0;c<b.length;c++)if(a=31*a+b.charCodeAt(c),2147483647<a||-2147483648>a)a&=4294967295;return a};
SIPMessage.prototype.hasContent=function(){return null!=this.messageContent};
SIPMessage.prototype.getHeaders=function(){if(0!=arguments.length){var a=arguments[0];if(null==a)throw console.error("MessageFactoryImpl:getHeaders(): headerName header!"),"MessageFactoryImpl:getHeaders(): null headerName!";for(var b=null,c=0;c<this.nameTable.length;c++)this.nameTable[c][0]==a.toLowerCase()&&(b=this.nameTable[c][1]);return null==b?(new SIPHeaderList).listIterator():b instanceof SIPHeaderList?b.listIterator():new HeaderIterator(this,b)}return this.headers};
SIPMessage.prototype.getHeader=function(a){return this.getHeaderLowerCase(a.toLowerCase())};SIPMessage.prototype.getHeaderLowerCase=function(a){if(null==a)throw console.error("MessageFactoryImpl:getHeaderLowerCase(): null lowerCaseHeaderName !"),"MessageFactoryImpl:getHeaderLowerCase(): null lowerCaseHeaderName!";for(var b=null,c=0;c<this.nameTable.length;c++)this.nameTable[c][0]==a&&(b=this.nameTable[c][1]);return b instanceof SIPHeaderList?b.getFirst():b};
SIPMessage.prototype.getContentTypeHeader=function(){return this.getHeaderLowerCase(this.CONTENT_TYPE_LOWERCASE)};SIPMessage.prototype.getWWWAuthenticate=function(){return this.getHeaderLowerCase("www-authenticate")};SIPMessage.prototype.getProxyAuthenticate=function(){return this.getHeaderLowerCase("proxy-authenticate")};SIPMessage.prototype.getContentLengthHeader=function(){return this.getContentLength()};SIPMessage.prototype.getFrom=function(){return this.fromHeader};
SIPMessage.prototype.getContactHeaders=function(){return this.getSIPHeaderListLowerCase(this.CONTACT_LOWERCASE)};SIPMessage.prototype.getContactHeader=function(){var a=this.getContactHeaders();return null!=a?a.getFirst():null};SIPMessage.prototype.getViaHeaders=function(){return this.getSIPHeaderListLowerCase(this.VIA_LOWERCASE)};SIPMessage.prototype.setVia=function(a){if("Via"==a.classname){var b=new ViaList;b.add(a)}else{b=new ViaList;for(var c=0;c<a.hlist.length;c++)b.add(a.hlist[c])}this.setHeader(b)};
SIPMessage.prototype.getTopmostVia=function(){return null==this.getViaHeaders()?null:this.getViaHeaders().getFirst()};SIPMessage.prototype.getCSeq=function(){return this.cSeqHeader};SIPMessage.prototype.getAuthorization=function(){return this.getHeaderLowerCase(this.AUTHORIZATION_LOWERCASE)};SIPMessage.prototype.getProxyAuthorization=function(){return this.getHeaderLowerCase(this.PROXYAUTHORIZATION_LOWERCASE)};SIPMessage.prototype.getMaxForwards=function(){return this.maxForwardsHeader};
SIPMessage.prototype.setMaxForwards=function(a){this.setHeader(a)};SIPMessage.prototype.getRouteHeaders=function(){return this.getSIPHeaderListLowerCase(this.ROUTE_LOWERCASE)};SIPMessage.prototype.getCallId=function(){return this.callIdHeader};SIPMessage.prototype.setCallId=function(a){"object"==typeof a?this.setHeader(a):"string"==typeof a&&(null==this.callIdHeader&&this.setHeader(new CallID),this.callIdHeader.setCallId(a))};SIPMessage.prototype.getRecordRouteHeaders=function(){return this.getSIPHeaderListLowerCase(this.RECORDROUTE_LOWERCASE)};
SIPMessage.prototype.getTo=function(){return this.toHeader};SIPMessage.prototype.setTo=function(a){this.setHeader(a)};SIPMessage.prototype.setFrom=function(a){this.setHeader(a)};SIPMessage.prototype.getContentLength=function(){return this.contentLengthHeader};SIPMessage.prototype.getMessageContent=function(){return this.messageContent};SIPMessage.prototype.getRawContent=function(){return this.messageContent};
SIPMessage.prototype.setMessageContent=function(){if(1==arguments.length){var a=arguments[0];this.computeContentLength(a);this.messageContent=a}else if(3==arguments.length){a=arguments[2];var b=new ContentType(arguments[0],arguments[1]);this.setHeader(b);this.messageContent=a;this.computeContentLength(a)}else if(4==arguments.length){a=arguments[0];b=arguments[1];var c=arguments[2],d=arguments[3];this.computeContentLength(a);if(!c&&(!b&&this.contentLengthHeader.getContentLength()!=d||this.contentLengthHeader.getContentLength()<
d))throw console.error("MessageFactoryImpl:setMessageContent(): invalid content length "+this.contentLengthHeader.getContentLength()+" / "+d,0),"MessageFactoryImpl:setMessageContent(): invalid content length "+this.contentLengthHeader.getContentLength()+" / "+d;this.messageContent=a}};
SIPMessage.prototype.setContent=function(a,b){if(null==a)throw console.error("MessageFactoryImpl:setContent(): null content !",0),"MessageFactoryImpl:setContent(): null content!";this.setHeader(b);this.messageContent=a;this.computeContentLength(a)};SIPMessage.prototype.getContent=function(){return null!=this.messageContent?this.messageContent:null};
SIPMessage.prototype.computeContentLength=function(a){var b=0;if(null!=a)if("String"==a.constructor.name){b=0;for(var c,d=0;d<a.length;++d)c=a.charCodeAt(d),b=128>c?b+1:2048>c?b+2:65536>c?b+3:b+4}else b=a.constructor==Array?a.length:a.toString().length;this.contentLengthHeader.setContentLength(b)};SIPMessage.prototype.removeContent=function(){this.messageContent=null;this.contentLengthHeader.setContentLength(0)};
SIPMessage.prototype.getHeaderAsFormattedString=function(a){for(var b=a.toLowerCase(),c=null,d=0;d<this.nameTable.length;d++)this.nameTable[d][0]==b&&(c=d);return null!=c?this.nameTable[c][1].toString():this.getHeader(a).toString()};SIPMessage.prototype.getSIPHeaderListLowerCase=function(a){for(var b=null,c=0;c<this.nameTable.length;c++)this.nameTable[c][0]==a&&(b=c);return null!=b?this.nameTable[b][1]:null};
SIPMessage.prototype.getHeaderList=function(a){for(var b=null,c=0;c<this.nameTable.length;c++)this.nameTable[c][0]==a.toLowerCase()&&(b=c);a=this.nameTable[b][1];if(null==a)return null;if(a instanceof SIPHeaderList)return a.getHeaderList();b=[];b.push(a);return b};SIPMessage.prototype.hasHeader=function(a){for(var b=null,c=0;c<this.nameTable.length;c++)this.nameTable[c][0]==a.toLowerCase()&&(b=c);return null!=b?!0:!1};
SIPMessage.prototype.hasFromTag=function(){return null!=this.fromHeader&&null!=this.fromHeader.getTag()};SIPMessage.prototype.hasToTag=function(){return null!=this.toHeader&&null!=this.toHeader.getTag()};SIPMessage.prototype.getFromTag=function(){return null==this.fromHeader?null:this.fromHeader.getTag()};SIPMessage.prototype.setFromTag=function(a){this.fromHeader.setTag(a)};SIPMessage.prototype.setToTag=function(a){this.toHeader.setTag(a)};
SIPMessage.prototype.getToTag=function(){return null==this.toHeader?null:this.toHeader.getTag()};SIPMessage.prototype.getFirstLine=function(){};
SIPMessage.prototype.addHeader=function(a){if("object"!=typeof a){var b=a.trim()+"\n";try{var c=(new ParserFactory).createParser(a).parse();this.attachHeader(c,!1)}catch(d){console.error("SIPMessage:addHeader(): catched exception:"+d),this.unrecognizedHeaders.push(b)}}else try{a instanceof ViaList||a instanceof RecordRouteList?this.attachHeader(a,!1,!0):this.attachHeader(a,!1,!1)}catch(d){console.error("SIPMessage:addHeader(): catched exception:"+d),a instanceof ContentLength&&this.contentLengthHeader.setContentLength(a.getContentLength())}};
SIPMessage.prototype.addUnparsed=function(a){this.unrecognizedHeaders.push(a)};SIPMessage.prototype.getUnrecognizedHeaders=function(){return this.unrecognizedHeaders};SIPMessage.prototype.getHeaderNames=function(){for(var a=[],b=0;b<this.headers.length;b++){var c=this.headers[b].getName();a.push(c)}return a};SIPMessage.prototype.getContentDisposition=function(){return this.getHeaderLowerCase(this.CONTENT_DISPOSITION_LOWERCASE)};SIPMessage.prototype.getExpires=function(){return this.getHeaderLowerCase(this.EXPIRES_LOWERCASE)};
SIPMessage.prototype.setExpires=function(a){this.setHeader(a)};SIPMessage.prototype.setContentDisposition=function(a){this.setHeader(a)};SIPMessage.prototype.setContentLength=function(a){this.contentLengthHeader.setContentLength(a.getContentLength())};SIPMessage.prototype.setSize=function(a){this.size=a};SIPMessage.prototype.getSize=function(){return this.size};
SIPMessage.prototype.addLast=function(a){if(null==a)throw console.error("SIPMessage:addLast(): null header arg!"),"SIPMessage:addLast(): null header arg!";this.attachHeader(a,!1,!1)};SIPMessage.prototype.addFirst=function(a){if(null==a)throw console.error("SIPMessage:addFirst(): null header arg!"),"SIPMessage:addFirst(): null header arg!";this.attachHeader(a,!1,!0)};
SIPMessage.prototype.removeFirst=function(a){if(null==a)throw console.error("SIPMessage:removeFirst(): null headerName arg!"),"SIPMessage:removeFirst(): null headerName arg!";this.removeHeader(a,!0)};SIPMessage.prototype.removeLast=function(a){if(null==a)throw console.error("SIPMessage:removeLast(): null headerName arg!"),"SIPMessage:removeLast(): null headerName arg!";this.removeHeader(a,!1)};SIPMessage.prototype.setCSeq=function(a){this.setHeader(a)};
SIPMessage.prototype.setApplicationData=function(a){this.applicationData=a};SIPMessage.prototype.getApplicationData=function(){return this.applicationData};SIPMessage.prototype.getMultipartMimeContent=function(){var a=new MultipartMimeContentImpl(this.getContentTypeHeader()),b=this.getRawContent();b=new String(b);a.createContentList(b);return a};SIPMessage.prototype.getCallIdHeader=function(){return this.callIdHeader};SIPMessage.prototype.getFromHeader=function(){return this.fromHeader};
SIPMessage.prototype.getToHeader=function(){return this.toHeader};SIPMessage.prototype.getTopmostViaHeader=function(){return this.getTopmostVia()};SIPMessage.prototype.getCSeqHeader=function(){return this.cSeqHeader};SIPMessage.prototype.getCharset=function(){var a=this.getContentTypeHeader();return null!=a?(a=a.getCharset(),null!=a?a:this.contentEncodingCharset):this.contentEncodingCharset};SIPMessage.prototype.isNullRequest=function(){return this.nullRequest};
SIPMessage.prototype.setNullRequest=function(){this.nullRequest=!0};SIPMessage.prototype.setSIPVersion=function(){};SIPMessage.prototype.getSIPVersion=function(){};SIPMessage.prototype.toString=function(){};SIPMessage.prototype.getBytes=function(a){var b=[];a=new String(a);for(var c=0;c<a.length;c++)b[c]=a.charCodeAt(c);return b};SIPMessage.prototype.getStackTransaction=function(){return this.stackTransaction};SIPMessage.prototype.setStackTransaction=function(a){this.stackTransaction=a};
SIPMessage.prototype.addViaHeaderList=function(a){for(var b=[],c=0,d=0;d<this.headers.length;d++)if(b[c]=this.headers[d],c+=1,this.headers[d]instanceof ViaList&&(d!=this.headers.length-1&&this.headers[d]instanceof ViaList||(b[c]=a,c+=1),!(this.headers[d-1]instanceof ViaList)&&0!=d)){var e=[];e[0]=this.headers[d].getName().toLowerCase();e[1]=this.headers[d];this.nameTable.push(e)}c==d&&(b[c]=a,e=[],e[0]=a.getName().toLowerCase(),e[1]=a,this.nameTable.push(e));this.headers=b};
function MessageFactoryImpl(){this.classname="MessageFactoryImpl";this.defaultContentEncodingCharset="UTF-8";this.server=this.userAgent=null}MessageFactoryImpl.prototype.CONTENTTYPEHEADER="Content-Type";
MessageFactoryImpl.prototype.createRequest=function(){if(1==arguments.length)return this.createRequestPrototype3(arguments[0]);if(8==arguments.length){var a=arguments[0],b=arguments[1],c=arguments[2],d=arguments[3],e=arguments[4],f=arguments[5],g=arguments[6],h=arguments[7];return this.createRequestPrototype1(a,b,c,d,e,f,g,h)}if(10==arguments.length&&"ContentType"==arguments[8].classname)return a=arguments[0],b=arguments[1],c=arguments[2],d=arguments[3],e=arguments[4],f=arguments[5],g=arguments[6],
h=arguments[7],this.createRequestPrototype2(a,b,c,d,e,f,g,h,arguments[8],arguments[9])};
MessageFactoryImpl.prototype.createRequestPrototype1=function(a,b,c,d,e,f,g,h){if(null==a||null==b||null==c||null==d||null==e||null==f||null==g||null==h)throw console.error("MessageFactoryImpl:createRequestPrototype1(): some parameters are missing, unable to create the request"),"MessageFactoryImpl:createRequestPrototype1(): some parameters are missing, unable to create the request";var k=new SIPRequest;k.setRequestURI(a);k.setMethod(b);k.setCallId(c);k.setCSeq(d);k.setFrom(e);k.setTo(f);k.setVia(g);
k.setMaxForwards(h);null!=this.userAgent&&k.setHeader(this.userAgent);return k};
MessageFactoryImpl.prototype.createRequestPrototype2=function(a,b,c,d,e,f,g,h,k,l){if(null==a||null==b||null==c||null==d||null==e||null==f||null==g||null==h||null==l||null==k)throw console.error("MessageFactoryImpl:createRequestPrototype2(): some parameters are missing, unable to create the request"),"MessageFactoryImpl:createRequestPrototype2(): some parameters are missing, unable to create the request";var m=new SIPRequest;m.setRequestURI(a);m.setMethod(b);m.setCallId(c);m.setCSeq(d);m.setFrom(e);
m.setTo(f);m.setVia(g);m.setMaxForwards(h);m.setContent(l,k);null!=this.userAgent&&m.setHeader(this.userAgent);return m};
MessageFactoryImpl.prototype.createRequestPrototype3=function(a){if(null==a||a.equals(""))return a=new SIPRequest,a.setNullRequest(),a;var b=new StringMsgParser;b.setStrict(this.strict);a=b.parseSIPMessage(a);if(!(a instanceof SIPRequest))throw console.error("MessageFactoryImpl:createRequestPrototype3(): parsing error"),"MessageFactoryImpl:createRequestPrototype3(): parsing error";return a};
MessageFactoryImpl.prototype.createResponse=function(){if(1==arguments.length)return this.createReponsePrototype9(arguments[0]);if(2==arguments.length){var a=arguments[0],b=arguments[1];return this.createReponsePrototype6(a,b)}if(4==arguments.length){if(arguments[3].constructor!=Array){a=arguments[0];b=arguments[1];var c=arguments[2],d=arguments[3];return this.createReponsePrototype4(a,b,c,d)}if(arguments[3].constructor==Array)return a=arguments[0],b=arguments[1],c=arguments[2],d=arguments[3],this.createReponsePrototype5(a,
b,c,d)}else{if(7==arguments.length){a=arguments[0];b=arguments[1];var e=arguments[2],f=arguments[3],g=arguments[4],h=arguments[5],k=arguments[6];return this.createReponsePrototype3(a,b,e,f,g,h,k)}if(9==arguments.length)if("ContentType"==arguments[8].classname){if(arguments[7].constructor!=Array)return a=arguments[0],b=arguments[1],e=arguments[2],f=arguments[3],g=arguments[4],h=arguments[5],k=arguments[6],d=arguments[7],c=arguments[8],this.createReponsePrototype1(a,b,e,f,g,h,k,d,c);if(arguments[7].constructor==
Array)return a=arguments[0],b=arguments[1],e=arguments[2],f=arguments[3],g=arguments[4],h=arguments[5],k=arguments[6],d=arguments[7],c=arguments[8],this.createReponsePrototype2(a,b,e,f,g,h,k,d,c)}else if("ContentType"!=arguments[8].classname){if(arguments[7].constructor!=Array)return a=arguments[0],b=arguments[1],e=arguments[2],f=arguments[3],g=arguments[4],h=arguments[5],k=arguments[6],c=arguments[7],d=arguments[8],this.createReponsePrototype7(a,b,e,f,g,h,k,c,d);if(arguments[7].constructor==Array)return a=
arguments[0],b=arguments[1],e=arguments[2],f=arguments[3],g=arguments[4],h=arguments[5],k=arguments[6],c=arguments[7],d=arguments[8],this.createReponsePrototype8(a,b,e,f,g,h,k,c,d)}}};
MessageFactoryImpl.prototype.createReponsePrototype1=function(a,b,c,d,e,f,g,h,k){if(null==b||null==c||null==d||null==e||null==f||null==g||null==h||null==k)throw console.error("MessageFactoryImpl:createReponsePrototype1(): some parameters are missing, unable to create the response"),"MessageFactoryImpl:createReponsePrototype1(): some parameters are missing, unable to create the response";var l=new SIPResponse,m=new StatusLine;m.setStatusCode(a);a=l.getReasonPhrase(a);m.setReasonPhrase(a);l.setStatusLine(m);
l.setCallId(b);l.setCSeq(c);l.setFrom(d);l.setTo(e);l.setVia(f);l.setMaxForwards(g);l.setContent(h,k);null!=this.userAgent&&l.setHeader(this.userAgent);return l};
MessageFactoryImpl.prototype.createReponsePrototype2=function(a,b,c,d,e,f,g,h,k){if(null==b||null==c||null==d||null==e||null==f||null==g||null==h||null==k)throw console.error("MessageFactoryImpl:createReponsePrototype2(): some parameters are missing, unable to create the response"),"MessageFactoryImpl:createReponsePrototype2(): some parameters are missing, unable to create the response";var l=new SIPResponse;l.setStatusCode(a);l.setCallId(b);l.setCSeq(c);l.setFrom(d);l.setTo(e);l.setVia(f);l.setMaxForwards(g);
l.setHeader(k);l.setMessageContent(h);null!=this.userAgent&&l.setHeader(this.userAgent);return l};
MessageFactoryImpl.prototype.createReponsePrototype3=function(a,b,c,d,e,f,g){if(null==b||null==c||null==d||null==e||null==f||null==g)throw console.error("MessageFactoryImpl:createReponsePrototype3(): some parameters are missing, unable to create the response"),"MessageFactoryImpl:createReponsePrototype3(): some parameters are missing, unable to create the response";var h=new SIPResponse;h.setStatusCode(a);h.setCallId(b);h.setCSeq(c);h.setFrom(d);h.setTo(e);h.setVia(f);h.setMaxForwards(g);null!=this.userAgent&&
h.setHeader(this.userAgent);return h};MessageFactoryImpl.prototype.createReponsePrototype4=function(a,b,c,d){if(null==b||null==d||null==c)throw console.error("MessageFactoryImpl:createReponsePrototype4(): some parameters are missing, unable to create the response"),"MessageFactoryImpl:createReponsePrototype4(): some parameters are missing, unable to create the response";a=b.createResponse(a);a.setContent(d,c);null!=this.server&&a.setHeader(this.server);return a};
MessageFactoryImpl.prototype.createReponsePrototype5=function(a,b,c,d){if(null==b||null==d||null==c)throw console.error("MessageFactoryImpl:createReponsePrototype5(): some parameters are missing, unable to create the response"),"MessageFactoryImpl:createReponsePrototype5(): some parameters are missing, unable to create the response";a=b.createResponse(a);a.setHeader(c);a.setMessageContent(d);null!=this.server&&a.setHeader(this.server);return a};
MessageFactoryImpl.prototype.createReponsePrototype6=function(a,b){if(null==b)throw console.error("MessageFactoryImpl:createReponsePrototype6(): some parameters are missing, unable to create the response"),"MessageFactoryImpl:createReponsePrototype6(): ome parameters are missing, unable to create the response";a=b.createResponse(a);a.removeContent();a.removeHeader(this.CONTENTTYPEHEADER);null!=this.server&&a.setHeader(this.server);return a};
MessageFactoryImpl.prototype.createReponsePrototype7=function(a,b,c,d,e,f,g,h,k){if(null==b||null==c||null==d||null==e||null==f||null==g||null==k||null==h)throw console.error("MessageFactoryImpl:createReponsePrototype7(): some parameters are missing, unable to create the response"),"MessageFactoryImpl:createReponsePrototype7(): some parameters are missing, unable to create the response";g=new SIPResponse;var l=new StatusLine;l.setStatusCode(a);var m=g.getReasonPhrase(a);if(null==m)throw console.error("MessageFactoryImpl:createReponsePrototype7(): unknown statusCode "+
a),"MessageFactoryImpl:createReponsePrototype7(): unknown statusCode "+a;l.setReasonPhrase(m);g.setStatusLine(l);g.setCallId(b);g.setCSeq(c);g.setFrom(d);g.setTo(e);g.setVia(f);g.setContent(k,h);null!=this.userAgent&&g.setHeader(this.userAgent);return g};
MessageFactoryImpl.prototype.createReponsePrototype8=function(a,b,c,d,e,f,g,h,k){if(null==b||null==c||null==d||null==e||null==f||null==g||null==k||null==h)throw console.error("MessageFactoryImpl:createReponsePrototype8(): some parameters are missing, unable to create the response"),"MessageFactoryImpl:createReponsePrototype8(): some parameters are missing, unable to create the response";g=new SIPResponse;var l=new StatusLine;l.setStatusCode(a);var m=g.getReasonPhrase(a);if(null==m)throw console.error("MessageFactoryImpl:createReponsePrototype8(): unknown statusCode "+
a),"MessageFactoryImpl:createReponsePrototype8(): unknown statusCode "+a;l.setReasonPhrase(m);g.setStatusLine(l);g.setCallId(b);g.setCSeq(c);g.setFrom(d);g.setTo(e);g.setVia(f);g.setContent(k,h);null!=this.userAgent&&g.setHeader(this.userAgent);return g};
MessageFactoryImpl.prototype.createReponsePrototype9=function(a){if(null==a)return new SIPResponse;a=(new StringMsgParser).parseSIPMessage(a);if(!(a instanceof SIPResponse))throw console.error("MessageFactoryImpl:createReponsePrototype9(): parse error"),"MessageFactoryImpl:createReponsePrototype9(): parse error";return a};MessageFactoryImpl.prototype.setDefaultUserAgentHeader=function(a){this.userAgent=a};MessageFactoryImpl.prototype.setDefaultServerHeader=function(a){this.server=a};
MessageFactoryImpl.prototype.getDefaultUserAgentHeader=function(){return this.userAgent};MessageFactoryImpl.prototype.getDefaultServerHeader=function(){return this.server};MessageFactoryImpl.prototype.setDefaultContentEncodingCharset=function(a){if(null==a)throw new NullPointerException("Null argument!");this.defaultContentEncodingCharset=a};MessageFactoryImpl.prototype.getDefaultContentEncodingCharset=function(){return this.defaultContentEncodingCharset};
MessageFactoryImpl.prototype.createMultipartMimeContent=function(a,b,c,d){var e=a.getParameter("boundary");a=new MultipartMimeContentImpl(a);for(var f=0;f<b.length;f++){var g=new ContentType(b[f],c[f]),h=new ContentImpl(d[f],e);h.setContentTypeHeader(g);a.add(h)}return a};MessageFactoryImpl.prototype.getBytes=function(a){var b=[];a=new String(a);for(var c=0;c<a.length;c++)b[c]=a.charCodeAt(c);return b};MessageFactoryImpl.prototype.addHeader=function(a,b){a.addHeader(b);return a};
function SIPRequest(){this.classname="SIPRequest";this.transactionPointer=null;this.requestLine=new RequestLine;this.inviteTransaction=this.messageChannel=null;this.unrecognizedHeaders=[];this.headers=[];this.nameTable=[];this.attachHeader(new ContentLength(0),!1)}SIPRequest.prototype=new SIPMessage;SIPRequest.prototype.constructor=SIPRequest;SIPRequest.prototype.DEFAULT_USER="ip";SIPRequest.prototype.DEFAULT_TRANSPORT="tcp";SIPRequest.prototype.INVITE="INVITE";SIPRequest.prototype.BYE="BYE";
SIPRequest.prototype.CANCEL="CANCEL";SIPRequest.prototype.ACK="ACK";SIPRequest.prototype.PRACK="PRACK";SIPRequest.prototype.INFO="INFO";SIPRequest.prototype.MESSAGE="MESSAGE";SIPRequest.prototype.NOTIFY="NOTIFY";SIPRequest.prototype.OPTIONS="OPTIONS";SIPRequest.prototype.PUBLISH="PUBLISH";SIPRequest.prototype.REFER="REFER";SIPRequest.prototype.REGISTER="REGISTER";SIPRequest.prototype.SUBSCRIBE="SUBSCRIBE";SIPRequest.prototype.UPDATE="UPDATE";SIPRequest.prototype.CSeqHeader="CSeq";
SIPRequest.prototype.ToHeader="To";SIPRequest.prototype.CallIdHeader="Call-ID";SIPRequest.prototype.FromHeader="From";SIPRequest.prototype.ViaHeader="Via";SIPRequest.prototype.MaxForwardsHeader="Max-Forwards";SIPRequest.prototype.EventHeader="Event";SIPRequest.prototype.ContactHeader="Contact";SIPRequest.prototype.COLON=":";SIPRequest.prototype.targetRefreshMethods=[SIPRequest.prototype.INVITE,SIPRequest.prototype.UPDATE,SIPRequest.prototype.SUBSCRIBE,SIPRequest.prototype.NOTIFY,SIPRequest.prototype.REFER];
SIPRequest.prototype.canonicalRequestNameTable=[SIPRequest.prototype.INVITE,SIPRequest.prototype.BYE,SIPRequest.prototype.CANCEL,SIPRequest.prototype.ACK,SIPRequest.prototype.PRACK,SIPRequest.prototype.INFO,SIPRequest.prototype.MESSAGE,SIPRequest.prototype.NOTIFY,SIPRequest.prototype.OPTIONS,SIPRequest.prototype.PRACK,SIPRequest.prototype.PUBLISH,SIPRequest.prototype.REFER,SIPRequest.prototype.REGISTER,SIPRequest.prototype.SUBSCRIBE,SIPRequest.prototype.UPDATE];
SIPRequest.prototype.isTargetRefresh=function(a){for(var b=0;b<SIPRequest.prototype.targetRefreshMethods;b++)if(SIPRequest.prototype.targetRefreshMethods[b]==a)return!0;return!1};SIPRequest.prototype.isDialogCreating=function(a){return SIPTransactionStack.prototype.isDialogCreated(a)};SIPRequest.prototype.getCannonicalName=function(a){for(var b=0;b<this.canonicalRequestNameTable&&this.canonicalRequestNameTable[b]!=a;b++);return a};SIPRequest.prototype.getRequestLine=function(){return this.requestLine};
SIPRequest.prototype.setRequestLine=function(a){this.requestLine=a};
SIPRequest.prototype.checkHeaders=function(){if(null==this.getCSeq())throw console.error("SIPRequest:checkHeaders(): Missing a required header : "+this.CSeqHeader),"SIPRequest:checkHeaders(): Missing a required header : "+this.CSeqHeader;if(null==this.getTo())throw console.error("SIPRequest:checkHeaders(): Missing a required header : "+this.ToHeader),"SIPRequest:checkHeaders(): Missing a required header : "+this.ToHeader;if(null==this.callIdHeader||null==this.callIdHeader.getCallId()||""==this.callIdHeader.getCallId())throw console.error("SIPRequest:checkHeaders(): Missing a required header : "+
this.CallIdHeader),"SIPRequest:checkHeaders(): Missing a required header : "+this.CallIdHeader;if(null==this.getFrom())throw console.error("SIPRequest:checkHeaders(): Missing a required header : "+this.FromHeader),"SIPRequest:checkHeaders(): Missing a required header : "+this.FromHeader;if(null==this.getViaHeaders())throw console.error("SIPRequest:checkHeaders(): Missing a required header : "+this.ViaHeader),"SIPRequest:checkHeaders(): Missing a required header : "+this.ViaHeader;if(null==this.getMaxForwards())throw console.error("SIPRequest:checkHeaders(): Missing a required header : "+
this.MaxForwardsHeader),"SIPRequest:checkHeaders(): Missing a required header : "+this.MaxForwardsHeader;if(null==this.getTopmostVia())throw console.error("SIPRequest:checkHeaders(): no via header in request!"),"SIPRequest:checkHeaders():  no via header in request!";if(this.getMethod()==this.NOTIFY){if(null==this.getHeader(this.EventHeader))throw console.error("SIPRequest:checkHeaders(): Missing a required header : "+this.EventHeader),"SIPRequest:checkHeaders(): Missing a required header : "+this.EventHeader;
}else if(this.getMethod()==this.PUBLISH&&null==this.getHeader(this.EventHeader))throw console.error("SIPRequest:checkHeaders(): Missing a required header : "+this.EventHeader),"SIPRequest:checkHeaders(): Missing a required header : "+this.EventHeader;if(this.requestLine.getMethod()==this.INVITE||this.requestLine.getMethod()==this.SUBSCRIBE||this.requestLine.getMethod()==this.REFER){if(null==this.getContactHeader()&&null==this.getToTag())throw console.error("SIPRequest:checkHeaders(): Missing a required header : "+
this.ContactHeader),"SIPRequest:checkHeaders(): Missing a required header : "+this.ContactHeader;if(this.requestLine.getUri()instanceof SipUri&&"sips"==this.requestLine.getUri().getScheme().toLowerCase()){var a=this.getContactHeader().getAddress().getURI();if("sips"!=a.getScheme())throw console.error("SIPRequest:checkHeaders(): scheme for contact should be sips:"+a),"SIPRequest:checkHeaders(): scheme for contact should be sips:"+a;}}if(null==this.getContactHeader()&&(this.getMethod()==this.INVITE||
this.getMethod()==this.REFER||this.getMethod()==this.SUBSCRIBE))throw console.error("SIPRequest:checkHeaders(): Contact Header is Mandatory for a SIP INVITE"),"SIPRequest:checkHeaders(): Scheme for contact should be sips:"+a;if(null!=this.requestLine&&null!=this.requestLine.getMethod()&&null!=this.getCSeq().getMethod()&&this.requestLine.getMethod()!=this.getCSeq().getMethod())throw console.error("SIPRequest:checkHeaders(): CSEQ method mismatch with  Request-Line"),"SIPRequest:checkHeaders(): CSEQ method mismatch with  Request-Line";
};SIPRequest.prototype.setDefaults=function(){if(null!=this.requestLine){var a=this.requestLine.getMethod();if(null!=a){var b=this.requestLine.getUri();null!=b&&(a==this.REGISTER||a==this.INVITE)&&b instanceof SipUri&&(b.setUserParam(this.DEFAULT_USER),b.setTransportParam(this.DEFAULT_TRANSPORT))}}};SIPRequest.prototype.setRequestLineDefaults=function(){var a=this.requestLine.getMethod();null==a&&(a=this.getCSeq(),null!=a&&(a=this.getCannonicalName(a.getMethod()),this.requestLine.setMethod(a)))};
SIPRequest.prototype.getRequestURI=function(){return null==this.requestLine?null:this.requestLine.getUri()};SIPRequest.prototype.setRequestURI=function(a){if(null==a)throw console.error("SIPRequest:setRequestURI(): null request URI"),"SIPRequest:setRequestURI(): null request URI";null==this.requestLine&&(this.requestLine=new RequestLine);this.requestLine.setUri(a);this.nullRequest=!1};
SIPRequest.prototype.setMethod=function(a){if(null==a)throw console.error("SIPRequest:setMethod(): null method"),"SIPRequest:setMethod(): null method";null==this.requestLine&&(this.requestLine=new RequestLine);a=this.getCannonicalName(a);this.requestLine.setMethod(a);null!=this.cSeqHeader&&this.cSeqHeader.setMethod(a)};SIPRequest.prototype.getMethod=function(){return null==this.requestLine?null:this.requestLine.getMethod()};
SIPRequest.prototype.encode=function(){if(null!=this.requestLine){this.setRequestLineDefaults();var a=this.requestLine.encode()+this.superencode()}else a=this.isNullRequest()?"\r\n\r\n":this.superencode();return a};SIPRequest.prototype.encodeMessage=function(){if(null!=this.requestLine){this.setRequestLineDefaults();var a=this.requestLine.encode()+this.encodeSIPHeaders()}else a=this.isNullRequest()?"\r\n\r\n":this.encodeSIPHeaders();return a};SIPRequest.prototype.toString=function(){return this.encode()};
SIPRequest.prototype.superencode=function(){for(var a="",b=0;b<this.headers.length;b++){var c=this.headers[b];c instanceof ContentLength||(a+=c.encode())}for(b=0;b<this.unrecognizedHeaders.length;b++)a=a+this.unrecognizedHeaders[b]+this.NEWLINE;a=a+this.contentLengthHeader.encode()+this.NEWLINE;if(null!=this.messageContentObject)b=this.getContent().toString(),a+=b;else if(null!=this.messageContent||null!=this.messageContentBytes){c="";if(null!=this.messageContent)c=this.messageContent;else for(b=
0;b<this.messageContentBytes.length;b++)c+=this.messageContentBytes[b];a+=c}return a.toString()};SIPRequest.prototype.getMessageAsEncodedStrings=function(){var a=Object.getPrototypeOf(this).getMessageAsEncodedStrings();null!=this.requestLine&&(this.setRequestLineDefaults(),a.addFirst(this.requestLine.encode()));return a};
SIPRequest.prototype.getDialogId=function(){if(1==arguments.length){var a=arguments[0];return this.getDialogIdargu1(a)}if(2==arguments.length)return a=arguments[0],this.getDialogIdargu2(a,arguments[1])};
SIPRequest.prototype.getDialogIdargu1=function(a){var b=this.getCallId().getCallId(),c=this.getFrom(),d=this.getTo();a?(null!=d.getTag()&&(b=b+this.COLON+d.getTag()),null!=c.getTag()&&(b=b+this.COLON+c.getTag())):(null!=c.getTag()&&(b=b+this.COLON+c.getTag()),null!=d.getTag()&&(b=b+this.COLON+d.getTag()));return b.toString().toLowerCase()};
SIPRequest.prototype.getDialogIdargu2=function(a,b){var c=this.getFrom(),d=this.getCallId().getCallId();a?(null!=b&&(d=d+this.COLON+b),null!=c.getTag()&&(d=d+this.COLON+c.getTag())):(null!=c.getTag()&&(d=d+this.COLON+c.getTag()),null!=b&&(d=d+this.COLON+b));return d.toString().toLowerCase()};
SIPRequest.prototype.createResponse=function(){if(1==arguments.length){var a=arguments[0];return this.createResponseargu1(a)}if(2==arguments.length){a=arguments[0];var b=arguments[1];return this.createResponseargu2(a,b)}if(3==arguments.length){a=arguments[0];b=arguments[1];var c=arguments[2];a=this.createResponseargu2(a,b);return this.createResponseargu3(a,c)}};SIPRequest.prototype.createResponseargu1=function(a){var b=(new SIPResponse).getReasonPhrase(a);return this.createResponseargu2(a,b)};
SIPRequest.prototype.createResponseargu2=function(a,b){var c=new SIPResponse;try{c.setStatusCode(a)}catch(f){throw console.error("SIPRequest:createResponseargu2(): bad code "+a),"SIPRequest:createResponseargu2(): bad code "+a;}null!=b?c.setReasonPhrase(b):(b=new SIPResponse,c.setReasonPhrase(b.getReasonPhrase(a)));a=this.getHeaders();for(var d=0;d<a.length;d++){b=a[d];if(b instanceof To&&!b.hasTag()){var e=(new Date).getTime();b.setTag(e)}b instanceof ViaList?c.addViaHeaderList(b):b instanceof ContactList||
b instanceof UserAgent||(200==c.getStatusCode()?c.attachHeader(b,!1):b instanceof ContentLength||b instanceof ContentType||c.attachHeader(b,!1))}null!=this.getMessageContent()&&200==c.getStatusCode()&&c.setMessageContent(this.getMessageContent());null!=MessageFactoryImpl.prototype.getDefaultServerHeader()&&c.setHeader(MessageFactoryImpl.prototype.getDefaultServerHeader());100==c.getStatusCode()&&c.getTo().removeParameter("tag");480==c.getStatusCode()&&null!=c.getHeaders("recordroute")&&c.removeHeader("record-route");
return c};SIPRequest.prototype.createResponseargu3=function(a,b){a.addContactUseragent(b);return a};SIPRequest.prototype.mustCopyRR=function(a){return 100<a&&300>a?this.isDialogCreating(this.getMethod())&&null==this.getToTag():!1};
SIPRequest.prototype.createCancelRequest=function(){if(this.getMethod()!=this.INVITE)throw console.error("SIPRequest:createCancelRequest(): Attempt to create CANCEL for "+this.getMethod()),"SIPRequest:createCancelRequest(): Attempt to create CANCEL for "+this.getMethod();var a=new SIPRequest;a.setRequestLine(this.requestLine);a.setMethod(this.CANCEL);a.setHeader(this.callIdHeader);a.setHeader(this.toHeader);a.setHeader(this.cSeqHeader);a.getCSeq().setMethod(this.CANCEL);a.setHeader(this.fromHeader);
a.addFirst(this.getTopmostVia());a.setHeader(this.maxForwardsHeader);null!=this.getRouteHeaders()&&a.setHeader(this.getRouteHeaders());null!=MessageFactoryImpl.prototype.getDefaultUserAgentHeader()&&a.setHeader(MessageFactoryImpl.prototype.getDefaultUserAgentHeader());return a};SIPRequest.prototype.createAckRequest=function(){return 1==arguments.length?this.createAckRequest_argu1(arguments[0]):this.createACKRequest_argu0()};
SIPRequest.prototype.createAckRequest_argu1=function(a){var b=new SIPRequest;b.setRequestLine(this.requestLine);b.setMethod(this.ACK);for(var c=this.getHeaders(),d=0;d<c.length;d++){var e=c[d];if(!(e instanceof RouteList||e instanceof ProxyAuthorization)){if(e instanceof ContentLength)e.setContentLength(0);else if(e instanceof ContentType)continue;else if(e instanceof CSeq)e.setMethod(this.ACK);else if(e instanceof To)null!=a&&(e=a);else if(e instanceof ContactList||e instanceof Expires)continue;
else e instanceof ViaList&&(e=e.getFirst());b.attachHeader(e,!1)}}null!=MessageFactoryImpl.prototype.getDefaultUserAgentHeader()&&b.setHeader(MessageFactoryImpl.prototype.getDefaultUserAgentHeader());return b};
SIPRequest.prototype.createErrorAck=function(a){var b=new SIPRequest,c=new RequestLine;c.setMethod(this.ACK);c.setUri(this.requestLine.getUri());var d=new CSeq;d.setMethod(this.ACK);d.setSeqNumber(this.cSeqHeader.getSequenceNumber());b.setRequestLine(c);b.setMethod(this.ACK);b.setHeader(this.callIdHeader);b.setHeader(this.maxForwardsHeader);b.setHeader(this.fromHeader);b.setHeader(a);b.addFirst(this.getTopmostVia());b.setHeader(d);null!=this.getRouteHeaders()&&b.setHeader(this.getRouteHeaders());
null!=MessageFactoryImpl.prototype.getDefaultUserAgentHeader()&&b.setHeader(MessageFactoryImpl.prototype.getDefaultUserAgentHeader());return b};
SIPRequest.prototype.createSIPRequest=function(a,b){var c=new SIPRequest;c.requestLine=a;for(var d=this.getHeaders(),e=0;e<d.length;e++){var f=d[e];if(f instanceof CSeq){var g=f;f=g;g.setMethod(a.getMethod())}else if("ViaList"==f.classname)f=f.getFirst();else if(f instanceof To)f=b?new From(f):f;else if(f instanceof From)f=b?new To(f):f;else if(f instanceof ContentLength)f.setContentLength(0);else if(!(f instanceof CallID||f instanceof MaxForwards||f instanceof Expires||f instanceof UserAgent||f instanceof
AllowList||f instanceof ContactList))continue;c.attachHeader(f,!1)}null!=MessageFactoryImpl.prototype.getDefaultUserAgentHeader()&&c.setHeader(MessageFactoryImpl.prototype.getDefaultUserAgentHeader());return c};SIPRequest.prototype.createBYERequest=function(a){var b=this.requestLine;this.requestLine.setMethod("BYE");return this.createSIPRequest(b,a)};SIPRequest.prototype.createACKRequest_argu0=function(){var a=this.requestLine;this.requestLine.setMethod(this.ACK);return this.createSIPRequest(a,!1)};
SIPRequest.prototype.getViaHost=function(){return this.getViaHeaders().getFirst().getHost()};SIPRequest.prototype.getViaPort=function(){var a=this.getViaHeaders().getFirst();return a.hasPort()?a.getPort():5060};SIPRequest.prototype.getFirstLine=function(){return null==this.requestLine?null:this.requestLine.encode()};
SIPRequest.prototype.setSIPVersion=function(a){if(null==a||"sip/2.0"!=a.toLowerCase())throw console.error("SIPRequest:setSIPVersion(): bad sipVersion",0),"SIPRequest:setSIPVersion(): bad sipVersion";this.requestLine.setSipVersion(a)};SIPRequest.prototype.getSIPVersion=function(){return this.requestLine.getSipVersion()};SIPRequest.prototype.getTransaction=function(){return this.transactionPointer};SIPRequest.prototype.setTransaction=function(a){this.transactionPointer=a};
SIPRequest.prototype.getMessageChannel=function(){return this.messageChannel};SIPRequest.prototype.setMessageChannel=function(a){this.messageChannel=a};SIPRequest.prototype.getMergeId=function(){var a=this.getFromTag(),b=this.cSeqHeader.toString(),c=this.callIdHeader.getCallId(),d=this.getRequestURI().toString();return null!=a?(""+d+":"+a+":"+b+":"+c).toString():null};SIPRequest.prototype.setInviteTransaction=function(a){this.inviteTransaction=a};SIPRequest.prototype.getInviteTransaction=function(){return this.inviteTransaction};
SIPRequest.prototype.fortest=function(){for(var a=this.requestLine.encode(),b=0;b<this.headers.length;b++){var c=this.headers[b];c instanceof ContentLength||(c=c.encode(),a+=c)}return a};function SIPResponse(){this.classname="SIPResponse";this.statusLine=new StatusLine;this.nameTable=[];this.unrecognizedHeaders=[];this.headers=[];this.attachHeader(new ContentLength(0),!1)}SIPResponse.prototype=new SIPMessage;SIPResponse.prototype.constructor=SIPResponse;SIPResponse.prototype.TRYING=100;
SIPResponse.prototype.RINGING=180;SIPResponse.prototype.CALL_IS_BEING_FORWARDED=181;SIPResponse.prototype.QUEUED=182;SIPResponse.prototype.SESSION_PROGRESS=183;SIPResponse.prototype.OK=200;SIPResponse.prototype.ACCEPTED=202;SIPResponse.prototype.MULTIPLE_CHOICES=300;SIPResponse.prototype.MOVED_PERMANENTLY=301;SIPResponse.prototype.MOVED_TEMPORARILY=302;SIPResponse.prototype.USE_PROXY=305;SIPResponse.prototype.ALTERNATIVE_SERVICE=380;SIPResponse.prototype.BAD_REQUEST=400;
SIPResponse.prototype.UNAUTHORIZED=401;SIPResponse.prototype.PAYMENT_REQUIRED=402;SIPResponse.prototype.FORBIDDEN=403;SIPResponse.prototype.NOT_FOUND=404;SIPResponse.prototype.METHOD_NOT_ALLOWED=405;SIPResponse.prototype.NOT_ACCEPTABLE=406;SIPResponse.prototype.PROXY_AUTHENTICATION_REQUIRED=407;SIPResponse.prototype.REQUEST_TIMEOUT=408;SIPResponse.prototype.GONE=410;SIPResponse.prototype.TEMPORARILY_UNAVAILABLE=480;SIPResponse.prototype.REQUEST_ENTITY_TOO_LARGE=413;
SIPResponse.prototype.REQUEST_URI_TOO_LONG=414;SIPResponse.prototype.UNSUPPORTED_MEDIA_TYPE=415;SIPResponse.prototype.UNSUPPORTED_URI_SCHEME=416;SIPResponse.prototype.BAD_EXTENSION=420;SIPResponse.prototype.EXTENSION_REQUIRED=421;SIPResponse.prototype.INTERVAL_TOO_BRIEF=423;SIPResponse.prototype.CALL_OR_TRANSACTION_DOES_NOT_EXIST=481;SIPResponse.prototype.LOOP_DETECTED=482;SIPResponse.prototype.TOO_MANY_HOPS=483;SIPResponse.prototype.ADDRESS_INCOMPLETE=484;SIPResponse.prototype.AMBIGUOUS=485;
SIPResponse.prototype.BUSY_HERE=486;SIPResponse.prototype.REQUEST_TERMINATED=487;SIPResponse.prototype.NOT_ACCEPTABLE_HERE=488;SIPResponse.prototype.BAD_EVENT=489;SIPResponse.prototype.REQUEST_PENDING=491;SIPResponse.prototype.SERVER_INTERNAL_ERROR=500;SIPResponse.prototype.UNDECIPHERABLE=493;SIPResponse.prototype.NOT_IMPLEMENTED=501;SIPResponse.prototype.BAD_GATEWAY=502;SIPResponse.prototype.SERVICE_UNAVAILABLE=503;SIPResponse.prototype.SERVER_TIMEOUT=504;
SIPResponse.prototype.VERSION_NOT_SUPPORTED=505;SIPResponse.prototype.MESSAGE_TOO_LARGE=513;SIPResponse.prototype.BUSY_EVERYWHERE=600;SIPResponse.prototype.DECLINE=603;SIPResponse.prototype.DOES_NOT_EXIST_ANYWHERE=604;SIPResponse.prototype.SESSION_NOT_ACCEPTABLE=606;SIPResponse.prototype.CONDITIONAL_REQUEST_FAILED=412;SIPResponse.prototype.CSeq="CSeq";SIPResponse.prototype.To="To";SIPResponse.prototype.From="From";SIPResponse.prototype.Via="Via";SIPResponse.prototype.CallID="Call-ID";
SIPResponse.prototype.COLON=":";SIPResponse.prototype.CANCEL="CANCEL";SIPResponse.prototype.ACK="ACK";SIPResponse.prototype.getReasonPhrase=function(){return 1==arguments.length?this.getReasonPhrase_argu1(arguments[0]):this.getReasonPhrase_argu0()};
SIPResponse.prototype.getReasonPhrase_argu1=function(a){switch(a){case this.TRYING:a="Trying";break;case this.RINGING:a="Ringing";break;case this.CALL_IS_BEING_FORWARDED:a="Call is being forwarded";break;case this.QUEUED:a="Queued";break;case this.SESSION_PROGRESS:a="Session progress";break;case this.OK:a="OK";break;case this.ACCEPTED:a="Accepted";break;case this.MULTIPLE_CHOICES:a="Multiple choices";break;case this.MOVED_PERMANENTLY:a="Moved permanently";break;case this.MOVED_TEMPORARILY:a="Moved Temporarily";
break;case this.USE_PROXY:a="Use proxy";break;case this.ALTERNATIVE_SERVICE:a="Alternative service";break;case this.BAD_REQUEST:a="Bad request";break;case this.UNAUTHORIZED:a="Unauthorized";break;case this.PAYMENT_REQUIRED:a="Payment required";break;case this.FORBIDDEN:a="Forbidden";break;case this.NOT_FOUND:a="Not found";break;case this.METHOD_NOT_ALLOWED:a="Method not allowed";break;case this.NOT_ACCEPTABLE:a="Not acceptable";break;case this.PROXY_AUTHENTICATION_REQUIRED:a="Proxy Authentication required";
break;case this.REQUEST_TIMEOUT:a="Request timeout";break;case this.GONE:a="Gone";break;case this.TEMPORARILY_UNAVAILABLE:a="Temporarily Unavailable";break;case this.REQUEST_ENTITY_TOO_LARGE:a="Request entity too large";break;case this.REQUEST_URI_TOO_LONG:a="Request-URI too large";break;case this.UNSUPPORTED_MEDIA_TYPE:a="Unsupported media type";break;case this.UNSUPPORTED_URI_SCHEME:a="Unsupported URI Scheme";break;case this.BAD_EXTENSION:a="Bad extension";break;case this.EXTENSION_REQUIRED:a="Etension Required";
break;case this.INTERVAL_TOO_BRIEF:a="Interval too brief";break;case this.CALL_OR_TRANSACTION_DOES_NOT_EXIST:a="Call leg/Transaction does not exist";break;case this.LOOP_DETECTED:a="Loop detected";break;case this.TOO_MANY_HOPS:a="Too many hops";break;case this.ADDRESS_INCOMPLETE:a="Address incomplete";break;case this.AMBIGUOUS:a="Ambiguous";break;case this.BUSY_HERE:a="Busy here";break;case this.REQUEST_TERMINATED:a="Request Terminated";break;case this.NOT_ACCEPTABLE_HERE:a="Not Acceptable here";
break;case this.BAD_EVENT:a="Bad Event";break;case this.REQUEST_PENDING:a="Request Pending";break;case this.SERVER_INTERNAL_ERROR:a="Server Internal Error";break;case this.UNDECIPHERABLE:a="Undecipherable";break;case this.NOT_IMPLEMENTED:a="Not implemented";break;case this.BAD_GATEWAY:a="Bad gateway";break;case this.SERVICE_UNAVAILABLE:a="Service unavailable";break;case this.SERVER_TIMEOUT:a="Gateway timeout";break;case this.VERSION_NOT_SUPPORTED:a="SIP version not supported";break;case this.MESSAGE_TOO_LARGE:a=
"Message Too Large";break;case this.BUSY_EVERYWHERE:a="Busy everywhere";break;case this.DECLINE:a="Decline";break;case this.DOES_NOT_EXIST_ANYWHERE:a="Does not exist anywhere";break;case this.SESSION_NOT_ACCEPTABLE:a="Session Not acceptable";break;case this.CONDITIONAL_REQUEST_FAILED:a="Conditional request failed";break;default:a="Unknown Status"}return a};
SIPResponse.prototype.setStatusCode=function(a){if(100>a||699<a)throw console.error("SIPResponse:setStatusCode(): bad status code"),"SIPResponse:setStatusCode(): bad status code";null==this.statusLine&&(this.statusLine=new StatusLine);this.statusLine.setStatusCode(a)};SIPResponse.prototype.getStatusLine=function(){return this.statusLine};SIPResponse.prototype.getStatusCode=function(){return this.statusLine.getStatusCode()};
SIPResponse.prototype.setReasonPhrase=function(a){if(null==a)throw console.error("SIPResponse:setReasonPhrase(): bad reason phrase"),"SIPResponse:setReasonPhrase(): bad reason phrase";null==this.statusLine&&(this.statusLine=new StatusLine);this.statusLine.setReasonPhrase(a)};SIPResponse.prototype.getReasonPhrase_argu0=function(){return null==this.statusLine||null==this.statusLine.getReasonPhrase()?"":this.statusLine.getReasonPhrase()};
SIPResponse.prototype.isFinalResponse=function(a){null==a&&(a=this.statusLine.getStatusCode());return 200<=a&&700>a?!0:!1};SIPResponse.prototype.setStatusLine=function(a){this.statusLine=a};
SIPResponse.prototype.checkHeaders=function(){if(null==this.getCSeq())throw console.error("SIPResponse:checkHeaders(): "+this.CSeq+" is missing ",0),"SIPResponse:checkHeaders(): "+this.CSeq+" is missing ";if(null==this.getTo())throw console.error("SIPResponse:checkHeaders(): "+this.To+" is missing ",0),"SIPResponse:checkHeaders(): "+this.To+" is missing ";if(null==this.getFrom())throw console.error("SIPResponse:checkHeaders(): "+this.From+" is missing ",0),"SIPResponse:checkHeaders(): "+this.From+
" is missing ";if(null==this.getViaHeaders())throw console.error("SIPResponse:checkHeaders(): "+this.Via+" is missing ",0),"SIPResponse:checkHeaders(): "+this.Via+" is missing ";if(null==this.getCallId())throw console.error("SIPResponse:checkHeaders(): "+this.CallID+" is missing ",0),"SIPResponse:checkHeaders(): "+this.CallID+" is missing ";if(699<this.getStatusCode())throw console.error("SIPResponse:checkHeaders(): unknown error code!"+this.getStatusCode(),0),"SIPResponse:checkHeaders(): unknown error code!"+
this.getStatusCode();};SIPResponse.prototype.encode=function(){return null!=this.statusLine?this.statusLine.encode()+this.superencode():this.superencode()};SIPResponse.prototype.encodeMessage=function(){return null!=this.statusLine?this.statusLine.encode()+this.encodeSIPHeaders():this.encodeSIPHeaders()};
SIPResponse.prototype.superencode=function(){for(var a="",b=0;b<this.headers.length;b++){var c=this.headers[b];c instanceof ContentLength||(a+=c.encode())}for(b=0;b<this.unrecognizedHeaders.length;b++)a=a+this.unrecognizedHeaders[b]+this.NEWLINE;a=a+this.contentLengthHeader.encode()+this.NEWLINE;if(null!=this.messageContentObject)b=this.getContent().toString(),a+=b;else if(null!=this.messageContent||null!=this.messageContentBytes){c="";if(null!=this.messageContent)c=this.messageContent;else for(b=
0;b<this.messageContentBytes.length;b++)c+=this.messageContentBytes[b];a+=c}return a.toString()};SIPResponse.prototype.getMessageAsEncodedStrings=function(){var a=Object.getPrototypeOf(this).getMessageAsEncodedStrings();if(null!=this.statusLine){a=[];a[0]=this.statusLine.encode();for(var b=0;b<this.retval.length;b++)a[b+1]=this.retval[b]}return a};
SIPResponse.prototype.encodeAsBytes=function(a){var b=[];null!=this.statusLine&&(b=this.getBytes(this.statusLine.encode()));a=Object.getPrototypeOf(this).encodeAsBytes(a);return b.concat(a)};SIPResponse.prototype.getDialogId=function(){if(1==arguments.length){var a=arguments[0];return this.getDialogIdargu1(a)}if(2==arguments.length)return a=arguments[0],this.getDialogIdargu2(a,arguments[1])};
SIPResponse.prototype.getDialogIdargu1=function(a){var b=this.getCallId().getCallId(),c=this.getFrom(),d=this.getTo();a?(null!=d.getTag()&&(b=b+this.COLON+d.getTag()),null!=c.getTag()&&(b=b+this.COLON+c.getTag())):(null!=c.getTag()&&(b=b+this.COLON+c.getTag()),null!=d.getTag()&&(b=b+this.COLON+d.getTag()));return b.toString().toLowerCase()};
SIPResponse.prototype.getDialogIdargu2=function(a,b){var c=this.getFrom(),d=this.getCallId().getCallId();a?(null!=b&&(d=d+this.COLON+b),null!=c.getTag()&&(d=d+this.COLON+c.getTag())):(null!=c.getTag()&&(d=d+this.COLON+c.getTag()),null!=b&&(d=d+this.COLON+b));return d.toString().toLowerCase()};
SIPResponse.prototype.setBranch=function(a,b){if(b==this.ACK)b=300<=this.statusLine.getStatusCode()?this.getTopmostVia().getBranch():Utils.prototype.generateBranchId();else if(b==this.CANCEL)b=this.getTopmostVia().getBranch();else return;a.setBranch(b)};SIPResponse.prototype.getFirstLine=function(){return null==this.statusLine?null:this.statusLine.encode()};SIPResponse.prototype.setSIPVersion=function(a){this.statusLine.setSipVersion(a)};SIPResponse.prototype.getSIPVersion=function(){return this.statusLine.getSipVersion()};
SIPResponse.prototype.toString=function(){return null==this.statusLine?"":this.statusLine.encode()+Object.getPrototypeOf(this).encode()};
SIPResponse.prototype.createRequest=function(a,b,c,d,e){var f=new SIPRequest,g=c.getMethod(),h=this.getCallId();f.setMethod(g);f.setRequestURI(a);this.setBranch(b,g);f.setHeader(b);f.setHeader(d);f.setHeader(e);f.setHeader(c);f.setHeader(h);f.attachHeader(new MaxForwards(70),!1);a=f.getHeaders();for(b=0;b<a.length;b++)c=a[b],this.isResponseHeader(c)||c instanceof ViaList||c instanceof CSeq||c instanceof ContentType||c instanceof ContentLength||c instanceof RecordRouteList||c instanceof ContactList||
c instanceof ContentLength||c instanceof Reason||c instanceof ReasonList||(c instanceof To?c=e:c instanceof From&&(c=d),f.attachHeader(c,!1));null!=MessageFactoryImpl.prototype.getDefaultUserAgentHeader()&&f.setHeader(MessageFactoryImpl.prototype.getDefaultUserAgentHeader());return f};SIPResponse.prototype.getBytes=function(a){var b=[];a=new String(a);for(var c=0;c<a.length;c++)b[c]=a.charCodeAt(c);return b};
SIPResponse.prototype.addContactUseragent=function(a){var b=a.getContactHeader();a=a.getHeader("User-Agent");this.addHeader(b);this.addHeader(a)};SIPResponse.prototype.fortest=function(){for(var a=this.statusLine.encode(),b=0;b<this.headers.length;b++){var c=this.headers[b];c instanceof ContentLength||(c=c.encode(),a+=c)}return a};
function HopImpl(){this.classname="HopImpl";this.port=this.host=null;this.transport=SipStackImpl.prototype.DEFAULT_WS_TRANSPORT;this.uriRoute=this.defaultRoute=null;if(1==arguments.length){var a=arguments[0];if(null==a)throw console.error("HopImpl:HopImpl(): null arg!"),"HopImpl:HopImpl(): null arg!";var b=a.indexOf("]"),c=a.indexOf(":",b),d=a.indexOf("/",c);0<c?(this.host=a.substring(0,c),0<d?(c=a.substring(c+1,d),this.transport=a.substring(d+1)):c=a.substring(c+1),this.port=c-0):(0<d?(this.host=
a.substring(0,d),this.transport=a.substring(d+1)):this.host=a,this.port=8080);if(null==this.host||0==this.host.length)throw console.error("HopImpl:HopImpl(): no host!"),"HopImpl:HopImpl(): no host!";this.host=this.host.trim();this.transport=this.transport.trim();if(0<b&&"["!=this.host.charAt(0))throw console.error("HopImpl:HopImpl(): bad IPv6 reference spec"),"HopImpl:HopImpl(): bad IPv6 reference spec";if("tcp"!=this.transport.toLowerCase()&&"ws"!=this.transport.toLowerCase()&&"wss"!=this.transport.toLowerCase())throw console.error("HopImpl:HopImpl(): bad transport string "+
this.transport),"HopImpl:HopImpl(): bad transport string "+this.transport;}else 3==arguments.length&&(a=arguments[1],b=arguments[2],this.host=arguments[0],0<=this.host.indexOf(":")&&0>this.host.indexOf("[")&&(this.host="["+this.host+"]"),this.port=a,this.transport=b)}HopImpl.prototype.toString=function(){return this.host+":"+this.port+"/"+this.transport};HopImpl.prototype.getHost=function(){return this.host};HopImpl.prototype.getPort=function(){return this.port};HopImpl.prototype.getTransport=function(){return this.transport};
HopImpl.prototype.isURIRoute=function(){return this.uriRoute};HopImpl.prototype.setURIRouteFlag=function(){this.uriRoute=!0};
function SIPTransactionStack(){this.classname="SIPTransactionStack";this.messageProcessors=[];this.sipMessageFactory=null;this.activeClientTransactionCount=0;this.mergeTable=[];this.router=this.stackName=this.needsLogging=this.defaultRouter=null;this.maxConnections=-1;this.useRouterForAll=null;this.readTimeout=-1;this.isAutomaticDialogSupportEnabled=this.routerPath=this.outboundProxy=null;this.forkedEvents=[];this.generateTimeStampHeader=null;this.stackDoesCongestionControl=this.logStackTraceOnMessageSend=
this.remoteTagReassignmentAllowed=this.cancelClientTransactionChecked=!0;this.checkBranchId=!1;this.isAutomaticDialogErrorHandlingEnabled=!0;this.isDialogTerminatedEventDeliveredForNullDialog=!1;this.serverTransactionTable=[];this.clientTransactionTable=[];this.terminatedServerTransactionsPendingAck=[];this.forkedClientTransactionTable=[];this.dialogTable=[];this.earlyDialogTable=[];this.pendingTransactions=[];this.unlimitedClientTransactionTableSize=this.unlimitedServerTransactionTableSize=!0;this.serverTransactionTableHighwaterMark=
5E3;this.serverTransactionTableLowaterMark=4E3;this.clientTransactionTableHiwaterMark=1E3;this.clientTransactionTableLowaterMark=800;this.rfc2543Supported=!0;this.maxForkTime=0;this.isBackToBackUserAgent=this.toExit=!1;this.maxListenerResponseTime=-1;this.maxMessageSize=this.non2XXAckPassedToListener=null;this.addressResolver=new DefaultAddressResolver;this.stackAddress=null}SIPTransactionStack.prototype.BASE_TIMER_INTERVAL=500;SIPTransactionStack.prototype.CONNECTION_LINGER_TIME=8;
SIPTransactionStack.prototype.BRANCH_MAGIC_COOKIE_LOWER_CASE="z9hg4bk";SIPTransactionStack.prototype.TRYING=100;SIPTransactionStack.prototype.RINGING=180;SIPTransactionStack.prototype.dialogCreatingMethods=["REFER","INVITE","SUBSCRIBE","REGISTER"];
SIPTransactionStack.prototype.reInit=function(){this.messageProcessors=[];this.pendingTransactions=[];this.clientTransactionTable=[];this.serverTransactionTable=[];this.mergeTable=[];this.dialogTable=[];this.earlyDialogTable=[];this.terminatedServerTransactionsPendingAck=[];this.forkedClientTransactionTable=[];this.activeClientTransactionCount=0};
SIPTransactionStack.prototype.addExtensionMethod=function(a){if("NOTIFY"!=a){for(var b=null,c=0;c<SIPTransactionStack.prototype.dialogCreatingMethods.length;c++)SIPTransactionStack.prototype.dialogCreatingMethods[c]==a.trim().toUpperCase()&&(b=c);null==b&&SIPTransactionStack.prototype.dialogCreatingMethods.push(a.trim().toUpperCase())}};
SIPTransactionStack.prototype.removeDialog=function(a){console.log("SIPTransactionStack.prototype.removeDialog(): id="+a.getDialogId());var b=a.getDialogId(),c=a.getEarlyDialogId();if(null!=c){for(var d=null,e=0;e<this.earlyDialogTable.length;e++)this.earlyDialogTable[e][0]==c&&(d=e);this.earlyDialogTable.splice(d,1);d=null;for(e=0;e<this.dialogTable.length;e++)this.dialogTable[e][0]==c&&(d=e);null!=d&&this.dialogTable.splice(d,1)}if(null!=b){c=null;for(e=0;e<this.dialogTable.length;e++)this.dialogTable[e][0]==
b&&(c=this.dialogTable[e][1]);if(c==a){d=null;for(e=0;e<this.dialogTable.length;e++)this.dialogTable[e][0]==b&&(d=e);null!=d&&this.dialogTable.splice(d,1)}a.testAndSetIsDialogTerminatedEventDelivered()||(b=new DialogTerminatedEvent(a.getSipProvider(),a),a.getSipProvider().handleEvent(b,null))}};
SIPTransactionStack.prototype.findSubscribeTransaction=function(a,b){b=null;var c=a.getTo().getTag();if(null==c)return b;var d=a.getHeader("Event");if(null==d)return b;for(var e=0;e<this.clientTransactionTable.length;e++){var f=this.clientTransactionTable[e][1];if("SUBSCRIBE"==f.getMethod()){var g=f.from.getTag(),h=f.event;if(null!=h&&g.toLowerCase()==c.toLowerCase()&&null!=h&&d.match(h)&&a.getCallId().getCallId().toLowerCase()==f.callId.getCallId().toLowerCase()){b=f;break}}}return b};
SIPTransactionStack.prototype.removeTransactionPendingAck=function(a){a=a.getRequest().getTopmostVia().getBranch();for(var b=null,c=0;c<this.terminatedServerTransactionsPendingAck.length;c++)this.terminatedServerTransactionsPendingAck[c][0]==a&&(b=c);if(null!=a&&null!=b){b=null;for(c=0;c<this.terminatedServerTransactionsPendingAck.length;c++)this.terminatedServerTransactionsPendingAck[c][0]==a&&(b=c);null!=b&&this.terminatedServerTransactionsPendingAck.splice(b,1);return!0}return!1};
SIPTransactionStack.prototype.removeTransactionHash=function(a){if(null!=a.getOriginalRequest())if(a instanceof SIPClientTransaction){a=a.getTransactionId();for(var b=null,c=0;c<this.clientTransactionTable.length;c++)this.clientTransactionTable[c][0]==a&&(b=c);this.clientTransactionTable.splice(b,1)}else if(a instanceof SIPServerTransaction){a=a.getTransactionId();b=null;for(c=0;c<this.serverTransactionTable.length;c++)this.serverTransactionTable[c][0]==a&&(b=c);this.serverTransactionTable.splice(b,
1)}};SIPTransactionStack.prototype.removePendingTransaction=function(a){for(var b=null,c=0;c<this.pendingTransactions.length;c++)this.pendingTransactions[c][0]==a.getTransactionId()&&(b=c);null!=b&&this.pendingTransactions.splice(b,1)};SIPTransactionStack.prototype.isAlive=function(){return this.toExit?!1:!0};
SIPTransactionStack.prototype.findCancelTransaction=function(a,b){if(b)for(b=0;b<this.serverTransactionTable.length;b++){var c=this.serverTransactionTable[b][1];if(c.doesCancelMatchTransaction(a))return c}else for(b=0;b<this.clientTransactionTable.length;b++)if(c=this.clientTransactionTable[b][1],c.doesCancelMatchTransaction(a))return c;return null};
SIPTransactionStack.prototype.getDialog=function(a){for(var b=null,c=0;c<this.dialogTable.length;c++)this.dialogTable[c][0]==a&&(b=c);return null!=b?this.dialogTable[b][1]:null};SIPTransactionStack.prototype.isDialogCreated=function(a){for(var b=0;b<SIPTransactionStack.prototype.dialogCreatingMethods.length;b++)if(SIPTransactionStack.prototype.dialogCreatingMethods[b]==a)return!0;return!1};SIPTransactionStack.prototype.isRfc2543Supported=function(){return this.rfc2543Supported};
SIPTransactionStack.prototype.createDialog=function(){if(1==arguments.length){var a=arguments[0];return this.createDialogargu1(a)}if(2==arguments.length){if("SipProviderImpl"==arguments[0].classname)return a=arguments[0],b=arguments[1],new SIPDialog(a,b);a=arguments[0];var b=arguments[1];return this.createDialogargu2(a,b)}};
SIPTransactionStack.prototype.createDialogargu1=function(a){if(a instanceof SIPClientTransaction){for(var b=a.getRequest().getDialogId(!1),c=null,d=0;d<this.earlyDialogTable.length;d++)this.earlyDialogTable[d][0]==b&&(c=d);null!=c?(b=this.earlyDialogTable[c][1],null==b.getState()||"EARLY"==b.getState()?a=b:(a=new SIPDialog(a),this.earlyDialogTable[c][1]=a)):(a=new SIPDialog(a),c=[],c[0]=b,c[1]=a,this.earlyDialogTable.push(c))}else a=new SIPDialog(a);return a};
SIPTransactionStack.prototype.createDialogargu2=function(a,b){for(var c=a.getRequest().getDialogId(!1),d=null,e=0;e<this.earlyDialogTable.length;e++)this.earlyDialogTable[e][0]==c&&(d=e);null!=d?(a=this.earlyDialogTable[d][1],b.isFinalResponse()&&this.earlyDialogTable.splice(d,1)):a=new SIPDialog(a,b);return a};
SIPTransactionStack.prototype.createRawMessageChannel=function(){for(var a=null,b=0;b<this.messageProcessors.length;b++){var c=this.messageProcessors[b];if(c.getTransport()==this.transport){a=c.createMessageChannel();break}}return a};SIPTransactionStack.prototype.isNon2XXAckPassedToListener=function(){return this.non2XXAckPassedToListener?!0:!1};
SIPTransactionStack.prototype.isTransactionPendingAck=function(a){a=a.getRequest().getTopmostVia().getBranch();for(var b=null,c=0;c<this.terminatedServerTransactionsPendingAck.length;c++)this.terminatedServerTransactionsPendingAck[c][0]==a&&(b=c);return null!=b?!0:!1};SIPTransactionStack.prototype.setNon2XXAckPassedToListener=function(a){this.non2XXAckPassedToListener=a};
SIPTransactionStack.prototype.addForkedClientTransaction=function(a){for(var b=null,c=0;c<this.forkedClientTransactionTable.length;c++)this.forkedClientTransactionTable[c][0]==a.getTransactionId()&&(b=c,this.forkedClientTransactionTable[c][1]=a);null==b&&(b=[],b[0]=a.getTransactionId(),b[1]=a,this.forkedClientTransactionTable.push(b))};
SIPTransactionStack.prototype.getForkedTransaction=function(a){for(var b=null,c=0;c<this.forkedClientTransactionTable.length;c++)this.forkedClientTransactionTable[c][0]==a&&(b=c);return null!=b?this.forkedClientTransactionTable[b][1]:null};
SIPTransactionStack.prototype.addTransactionPendingAck=function(a){var b=a.getRequest().getTopmostVia().getBranch();if(null!=b){for(var c=null,d=0;d<this.terminatedServerTransactionsPendingAck.length;d++)this.forkedClientTransactionTable[d][0]==b&&(c=d,this.forkedClientTransactionTable[d][1]=a);null==c&&(c=[],c[0]=b,c[1]=a,this.forkedClientTransactionTable.push(c))}};
SIPTransactionStack.prototype.findTransactionPendingAck=function(a){for(var b=null,c=0;c<this.terminatedServerTransactionsPendingAck.length;c++)this.terminatedServerTransactionsPendingAck[c][0]==a.getTopmostVia().getBranch()&&(b=c);return null==b?null:this.terminatedServerTransactionsPendingAck[b][1]};
SIPTransactionStack.prototype.putDialog=function(a){for(var b=a.getDialogId(),c=null,d=0;d<this.dialogTable.length;d++)this.dialogTable[d][0]==b&&(c=d);null==c&&(a.setStack(this),c=[],c[0]=b,c[1]=a,this.dialogTable.push(c))};SIPTransactionStack.prototype.findPendingTransaction=function(a){for(var b=null,c=0;c<this.pendingTransactions.length;c++)this.dialogTable[c][0]==a.getTransactionId()&&(b=c);return null==b?null:this.pendingTransactions[b][1]};
SIPTransactionStack.prototype.putPendingTransaction=function(a){for(var b=null,c=0;c<this.pendingTransactions.length;c++)this.pendingTransactions[c][0]==a.getTransactionId()&&(b=c,this.pendingTransactions[c][1]=a);null==b&&(b=[],b[0]=a.getTransactionId(),b[1]=a,this.pendingTransactions.push(b))};
SIPTransactionStack.prototype.removePendingTransaction=function(a){for(var b=null,c=0;c<this.pendingTransactions.length;c++)this.pendingTransactions[c][0]==a.getTransactionId()&&(b=c);this.pendingTransactions.splice(b,1)};SIPTransactionStack.prototype.getServerTransactionTableSize=function(){return this.serverTransactionTable.length};SIPTransactionStack.prototype.getClientTransactionTableSize=function(){return this.clientTransactionTable.length};
SIPTransactionStack.prototype.findTransaction=function(a,b){var c=null;if(b){b=a.getTopmostVia();if(null!=b.getBranch()){var d=a.getTransactionId();for(b=0;b<this.serverTransactionTable.length;b++)this.serverTransactionTable[b][0]==d&&(c=this.serverTransactionTable[b][1]);if("z9hg4bk"==d.substring(0,7).toLowerCase())return c}for(b=0;b<this.serverTransactionTable.length;b++)if(d=this.serverTransactionTable[b][1],d.isMessagePartOfTransaction(a)){c=d;break}}else{b=a.getTopmostVia();if(null!=b.getBranch()){d=
a.getTransactionId();for(b=0;b<this.clientTransactionTable.length;b++)this.clientTransactionTable[b][0]==d&&(c=this.clientTransactionTable[b][1]);if("z9hg4bk"==d.substring(0,7).toLowerCase())return c}for(b=0;b<this.serverTransactionTable.length;b++)if(d=this.clientTransactionTable[b][1],d.isMessagePartOfTransaction(a)){c=d;break}}return c};
SIPTransactionStack.prototype.removeFromMergeTable=function(a){a=a.getRequest().getMergeId();var b=null;if(null!=a){for(var c=0;c<this.mergeTable.length;c++)this.mergeTable[c][0]==a&&(b=c);null!=b&&this.mergeTable.splice(b,1)}};SIPTransactionStack.prototype.putInMergeTable=function(a,b){b=b.getMergeId();var c=null;if(null!=b){for(var d=0;d<this.mergeTable.length;d++)this.mergeTable[d][0]==b&&(this.mergeTable[d][1]=a,c=d);null==c&&(c=[],c[0]=b,c[1]=a,this.mergeTable.push(c))}};
SIPTransactionStack.prototype.addTransactionHash=function(a){var b=a.getOriginalRequest();if(a instanceof SIPClientTransaction){this.activeClientTransactionCount++;var c=null;b=b.getTransactionId();for(var d=0;d<this.clientTransactionTable.length;d++)this.clientTransactionTable[d][0]==b&&(c=d,this.clientTransactionTable[d][1]=a);null==c&&(c=[],c[0]=b,c[1]=a,this.clientTransactionTable.push(c))}else{c=null;b=b.getTransactionId();for(d=0;d<this.serverTransactionTable.length;d++)this.serverTransactionTable[d][0]==
b&&(c=d,this.serverTransactionTable[d][1]=a);null==c&&(c=[],c[0]=b,c[1]=a,this.serverTransactionTable.push(c))}};SIPTransactionStack.prototype.setMessageFactory=function(a){this.sipMessageFactory=a};SIPTransactionStack.prototype.checkBranchIdFunction=function(){return this.checkBranchId};SIPTransactionStack.prototype.addMessageProcessor=function(a){for(var b=null,c=0;c<this.messageProcessors.length;c++)this.messageProcessors[c]==a&&(b=c);null==b&&this.messageProcessors.push(a)};
SIPTransactionStack.prototype.findMergedTransaction=function(a){if("INVITE"!=a.getMethod())return null;for(var b=a.getMergeId(),c=null,d=0;d<this.mergeTable.length;d++)this.mergeTable[d][0]==b&&(c=this.mergeTable[d][1]);if(null==b)return null;if(null==c||c.isMessagePartOfTransaction(a)){for(d=0;d<this.dialogTable.length;d++)if(b=this.dialogTable[d][1],null!=b.getFirstTransaction()&&b.getFirstTransaction()instanceof SIPServerTransaction){c=b.getFirstTransaction();var e=b.getFirstTransaction().getOriginalRequest();
if(!c.isMessagePartOfTransaction(a)&&a.getMergeId()==e.getMergeId())return b.getFirstTransaction()}return null}return c};SIPTransactionStack.prototype.mapTransaction=function(a){a.isMapped||(this.addTransactionHash(a),a.isMapped=!0)};SIPTransactionStack.prototype.createTransaction=function(a,b,c){if(null==b)return null;a=this.createClientTransaction(a,b);a.setViaPort(c.getPort());a.setViaHost(c.getHost());this.addTransactionHash(a);return a};
SIPTransactionStack.prototype.createClientTransaction=function(a,b){b=new SIPClientTransaction(this,b);b.setOriginalRequest(a);return b};SIPTransactionStack.prototype.addTransaction=function(a){a instanceof SIPServerTransaction&&a.map();this.addTransactionHash(a)};SIPTransactionStack.prototype.transactionErrorEvent=function(a){var b=a.getSource();2==a.getErrorID()&&(b.setState("TERMINATED"),b instanceof SIPServerTransaction&&(b.collectionTime=0),b.disableTimeoutTimer())};
SIPTransactionStack.prototype.dialogErrorEvent=function(a){a=a.getSource();null!=a&&a.delet()};SIPTransactionStack.prototype.stopStack=function(){this.pendingTransactions=[];this.toExit=!0;for(var a=this.getMessageProcessors(),b=0;b<a.length;b++)this.removeMessageProcessor(a[b]),this.clientTransactionTable=[],this.serverTransactionTable=[],this.dialogTable=[]};SIPTransactionStack.prototype.getMaxMessageSize=function(){return this.maxMessageSize};
SIPTransactionStack.prototype.getNextHop=function(a){return this.useRouterForAll?null!=this.router?this.router.getNextHop(a):null:a.getRequestURI().isSipURI()||null!=a.getRouteHeaders()?this.defaultRouter.getNextHop(a):null!=this.router?this.router.getNextHop(a):null};SIPTransactionStack.prototype.setStackName=function(a){this.stackName=a};
SIPTransactionStack.prototype.setHostAddress=function(a){a.indexOf(":")!=a.lastIndexOf(":")&&"["!=a.trim().charAt(0)?this.stackAddress="["+a+"]":this.stackAddress=a;this.stackInetAddress=a};SIPTransactionStack.prototype.getHostAddress=function(){return this.stackAddress};SIPTransactionStack.prototype.setRouter=function(a){this.router=a};SIPTransactionStack.prototype.getRouter=function(){0==arguments.length?this.getRouterargu0():this.getRouterargu1(arguments[0])};
SIPTransactionStack.prototype.getRouterargu0=function(){return this.router};SIPTransactionStack.prototype.getRouterargu1=function(a){return null==a.getRequestLine()?this.defaultRouter:this.useRouterForAll?this.router:"sip"==a.getRequestURI().getScheme()||"sips"==a.getRequestURI().getScheme()?this.defaultRouter:null!=this.router?this.router:this.defaultRouter};
SIPTransactionStack.prototype.removeMessageProcessor=function(a){for(var b=null,c=0;c<this.messageProcessors.lengt;c++)this.messageProcessors[c]==a&&(b=c);null!=b&&(this.messageProcessors.splice(b,1),a.stop())};SIPTransactionStack.prototype.getMessageProcessors=function(){return this.messageProcessors};SIPTransactionStack.prototype.isEventForked=function(a){for(var b=null,c=0;c<this.forkedEvents.length;c++)this.forkedEvents[c]==a&&(b=c);return null!=b?!0:!1};
SIPTransactionStack.prototype.getActiveClientTransactionCount=function(){return this.activeClientTransactionCount};SIPTransactionStack.prototype.isCancelClientTransactionChecked=function(){return this.cancelClientTransactionChecked};SIPTransactionStack.prototype.isRemoteTagReassignmentAllowed=function(){return this.remoteTagReassignmentAllowed};SIPTransactionStack.prototype.getDialogs=function(){return 0==arguments.length?this.getDialogsargu0():this.getDialogsargu1(arguments[0])};
SIPTransactionStack.prototype.getDialogsargu0=function(){for(var a=[],b=0;b<this.dialogTable.length;b++){for(var c=null,d=0;d<a.legnth;d++)a[d]==this.dialogTable[b][1]&&(c=b);null==c&&a.push(this.dialogTable[b][1])}for(b=0;b<this.earlyDialogTable.length;b++){c=null;for(d=0;d<a.legnth;d++)a[d]==this.earlyDialogTable[b][1]&&(c=b);null==c&&a.push(this.earlyDialogTable[b][1])}return a};
SIPTransactionStack.prototype.getDialogsargu1=function(a){var b=[];if("EARLY"==a)for(var c=0;c<this.earlyDialogTable.length;c++){for(var d=null,e=0;e<b.legnth;e++)b[e]==this.earlyDialogTable[c][1]&&(d=c);null==d&&b.push(this.earlyDialogTable[c][1])}else for(c=0;c<this.dialogTable.length;c++){var f=this.dialogTable[c][1];if(null!=f.getState()&&f.getState()==a){d=null;for(e=0;e<b.legnth;e++)b[e]==f&&(d=c);null==d&&b.push(f)}}return b};
SIPTransactionStack.prototype.setDeliverDialogTerminatedEventForNullDialog=function(){this.isDialogTerminatedEventDeliveredForNullDialog=!0};SIPTransactionStack.prototype.getAddressResolver=function(){return this.addressResolver};function SIPTransactionErrorEvent(a,b){this.classname="SIPTransactionErrorEvent";this.source=a;this.errorID=b}SIPTransactionErrorEvent.prototype.TIMEOUT_ERROR=1;SIPTransactionErrorEvent.prototype.TRANSPORT_ERROR=64;SIPTransactionErrorEvent.prototype.TIMEOUT_RETRANSMIT=64;
SIPTransactionErrorEvent.prototype.getErrorID=function(){return this.errorID};SIPTransactionErrorEvent.prototype.getSource=function(){return this.source};
function DefaultRouter(){this.classname="DefaultRouter";this.defaultRoute=this.sipStack=null;if(0!=arguments.length){var a=arguments[0],b=arguments[1],c=8080,d="WSS";4<=arguments.length&&(null!=arguments[2]&&(c=arguments[2]),null!=arguments[3]&&(d=arguments[3]));this.sipStack=a;null!=b&&(this.defaultRoute=this.sipStack.getAddressResolver().resolveAddress(new HopImpl(b,c,d)))}}
DefaultRouter.prototype.getNextHop=function(a){var b=a.getRequestLine();if(null==b)return this.defaultRoute;b=b.getUri();if(null==b)throw console.error("DefaultRouter:getNextHop(): bad message: Null requestURI"),"ViaParser:getNextHop():  bad message: Null requestURI";var c=a.getRouteHeaders();if(null!=c&&null!=c.getFirst()){b=c.getFirst().getAddress().getURI();if(b.isSipURI())return b.hasLrParam()||this.fixStrictRouting(a),a=this.createHop(b,a);console.error("DefaultRouter:getNextHop(): first Route not a SIP URI");
throw"DefaultRouter:getNextHop(): first Route not a SIP URI";}return b.isSipURI()&&null!=b.getMAddrParam()?a=this.createHop(b,a):null!=this.defaultRoute?this.defaultRoute:b.isSipURI()?a=this.createHop(b,a):null};DefaultRouter.prototype.fixStrictRouting=function(a){var b=a.getRouteHeaders(),c=b.getFirst().getAddress().getURI();b.removeFirst();var d=new AddressImpl;d.setAddress(a.getRequestURI());d=new Route(d);b.add(d);a.setRequestURI(c)};
DefaultRouter.prototype.createHop=function(a,b){var c=a.getTransportParam();null==c&&(c=b.getHeader("Via").getTransport());b=-1!=a.getPort()?a.getPort():5060;a=null!=a.getMAddrParam()?a.getMAddrParam():a.getHost();return this.sipStack.getAddressResolver().resolveAddress(new HopImpl(a,b,c))};DefaultRouter.prototype.getOutboundProxy=function(){return this.defaultRoute};
DefaultRouter.prototype.getNextHops=function(a){try{var b=[];b.push(this.getNextHop(a));return b()}catch(c){return console.error("DefaultRouter:getNextHops(): catched exception:"+c),null}};
function WSMessageChannel(a,b){this.classname="WSMessageChannel";this.wsurl=b;if(0==this.wsurl.toLowerCase().indexOf("ws://"))this.transport="WS";else if(0==this.wsurl.toLowerCase().indexOf("wss://"))this.transport="WSS";else throw"WSMessageChannel:createWebSocket(): bad Websocket Url";this.messageProcessor=a;this.myAddress=this.messageProcessor.sipStack.getHostAddress();this.websocket=this.createWebSocket();this.wsMsgParser=new WSMsgParser(this)}WSMessageChannel.prototype.isReliable=function(){return!0};
WSMessageChannel.prototype.createWebSocket=function(){this.websocket=new WebSocket(this.wsurl,"sip");this.websocket.binaryType="arraybuffer";var a=this;this.websocket.onclose=function(){console.warn("WSMessageChannel:createWebSocket(): the websocket is closed");a.messageProcessor.sipStack.sipListener.processDisconnected();a.websocket=null};this.websocket.onopen=function(){console.info("WSMessageChannel:createWebSocket(): the websocket is opened");a.messageProcessor.sipStack.sipListener.processConnected()};
this.websocket.onerror=function(b){console.error("WSMessageChannel:createWebSocket(): websocket connection has failed:"+b);a.messageProcessor.sipStack.sipListener.processConnectionError(b)};this.websocket.onmessage=function(b){b.data instanceof ArrayBuffer?(b=String.fromCharCode.apply(null,new Uint8Array(b.data)),a.wsMsgParser.parsermessage(b)):"string"==typeof b.data?a.wsMsgParser.parsermessage(b.data):console.error("WSMessageChannel:onmessage(): bad data object type, event ignored")};return this.websocket};
WSMessageChannel.prototype.close=function(){this.websocket.close();this.websocket=null};WSMessageChannel.prototype.getSIPStack=function(){return this.messageProcessor.sipStack};WSMessageChannel.prototype.getTransport=function(){return this.transport};WSMessageChannel.prototype.sendMessage=function(a){a instanceof SIPRequest&&(this.requestsent=a);"string"!=typeof a&&(a=a.encode());this.websocket.send(a);console.info("SIP message sent: "+a)};
WSMessageChannel.prototype.getViaHeader=function(){var a=new Via;a.setTransport(this.getTransport());a.setSentBy(this.getHostPort());return a};WSMessageChannel.prototype.getViaHost=function(){return this.myAddress};WSMessageChannel.prototype.getViaHostPort=function(){var a=new HostPort;a.setHost(new Host(this.getViaHost()));return a};WSMessageChannel.prototype.getPeerAddress=function(){return null!=this.peerAddress?this.peerAddress:getHost()};WSMessageChannel.prototype.getHost=function(){return this.sipStack.getHostAddress()};
WSMessageChannel.prototype.createBadReqRes=function(a){var b="512SIP/2.0 400 Bad Request";if(!(this.copyViaHeaders(a,b)&&this.copyHeader(this.CSeqHeader,a,b)&&this.copyHeader(this.CallIdHeader,a,b)&&this.copyHeader(this.FromHeader,a,b)&&this.copyHeader(this.ToHeader,a,b)))return null;var c=b.indexOf(ToHeader.NAME);-1!=c&&-1==b.indexOf("tag",c)&&(b+=";tag=badreq");c=MessageFactoryImpl.prototype.getDefaultServerHeader();null!=c&&(b=b+"\r\n"+c.toString());c=a.length();var d=new ContentType("message",
"sipfrag");b=b+"\r\n"+d.toString();c=new ContentLength(c);b=b+"\r\n"+c.toString();return(b+"\r\n\r\n"+a).toString()};WSMessageChannel.prototype.copyHeader=function(a,b,c){a=b.indexOf(a);return-1!=a&&(c=b.indexOf("\r\n",a),-1!=c)?(b.substring(a-2,c),!0):!1};WSMessageChannel.prototype.copyViaHeaders=function(a,b){for(var c=a.indexOf(this.ViaHeader),d=!1;-1!=c;){var e=a.indexOf("\r\n",c);if(-1!=e)b+=a.substring(c-2,e),d=!0,c=a.indexOf(this.ViaHeader,e);else return!1}return d};
WSMessageChannel.prototype.getMessageProcessor=function(){return this.messageProcessor};WSMessageChannel.prototype.isSecure=function(){return!1};WSMessageChannel.prototype.getWebSocket=function(){return this.websocket};function WSMessageProcessor(a,b){this.classname="WSMessageProcessor";this.sipStack=a;this.wsMessageChannel=new WSMessageChannel(this,b);this.sentByHostPort=new HostPort;this.sentByHostPort.setHost(new Host(this.sipStack.getHostAddress()));this.sentBySet=this.sentBy=null}
WSMessageProcessor.prototype.getTransport=function(){return this.wsMessageChannel.getTransport()};WSMessageProcessor.prototype.getMessageChannel=function(){return this.wsMessageChannel};WSMessageProcessor.prototype.getSIPStack=function(){return this.sipStack};WSMessageProcessor.prototype.getInfoApp=function(){return this.infoApp};WSMessageProcessor.prototype.stop=function(){this.isRunning=!1;this.wsMessageChannels.close()};WSMessageProcessor.prototype.getMaximumMessageSize=function(){return 2147483647};
WSMessageProcessor.prototype.getViaHeader=function(){var a=new Via;if(null!=this.sentByHostPort)a.setSentBy(this.sentByHostPort);else{var b=new Host;b.setHostname(this.sipStack.getHostAddress());a.setHost(b)}a.setTransport(this.getTransport());a.setBranch(Utils.prototype.generateBranchId());return a};WSMessageProcessor.prototype.getDefaultTargetPort=function(){return 5060};WSMessageProcessor.prototype.isSecure=function(){return!1};WSMessageProcessor.prototype.getListeningPoint=function(){return this.listeningPoint};
WSMessageProcessor.prototype.setListeningPoint=function(a){this.listeningPoint=a};WSMessageProcessor.prototype.initialize=function(a,b){this.sipStack=b;this.infoApp=a};
WSMessageProcessor.prototype.setSentBy=function(a){var b=a.indexOf(":");if(-1==b)this.sentByHostPort=new HostPort,this.sentByHostPort.setHost(new Host(a));else{this.sentByHostPort=new HostPort;this.sentByHostPort.setHost(new Host(a.substring(0,b)));var c=a.substring(b+1);try{this.sentByHostPort.setPort(c)}catch(d){throw console.error("WSMessageProcessor:setSentBy(): bad format encountered at ",b),"WSMessageProcessor:setSentBy(): bad format encountered at "+b;}}this.sentBySet=!0;this.sentBy=a};
WSMessageProcessor.prototype.getSentBy=function(){null==this.sentBy&&null!=this.sentByHostPort&&(this.sentBy=this.sentByHostPort.toString());return this.sentBy};WSMessageProcessor.prototype.getPort=function(){return this.port};WSMessageProcessor.prototype.getDefaultPort=function(){return 5060};
function SIPDialog(){this.classname="SIPDialog";this.earlyDialogId=this.dialogId=this.lastTransaction=this.firstTransaction=this.lastResponse=this.originalRequest=this.applicationData=this.reInviteFlag=this.isAssigned=this.method=this.stackTrace=this.dialogTerminatedEventDelivered=null;this.localSequenceNumber=0;this.remoteSequenceNumber=-1;this.hisTag=this.myTag=null;this.routeList=new RouteList;this.sipStack=null;this.dialogState=this.NULL_STATE;this.ackSeen=!1;this.lastAckReceived=this.lastAckSent=
null;this.ackProcessed=!1;this.ackLine=this.originalLocalSequenceNumber=this.prevRetransmissionTicks=this.retransmissionTicksLeft=this.nextSeqno=null;this.auditTag=0;this.sipProvider=this.serverTransactionFlag=this.callIdHeader=this.remoteParty=this.localParty=null;this.terminateOnBye=!0;this.lastInviteOkReceived=this.eventHeader=this.remoteTarget=this.byeSent=null;this.reInviteWaitTime=100;this.isAcknowledged=null;this.highestSequenceNumberAcknowledged=-1;this.isBackToBackUserAgent=null;this.sequenceNumberValidation=
!0;this.eventListeners=[];this.firstTransactionIsServerTransaction=this.firstTransactionId=this.firstTransactionMethod=this.firstTransactionSeen=this.firstTransactionSecure=null;this.firstTransactionPort=5060;this.inviteTransaction=this.timer=this.contactHeader=null;if("SipProviderImpl"==arguments[0].classname)this.terminateOnBye=!0,this.routeList=new RouteList,this.dialogState=this.NULL_STATE,this.localSequenceNumber=0,this.remoteSequenceNumber=-1,this.sipProvider=arguments[0],2==arguments.length&&
(b=arguments[1],this.sipStack=this.sipProvider.getSipStack(),this.setLastResponse(null,b),this.originalLocalSequenceNumber=this.localSequenceNumber=b.getCSeq().getSeqNumber(),this.myTag=b.getFrom().getTag(),this.hisTag=b.getTo().getTag(),this.localParty=b.getFrom().getAddress(),this.remoteParty=b.getTo().getAddress(),this.method=b.getCSeq().getMethod(),this.callIdHeader=b.getCallId(),this.serverTransactionFlag=!1,this.isBackToBackUserAgent=this.sipStack.isBackToBackUserAgent,this.addEventListener(this.sipStack));
else{var a=arguments[0];this.sipProvider=a.getSipProvider();this.firstTransactionSeen=!1;this.terminateOnBye=!0;this.routeList=new RouteList;this.dialogState=this.NULL_STATE;this.localSequenceNumber=0;this.remoteSequenceNumber=-1;b=a.getRequest();this.callIdHeader=b.getCallId();this.earlyDialogId=b.getDialogId(!1);if(null==a)throw console.error("SIPDialog:SIPDialog(): null transcation argument"),"SIPDialog:SIPDialog(): null transcation argument";this.sipStack=a.sipStack;if(null==this.sipProvider)throw console.error("SIPDialog:SIPDialog(): null sip provider argument"),
"SIPDialog:SIPDialog(): null sip provider argument";this.addTransaction(a);if(2==arguments.length){var b=arguments[1];if(null==b)throw console.error("SIPDialog:SIPDialog(): null sip response argument"),"SIPDialog:SIPDialog(): null sip response argument";this.setLastResponse(a,b);this.isBackToBackUserAgent=this.sipStack.isBackToBackUserAgent}this.isBackToBackUserAgent=this.sipStack.isBackToBackUserAgent;this.addEventListener(this.sipStack)}}SIPDialog.prototype.NULL_STATE=-1;
SIPDialog.prototype.EARLY_STATE=0;SIPDialog.prototype.CONFIRMED_STATE=1;SIPDialog.prototype.TERMINATED_STATE=2;SIPDialog.prototype.DIALOG_LINGER_TIME=8;SIPDialog.prototype.TimeStampHeader="Timestamp";SIPDialog.prototype.TIMER_H=64;SIPDialog.prototype.TIMER_J=64;SIPDialog.prototype.BASE_TIMER_INTERVAL=500;SIPDialog.prototype.lingerTimeout=function(){null!=this.eventListeners&&(this.eventListeners=null);this.sipStack.removeDialog(this)};
SIPDialog.prototype.deferredDeleteTimeout=function(){throw"bug";};SIPDialog.prototype.dialogTimeout=function(){this.ackSeen||null==this.dialogTransactionTimeout||200==this.dialogTransactionTimeout.getLastResponse().getStatusCode()&&this.dialogTransactionTimeout.fireTimer();if(this.isAckSeen()||2==this.dialogState)this.dialogTransactionTimeout=null,clearInterval(this.timer)};
SIPDialog.prototype.deleteIfNoAckSentTimeout=function(a){this.seqno=a;if(this.highestSequenceNumberAcknowledged<a)if(this.dialogDeleteIfNoAckSentTask=null,this.isBackToBackUserAgent)if(this.sipProvider.getSipListener()instanceof SipListener)this.raiseErrorEvent(SIPDialogErrorEvent.DIALOG_ACK_NOT_SENT_TIMEOUT);else try{var b=this.createRequest("BYE");null!=MessageFactoryImpl.prototype.getDefaultUserAgentHeader()&&b.addHeader(MessageFactoryImpl.prototype.getDefaultUserAgentHeader());var c=new Reason;
c.setProtocol("SIP");c.setCause(1025);c.setText("Timed out waiting to send ACK");b.addHeader(c);var d=this.getSipProvider().getNewClientTransaction(b);this.sendRequest(d)}catch(e){console.error("SIPDialog:DialogDeleteIfNoAckSentTask(): catched exception:"+e),this.delet()}else this.sipProvider.getSipListener()instanceof SipListener?this.raiseErrorEvent(SIPDialogErrorEvent.DIALOG_ACK_NOT_SENT_TIMEOUT):this.delet()};
SIPDialog.prototype.ackReceived=function(a){if(!this.ackSeen){var b=this.getInviteTransaction();null!=b&&b.getCSeq()==a.getCSeq().getSeqNumber()&&(this.ackSeen=!0,this.setLastAckReceived(a),this.setRemoteTag(a.getFromTag()),this.setLocalTag(a.getToTag()),this.setDialogId(a.getDialogId(!0)),this.addRoute(a),this.setState(this.CONFIRMED_STATE),this.sipStack.putDialog(this))}};SIPDialog.prototype.isTerminatedOnBye=function(){return this.terminateOnBye?!0:!1};
SIPDialog.prototype.setState=function(a){this.dialogState=a;if(a==this.TERMINATED_STATE){var b=this;this.timer=setTimeout(function(){b.lingerTimeout()},1E3*this.DIALOG_LINGER_TIME)}};SIPDialog.prototype.getLocalTag=function(){return this.myTag};SIPDialog.prototype.isAckSeen=function(){return this.ackSeen};SIPDialog.prototype.getLastAckSent=function(){return this.lastAckSent};
SIPDialog.prototype.resendAck=function(){if(null!=this.getLastAckSent()){if(null!=this.getLastAckSent().getHeader(this.TimeStampHeader)&&this.sipStack.generateTimeStampHeader){var a=new TimeStamp;a.setTimeStamp((new Date).getTime());this.getLastAckSent().setHeader(a)}this.sendAck(this.getLastAckSent(),!1)}};SIPDialog.prototype.getMethod=function(){return this.method};SIPDialog.prototype.isBackToBackUserAgent=function(){return this.isBackToBackUserAgent};
SIPDialog.prototype.getState=function(){var a=null;this.dialogState==this.NULL_STATE&&(a=null);0==this.dialogState?a="EARLY":1==this.dialogState?a="CONFIRMED":2==this.dialogState&&(a="TERMINATED");return a};SIPDialog.prototype.delet=function(){this.setState(this.TERMINATED_STATE)};SIPDialog.prototype.isTerminatedOnBye=function(){return this.terminateOnBye};SIPDialog.prototype.getLastResponse=function(){return this.lastResponse};
SIPDialog.prototype.setLastResponse=function(a,b){this.callIdHeader=b.getCallId();var c=b.getStatusCode();if(100!=c)if(this.lastResponse=b,this.setAssigned(),"TERMINATED"==this.getState())"INVITE"==b.getCSeq().getMethod()&&200==c&&(this.lastInviteOkReceived=Math.max(b.getCSeq().getSeqNumber(),this.lastInviteOkReceived));else{var d=b.getCSeq().getMethod();if(null==a||a instanceof SIPClientTransaction)if(this.sipStack.isDialogCreated(d)){if(null==this.getState()&&100<=c&&199>=c?(this.setState(this.EARLY_STATE),
null==b.getToTag()&&!this.sipStack.rfc2543Supported||null!=this.getRemoteTag()||(this.setRemoteTag(b.getToTag()),this.setDialogId(b.getDialogId(!1)),this.sipStack.putDialog(this),this.addRoute(b))):null!=this.getState()&&"EARLY"==this.getState()&&100<=c&&199>=c?d!=this.getMethod()||null==a||null==b.getToTag()&&!this.sipStack.rfc2543Supported||(this.setRemoteTag(b.getToTag()),this.setDialogId(b.getDialogId(!1)),this.sipStack.putDialog(this),this.addRoute(b)):200<=c&&299>=c?(d!=this.getMethod()||null==
b.getToTag()&&!this.sipStack.rfc2543Supported||"CONFIRMED"==this.getState()||(this.setRemoteTag(b.getToTag()),this.setDialogId(b.getDialogId(!1)),this.sipStack.putDialog(this),this.addRoute(b),this.setState(this.CONFIRMED_STATE)),"INVITE"==d&&(this.lastInviteOkReceived=Math.max(b.getCSeq().getSeqNumber(),this.lastInviteOkReceived))):300<=c&&699>=c&&(null==this.getState()||d==this.getMethod()&&"EARLY"==this.getState())&&this.setState(this.TERMINATED_STATE),"CONFIRMED"!=this.getState()&&"TERMINATED"!=
this.getState()&&null!=this.originalRequest&&(b=this.originalRequest.getRecordRouteHeaders(),null!=b))for(c=b.length;0<=c;c--)if(d=b[c],a=this.routeList.getFirst(),null!=a&&d.getAddress()==a.getAddress())this.routeList.removeFirst();else break}else"NOTIFY"!=d||"SUBSCRIBE"!=this.getMethod()&&"REFER"!=this.getMethod()||2!=b.getStatusCode()/100||null!=this.getState()?"BYE"==d&&2==c/100&&this.isTerminatedOnBye()&&this.setState(this.TERMINATED_STATE):(this.setDialogId(b.getDialogId(!0)),this.sipStack.putDialog(this),
this.setState(this.CONFIRMED_STATE));else"BYE"==d&&2==c/100&&this.isTerminatedOnBye()?this.setState(this.TERMINATED_STATE):(a=!1,null==this.getLocalTag()&&null!=b.getTo().getTag()&&this.sipStack.isDialogCreated(d)&&d==this.getMethod()&&(this.setLocalTag(b.getTo().getTag()),a=!0),2!=c/100?1==c/100?a&&(this.setState(this.EARLY_STATE),this.setDialogId(b.getDialogId(!0)),this.sipStack.putDialog(this)):this.isReInvite()||this.getState()==this.CONFIRMED||this.setState(SIPDialog.TERMINATED_STATE):(this.dialogState<=
this.EARLY_STATE&&("INVITE"==d||"SUBSCRIBE"==d||"REFER"==d)&&this.setState(this.CONFIRMED_STATE),a&&(this.setDialogId(b.getDialogId(!0)),this.sipStack.putDialog(this))))}};SIPDialog.prototype.getDialogId=function(){null==this.dialogId&&null!=this.lastResponse&&(this.dialogId=this.lastResponse.getDialogId(this.isServer()));return this.dialogId};SIPDialog.prototype.isAssignedFunction=function(){return this.isAssigned};
SIPDialog.prototype.setResponseTags=function(a){if(null==this.getLocalTag()&&null==this.getRemoteTag()){var b=a.getFromTag();null!=b&&(b==this.getLocalTag()?a.setToTag(this.getRemoteTag()):b==this.getRemoteTag()&&a.setToTag(this.getLocalTag()))}};SIPDialog.prototype.getSipProvider=function(){return this.sipProvider};
SIPDialog.prototype.sendAck=function(a){if("ACK"==!a.getMethod())throw console.error("SIPDialog:sendAck(): bad request method -- should be ACK"),"SIPDialog:sendAck(): bad request method -- should be ACK";if(null==this.getState()||"EARLY"==this.getState())throw console.error("SIPDialog:sendAck(): bad dialog state "+this.getState()),"SIPDialog:sendAck(): bad dialog state "+this.getState();if(this.getCallId().getCallId()!=a.getCallId().getCallId())throw console.error("SIPDialog:sendAck(): bad call ID in request"),
"SIPDialog:sendAck(): bad call ID in request";try{null!=this.getLocalTag()&&a.getFrom().setTag(this.getLocalTag()),null!=this.getRemoteTag()&&a.getTo().setTag(this.getRemoteTag())}catch(d){throw console.error("SIPDialog:sendAck(): catched exception:"+d),"SIPDialog:sendAck(): catched exception:"+d;}var b=this.sipStack.getNextHop(a);if(null==b)throw console.error("SIPDialog:sendAck(): no route!"),"SIPDialog:sendAck(): no route!";var c=this.sipProvider.getListeningPoint(b.getTransport());if(null==c){console.warn("SIPDialog:sendAck(): no listening point for this provider registered at "+
b+"; transport == "+b.getTransport());c=this.sipProvider.getDefaultListeningPoint();if(null==c)throw"SIPDialog:sendAck(): no listening point for this provider registered at "+b+"; transport == "+b.getTransport();console.warn("using default listening point")}b=c.getMessageProcessor().getMessageChannel();this.setLastAckSent(a);b.sendMessage(a);this.isAcknowledged=!0;this.highestSequenceNumberAcknowledged=Math.max(this.highestSequenceNumberAcknowledged,a.getCSeq().getSeqNumber());this.ackSeen=!0};
SIPDialog.prototype.getRemoteTag=function(){return this.hisTag};SIPDialog.prototype.isServer=function(){return 0==this.firstTransactionSeen?this.serverTransactionFlag:this.firstTransactionIsServerTransaction};
SIPDialog.prototype.addTransaction=function(a){var b=a.getOriginalRequest();this.firstTransactionSeen&&this.firstTransactionId!=a.getBranchId()&&a.getMethod()==this.firstTransactionMethod&&(this.reInviteFlag=!0);0==this.firstTransactionSeen?(this.storeFirstTransactionInfo(this,a),"SUBSCRIBE"==b.getMethod()&&(this.eventHeader=b.getHeader("Event")),this.setLocalParty(b),this.setRemoteParty(b),this.setCallId(b),null==this.originalRequest&&(this.originalRequest=b),null==this.method&&(this.method=b.getMethod()),
a instanceof SIPServerTransaction?this.hisTag=b.getFrom().getTag():(this.setLocalSequenceNumber(b.getCSeq().getSeqNumber()),this.originalLocalSequenceNumber=this.localSequenceNumber,this.myTag=b.getFrom().getTag())):a.getMethod()==this.firstTransactionMethod&&this.firstTransactionIsServerTransaction!=a.isServerTransaction()&&(this.storeFirstTransactionInfo(this,a),this.setLocalParty(b),this.setRemoteParty(b),this.setCallId(b),this.originalRequest=b,this.method=b.getMethod());a instanceof SIPServerTransaction&&
this.setRemoteSequenceNumber(b.getCSeq().getSeqNumber());this.lastTransaction=a};SIPDialog.prototype.storeFirstTransactionInfo=function(a,b){a.firstTransaction=b;a.firstTransactionSeen=!0;a.firstTransactionIsServerTransaction=b.isServerTransaction();a.firstTransactionSecure=!0;a.firstTransactionId=b.getBranchId();a.firstTransactionMethod=b.getMethod();a.isServer()?(b=b.getLastResponse(),a.contactHeader=null!=b?b.getContactHeader():null):null!=b&&(b=b.getOriginalRequest(),a.contactHeader=b.getContactHeader())};
SIPDialog.prototype.setLocalParty=function(a){this.isServer()?this.localParty=a.getTo().getAddress():this.localParty=a.getFrom().getAddress()};SIPDialog.prototype.setRemoteParty=function(a){this.isServer()?this.remoteParty=a.getFrom().getAddress():this.remoteParty=a.getTo().getAddress()};SIPDialog.prototype.setCallId=function(a){this.callIdHeader=a.getCallId()};SIPDialog.prototype.setLocalSequenceNumber=function(a){this.localSequenceNumber=a};SIPDialog.prototype.getLocalParty=function(){return this.localParty};
SIPDialog.prototype.getRemoteParty=function(){return this.remoteParty};SIPDialog.prototype.addEventListener=function(a){for(var b=null,c=0;c<this.eventListeners;c++)this.eventListeners[c]==a&&(b=c);null==b&&this.eventListeners.push(a)};SIPDialog.prototype.setAssigned=function(){this.isAssigned=!0};SIPDialog.prototype.testAndSetIsDialogTerminatedEventDelivered=function(){var a=this.dialogTerminatedEventDelivered;this.dialogTerminatedEventDelivered=!0;return a};
SIPDialog.prototype.getFirstTransaction=function(){return this.firstTransaction};SIPDialog.prototype.isClientDialog=function(){return this.getFirstTransaction()instanceof SIPClientTransaction?!0:!1};SIPDialog.prototype.addRoute=function(a){a instanceof SIPResponse?this.addRouteResponse(a):a instanceof SIPRequest?this.addRouteRequest(a):this.addRouteList(a)};
SIPDialog.prototype.addRouteResponse=function(a){if(100!=a.getStatusCode()&&2!=this.dialogState)if(1==this.dialogState){if(200<=a.getStatusCode()&&299>=a.getStatusCode()&&!this.isServer()){var b=a.getContactHeaders();null!=b&&SIPRequest.prototype.isTargetRefresh(a.getCSeq().getMethod())&&this.setRemoteTarget(b.getFirst())}}else this.isServer()||("CONFIRMED"!=this.getState()&&"TERMINATED"!=this.getState()&&(a=a.getRecordRouteHeaders(),null!=a?this.addRoute(a):this.routeList=new RouteList),null!=b&&
this.setRemoteTarget(b.getFirst()))};SIPDialog.prototype.addRouteRequest=function(a){"CONFIRMED"==this.dialogState&&SIPRequest.prototype.isTargetRefresh(a.getMethod())&&this.doTargetRefresh(a);if("CONFIRMED"!=this.dialogState&&"TERMINATED"!=this.dialogState&&null==a.getToTag()){var b=a.getRecordRouteHeaders();null!=b?this.addRoute(b):this.routeList=new RouteList;a=a.getContactHeaders();null!=a&&this.setRemoteTarget(a.getFirst())}};
SIPDialog.prototype.addRouteList=function(a){if(this.isClientDialog()){this.routeList=new RouteList;for(var b=a.getHeaderList().length-1;0<=b;b--){var c=a.getHeaderList()[b],d=new Route;d.setAddress(c.getAddress());d.setParameters(c.getParameters());this.routeList.add(d)}}else for(this.routeList=new RouteList,b=0;b<a.getHeaderList().length;b++)c=a.getHeaderList()[b],d=new Route,d.setAddress(c.getAddress()),d.setParameters(c.getParameters()),this.routeList.add(d)};
SIPDialog.prototype.setRemoteTarget=function(a){this.remoteTarget=a.getAddress()};SIPDialog.prototype.getRouteList=function(){return this.routeList};SIPDialog.prototype.setRouteList=function(a){this.routeList=a};SIPDialog.prototype.setStack=function(a){this.sipStack=a};SIPDialog.prototype.getStack=function(){return this.sipStack};SIPDialog.prototype.removeEventListener=function(a){for(var b=null,c=0;c<this.eventListeners.length;c++)this.eventListeners[c]==a&&(b=c);this.eventListeners.splice(b,1)};
SIPDialog.prototype.setApplicationData=function(a){this.applicationData=a};SIPDialog.prototype.getApplicationData=function(){return this.applicationData};SIPDialog.prototype.requestConsumed=function(){this.nextSeqno=this.getRemoteSeqNumber()+1};
SIPDialog.prototype.isRequestConsumable=function(a){if("ACK"==a.getMethod())throw console.error("SIPDialog:isRequestConsumable(): Illegal method"),"SIPDialog:isRequestConsumable(): Illegal method";return this.isSequnceNumberValidation()?Number(this.remoteSequenceNumber)<=Number(a.getCSeq().getSeqNumber())?!0:!1:!0};SIPDialog.prototype.doDeferredDelete=function(){var a=this;this.timer=setTimeout(function(){a.deferredDeleteTimeout()},this.TIMER_H*this.BASE_TIMER_INTERVAL)};
SIPDialog.prototype.isAckSent=function(a){return null==this.getLastTransaction()?!0:this.getLastTransaction()instanceof SIPClientTransaction?null==this.getLastAckSent()?!1:a<=this.getLastAckSent().getCSeq().getSeqNumber():!0};SIPDialog.prototype.getRouteSet=function(){return null==this.routeList?this.routeList=[]:this.getRouteList()};SIPDialog.prototype.setDialogId=function(a){this.dialogId=a};
SIPDialog.prototype.createFromNOTIFY=function(a,b){var c=new SIPDialog(b);c.serverTransactionFlag=!1;c.lastTransaction=a;storeFirstTransactionInfo(c,a);c.terminateOnBye=!1;c.localSequenceNumber=a.getCSeq();b=b.getRequest();c.remoteSequenceNumber=b.getCSeq().getSeqNumber();c.setDialogId(b.getDialogId(!0));c.setLocalTag(b.getToTag());c.setRemoteTag(b.getFromTag());c.setLastResponse(a,a.getLastResponse());c.localParty=b.getTo().getAddress();c.remoteParty=b.getFrom().getAddress();c.addRoute(b);c.setState(this.CONFIRMED_STATE);
return c};SIPDialog.prototype.isReInvite=function(){return this.reInviteFlag};SIPDialog.prototype.setRemoteTag=function(a){if(null!=this.hisTag&&null!=a&&a!=this.hisTag){if("EARLY"==this.getState()&&this.sipStack.isRemoteTagReassignmentAllowed()){var b=!1;this.sipStack.getDialog(this.dialogId)==this&&(this.sipStack.removeDialog(this),b=!0);this.dialogId=null;this.hisTag=a;b&&this.sipStack.putDialog(this)}}else null!=a&&(this.hisTag=a)};SIPDialog.prototype.getLastTransaction=function(){return this.lastTransaction};
SIPDialog.prototype.getInviteTransaction=function(){return this.inviteTransaction};SIPDialog.prototype.setInviteTransaction=function(a){this.inviteTransaction=a};SIPDialog.prototype.setLocalSequenceNumber=function(a){if(a<=this.localSequenceNumber)throw console.error("SIPDialog:setLocalSequenceNumber(): sequence number should not decrease !"),"SIPDialog:setLocalSequenceNumber(): sequence number should not decrease !";this.localSequenceNumber=a};
SIPDialog.prototype.setRemoteSequenceNumber=function(a){this.remoteSequenceNumber=a};SIPDialog.prototype.incrementLocalSequenceNumber=function(){++this.localSequenceNumber};SIPDialog.prototype.getOriginalLocalSequenceNumber=function(){return this.originalLocalSequenceNumber};SIPDialog.prototype.getLocalSeqNumber=function(){return this.localSequenceNumber};SIPDialog.prototype.getRemoteSeqNumber=function(){return this.remoteSequenceNumber};SIPDialog.prototype.setLocalTag=function(a){this.myTag=a};
SIPDialog.prototype.getCallId=function(){return this.callIdHeader};SIPDialog.prototype.getRemoteTarget=function(){return this.remoteTarget};SIPDialog.prototype.isSecure=function(){return this.firstTransactionSecure};SIPDialog.prototype.createRequest=function(){if(1==arguments.length){var a=arguments[0];return this.createRequestargu1(a)}a=arguments[0];return this.createRequestargu2(a,arguments[1])};
SIPDialog.prototype.createRequestargu1=function(a){if("ACK"==a)throw console.error("SIPDialog:createRequestargu1(): invalid method specified for createRequest:"+a),"SIPDialog:createRequestargu1(): invalid method specified for createRequest:"+a;if(null!=this.lastResponse)return this.createRequest(a,this.lastResponse);console.error("SIPDialog:createRequestargu1(): dialog not yet established -- no response!");throw"SIPDialog:createRequestargu1(): dialog not yet established -- no response!";};
SIPDialog.prototype.createRequestargu2=function(a,b){if(null==a||null==b)throw console.error("SIPDialog:createRequestargu2(): null argument"),"SIPDialog:createRequestargu2(): null argument";if("CANCEL"==a)throw console.error("SIPDialog:createRequestargu2(): invalid request"),"SIPDialog:createRequestargu2(): invalid request";if(null==this.getState()||"TERMINATED"==this.getState()&&"BYE"!=a.toUpperCase()||this.isServer()&&"EARLY"==this.getState()&&"BYE"==a.toUpperCase())throw console.error("SIPDialog:createRequestargu2(): dialog  "+
this.getDialogId()+" not yet established or terminated "+this.getState()),"SIPDialog:createRequestargu2(): dialog  "+this.getDialogId()+" not yet established or terminated "+this.getState();if(this.isServer()){var c=this.getInviteTransaction().getOriginalRequest().getContactHeader();c=c.getAddress().getURI()}else c=b.getContactHeader().getAddress().getURI();var d=new CSeq;d.setMethod(a);d.setSeqNumber(this.getLocalSeqNumber()+1);"SUBSCRIBE"==a&&null!=this.eventHeader&&g.addHeader(this.eventHeader);
g=this.sipProvider.getListeningPoint(b.getTopmostVia().getTransport());if(null==g)throw console.error("SIPDialog:createRequestargu2(): cannot find listening point for transport "+b.getTopmostVia().getTransport()),"SIPDialog:createRequestargu2(): cannot find listening point for transport "+b.getTopmostVia().getTransport();g=g.getViaHeader();var e=new From;e.setAddress(this.localParty);var f=new To;f.setAddress(this.remoteParty);null!=this.getLocalTag()?e.setTag(this.getLocalTag()):e.removeTag();null!=
this.getRemoteTag()?f.setTag(this.getRemoteTag()):f.removeTag();var g=b.createRequest(c,g,d,e,f);SIPRequest.prototype.isTargetRefresh(a)&&(c=this.sipProvider.getListeningPoint(b.getTopmostVia().getTransport()).createContactHeader(),c.getAddress().getURI().setSecure(this.isSecure()),g.setHeader(c));this.updateRequest(g);return g};
SIPDialog.prototype.sendRequest=function(a){var b=a.getOriginalRequest();if(null==a)throw console.error("SIPDialog:sendRequest(): null parameter"),"SIPDialog:sendRequest(): null parameter";if("ACK"==b.getMethod()||"CANCEL"==b.getMethod())throw console.error("SIPDialog:sendRequest(): bad request method. "+b.getMethod()),"SIPDialog:sendRequest(): bad request method. "+b.getMethod();if(this.byeSent&&this.isTerminatedOnBye()&&"BYE"!=b.getMethod())throw console.error("SIPDialog:sendRequest(): cannot send request; BYE already sent"),
"SIPDialog:sendRequest(): cannot send request; BYE already sent";if(null==b.getTopmostVia()){var c=a.getOutgoingViaHeader();b.addHeader(c)}if(this.getCallId().getCallId().toLowerCase()!=b.getCallId().getCallId().toLowerCase())throw console.error("SIPDialog:sendRequest(): bad call ID in request"),"SIPDialog:sendRequest(): bad call ID in request";a.setDialog(this,this.dialogId);this.addTransaction(a);a.isMapped=!0;c=b.getFrom();var d=b.getTo();if(null!=this.getLocalTag()&&null!=c.getTag()&&c.getTag()!=
this.getLocalTag())throw console.error("SIPDialog:sendRequest(): from tag mismatch expecting  "+this.getLocalTag()),"SIPDialog:sendRequest(): from tag mismatch expecting  "+this.getLocalTag();if(null==this.getLocalTag()&&"NOTIFY"==b.getMethod()){if("SUBSCRIBE"!=this.getMethod())throw console.error("SIPDialog:sendRequest(): trying to send NOTIFY without SUBSCRIBE Dialog!"),"SIPDialog:sendRequest(): trying to send NOTIFY without SUBSCRIBE Dialog!";this.setLocalTag(c.getTag())}null!=this.getLocalTag()&&
c.setTag(this.getLocalTag());null!=this.getRemoteTag()&&d.setTag(this.getRemoteTag());c=this.sipStack.getChannel();if(null==c){c=this.sipStack.getRouter(b).getOutboundProxy();if(null==c)throw console.error("SIPDialog:sendRequest(): no route found!"),"SIPDialog:sendRequest(): no route found!";c=this.sipStack.createRawMessageChannel(this.getSipProvider().getListeningPoint(c.getTransport()).getHostAddress(),this.firstTransactionPort,c);null!=c&&a.setEncapsulatedChannel(c)}else a.setEncapsulatedChannel(c);
null!=c&&c.useCount++;b.getCSeq().setSeqNumber(this.getLocalSeqNumber());try{a.sendMessage(b),"BYE"==b.getMethod()&&(this.byeSent=!0,this.isTerminatedOnBye()&&this.setState(this.TERMINATED_STATE))}catch(e){throw console.error("SIPDialog:sendRequest():  catched execption, error sending message",e),"SIPDialog:sendRequest():  catched execption, error sending message";}};
SIPDialog.prototype.startTimer=function(a){if(this.dialogTransactionTimeout!=a)if(this.ackSeen=!1,null!=this.dialogTransactionTimeout)this.dialogTransactionTimeout=a;else{this.dialogTransactionTimeout=a;var b=this;this.timer=b.timer=setInterval(function(){b.dialogTimeout()},b.BASE_TIMER_INTERVAL);console.error("SIPDialog:startTimer(): that.timer=setInterval()="+this.timer)}};
SIPDialog.prototype.stopTimer=function(){null!=this.dialogTransactionTimeout&&(clearInterval(this.timer),this.dialogTransactionTimeout=null)};SIPDialog.prototype.updateRequest=function(a){var b=this.getRouteList();b.isEmpty()?a.removeHeader("Route"):a.setHeader(b);null!=MessageFactoryImpl.prototype.getDefaultUserAgentHeader()&&a.setHeader(MessageFactoryImpl.prototype.getDefaultUserAgentHeader())};
SIPDialog.prototype.createAck=function(a){if("INVITE"!=this.method)throw console.error("SIPDialog:createAck(): dialog was not created with an INVITE"+this.method),"SIPDialog:createAck(): dialog was not created with an INVITE"+this.method;if(0>=a)throw console.error("SIPDialog:createAck(): bad cseq <= 0"),"SIPDialog:createAck(): bad cseq <= 0";if(null==this.remoteTarget)throw console.error("SIPDialog:createAck(): cannot create ACK - no remote Target!"),"SIPDialog:createAck(): cannot create ACK - no remote Target!";
if(this.lastInviteOkReceived<a)throw console.error("SIPDialog:createAck(): dialog not yet established -- no OK response!"),"SIPDialog:createAck(): dialog not yet established -- no OK response!";try{var b=null;b=null==this.routeList||this.routeList.isEmpty()?this.remoteTarget.getURI():this.routeList.getFirst().getAddress().getURI();var c=b.getTransportParam();null==c&&(c="WSS");if(null==this.sipProvider.getListeningPoint(c))throw console.error("SIPDialog:createAck(): cannot create ACK - no ListeningPoint for transport towards next hop found:"+
c),"SIPDialog:createAck(): cannot create ACK - no ListeningPoint for transport towards next hop found:"+c;var d=new SIPRequest;d.setMethod("ACK");d.setRequestURI(getRemoteTarget().getURI());d.setCallId(this.callIdHeader);d.setCSeq(new CSeq(a,"ACK"));a=[];var e=this.lastResponse.getTopmostVia();e.removeParameters();if(null!=this.originalRequest&&null!=this.originalRequest.getTopmostVia()){var f=this.originalRequest.getTopmostVia().getParameters();null!=f&&0<f.size()&&e.setParameters(f.clone())}e.setBranch(Utils.prototype.generateBranchId());
a.add(e);d.setVia(a);var g=new From;g.setAddress(this.localParty);g.setTag(this.myTag);d.setFrom(g);var h=new To;h.setAddress(this.remoteParty);null!=this.hisTag&&h.setTag(this.hisTag);d.setTo(h);d.setMaxForwards(new MaxForwards(70));if(null!=this.originalRequest){var k=this.originalRequest.getAuthorization();null!=k&&d.setHeader(k)}this.updateRequest(d);return d}catch(l){throw console.error("SIPDialog:createAck(): catched unexpected exception ",l),"SIPDialog:createAck(): catched unexpected exception";
}};SIPDialog.prototype.setSipProvider=function(a){this.sipProvider=a};SIPDialog.prototype.doTargetRefresh=function(a){a=a.getContactHeaders();null!=a&&(a=a.getFirst(),this.setRemoteTarget(a))};
SIPDialog.prototype.createReliableProvisionalResponse=function(a){if(!this.firstTransactionIsServerTransaction)throw console.error("SIPDialog:createReliableProvisionalResponse(): not a Server Dialog!"),"SIPDialog:createReliableProvisionalResponse(): not a Server Dialog!";if(100>=a||199<a)throw console.error("SIPDialog:createReliableProvisionalResponse(): bad status code "),"SIPDialog:createReliableProvisionalResponse(): bad status code ";var b=this.originalRequest;if("INVITE"!=b.getMethod())throw console.error("SIPDialog:createReliableProvisionalResponse(): bad method"),
"SIPDialog:createReliableProvisionalResponse(): bad method";var c=b.getHeaders("Supported");if(null==c&&!optionPresent(c,"100rel")&&(c=b.getHeaders("Require"),null==c&&!optionPresent(c,"100rel")))throw console.error("SIPDialog:createReliableProvisionalResponse(): no Supported/Require 100rel header in the request"),"SIPDialog:createReliableProvisionalResponse(): no Supported/Require 100rel header in the request";a=b.createResponse(a);c=new Require;c.setOptionTag("100rel");a.addHeader(c);(new RSeq).setSeqNumber("1L");
b=b.getRecordRouteHeaders();null!=b&&a.setHeader(b);return a};
SIPDialog.prototype.sendReliableProvisionalResponse=function(a){if(!this.isServer())throw console.error("SIPDialog:sendReliableProvisionalResponse(): not a Server Dialog!"),"SIPDialog:sendReliableProvisionalResponse(): not a Server Dialog!";if(100==a.getStatusCode())throw console.error("SIPDialog:sendReliableProvisionalResponse(): cannot send 100 as a reliable provisional response"),"SIPDialog:sendReliableProvisionalResponse(): cannot send 100 as a reliable provisional response";if(2<a.getStatusCode()/
100)throw console.error("SIPDialog:sendReliableProvisionalResponse(): response code is not a 1xx response - should be in the range 101 to 199 "),"SIPDialog:sendReliableProvisionalResponse(): response code is not a 1xx response - should be in the range 101 to 199 ";if(null==a.getToTag())throw console.error("SIPDialog:sendReliableProvisionalResponse(): badly formatted response -- To tag mandatory for Reliable Provisional Response"),"SIPDialog:sendReliableProvisionalResponse(): badly formatted response -- To tag mandatory for Reliable Provisional Response";
var b=a.getHeaders("Require"),c=!1;if(null!=b)for(var d=0;d<b.length&&!c;d++)"100rel"==b[d].getOptionTag().toLowerCase()&&(c=!0);c||(b=new Require("100rel"),a.addHeader(b));b=this.getFirstTransaction();this.setLastResponse(b,a);this.setDialogId(a.getDialogId(!0));b.sendReliableProvisionalResponse(a)};SIPDialog.prototype.terminateOnBye=function(a){this.terminateOnBye=a};SIPDialog.prototype.getMyContactHeader=function(){return this.contactHeader};SIPDialog.prototype.handleAck=function(){return!0};
SIPDialog.prototype.setEarlyDialogId=function(a){this.earlyDialogId=a};SIPDialog.prototype.getEarlyDialogId=function(){return this.earlyDialogId};SIPDialog.prototype.optionPresent=function(a,b){for(var c=0;c<a.length;c++){var d=a[c];if(null!=d&&b.toLowerCase()==d.getOptionTag().toLowerCase())return!0}return!1};SIPDialog.prototype.setLastAckReceived=function(a){this.lastAckReceived=a};SIPDialog.prototype.getLastAckReceived=function(){return this.lastAckReceived};
SIPDialog.prototype.setLastAckSent=function(a){this.lastAckSent=a};SIPDialog.prototype.isAtleastOneAckSent=function(){return this.isAcknowledged};SIPDialog.prototype.isBackToBackUserAgent=function(){return this.isBackToBackUserAgent};SIPDialog.prototype.doDeferredDeleteIfNoAckSent=function(a){if(null==this.dialogDeleteIfNoAckSentTimer){var b=this;this.dialogDeleteIfNoAckSentTimer=setTimeout(function(){b.deleteIfNoAckSentTimeout(a)},this.TIMER_J*this.BASE_TIMER_INTERVAL)}};
SIPDialog.prototype.setBackToBackUserAgent=function(){this.isBackToBackUserAgent=!0};SIPDialog.prototype.getEventHeader=function(){return this.eventHeader};SIPDialog.prototype.setEventHeader=function(a){this.eventHeader=a};SIPDialog.prototype.setServerTransactionFlag=function(a){this.serverTransactionFlag=a};SIPDialog.prototype.setReInviteFlag=function(a){this.reInviteFlag=a};SIPDialog.prototype.isSequnceNumberValidation=function(){return this.sequenceNumberValidation};
SIPDialog.prototype.disableSequenceNumberValidation=function(){this.sequenceNumberValidation=!1};SIPDialog.prototype.raiseErrorEvent=function(a){for(var b,c=new SIPDialogErrorEvent(this,a),d=0;d<this.eventListeners.length;d++)b=this.eventListeners[d],b.dialogErrorEvent(c);this.eventListeners=[];a!=SIPDialogErrorEvent.DIALOG_ACK_NOT_SENT_TIMEOUT&&a!=SIPDialogErrorEvent.DIALOG_ACK_NOT_RECEIVED_TIMEOUT&&a!=SIPDialogErrorEvent.DIALOG_REINVITE_TIMEOUT&&this.delet();this.stopTimer()};
function SIPDialogErrorEvent(a,b){this.classname="SIPDialogErrorEvent";this.errorID=b;this.source=a}SIPDialogErrorEvent.prototype.DIALOG_ACK_NOT_RECEIVED_TIMEOUT=1;SIPDialogErrorEvent.prototype.DIALOG_ACK_NOT_SENT_TIMEOUT=2;SIPDialogErrorEvent.prototype.DIALOG_REINVITE_TIMEOUT=3;SIPDialogErrorEvent.prototype.getErrorID=function(){return this.errorID};SIPDialogErrorEvent.prototype.getSource=function(){return this.source};function SIPDialogEventListener(a){this.classname="SIPDialogEventListener"}
SIPDialogEventListener.prototype.dialogErrorEvent=function(){};
function SIPTransaction(a,b){this.classname="SIPTransaction";this.transactionId=this.isMapped=this.lastResponse=this.applicationData=this.toListener=null;this.auditTag=0;this.sipStack=a;this.originalRequest=null;this.encapsulatedChannel=b;this.disableTimeoutTimer();this.eventListeners=[];this.addEventListener(a);this.transactionTimerStarted=!1;this.terminatedEventDelivered=this.fromTag=this.toTag=this.collectionTime=this.callId=this.event=this.to=this.from=this.timeoutTimerTicksLeft=this.currentState=
this.cSeq=this.method=this.branch=null}SIPTransaction.prototype.constructor=SIPTransaction;SIPTransaction.prototype.BASE_TIMER_INTERVAL=500;SIPTransaction.prototype.T4=5E3/SIPTransaction.prototype.BASE_TIMER_INTERVAL;SIPTransaction.prototype.T2=4E3/SIPTransaction.prototype.BASE_TIMER_INTERVAL;SIPTransaction.prototype.TIMER_I=SIPTransaction.prototype.T4;SIPTransaction.prototype.TIMER_K=SIPTransaction.prototype.T4;SIPTransaction.prototype.TIMER_D=32E3/SIPTransaction.prototype.BASE_TIMER_INTERVAL;
SIPTransaction.prototype.T1=1;SIPTransaction.prototype.TIMER_A=1;SIPTransaction.prototype.TIMER_B=64;SIPTransaction.prototype.TIMER_J=64;SIPTransaction.prototype.TIMER_F=64;SIPTransaction.prototype.TIMER_H=64;SIPTransaction.prototype.INITIAL_STATE=null;SIPTransaction.prototype.TRYING_STATE="TRYING";SIPTransaction.prototype.CALLING_STATE="CALLING";SIPTransaction.prototype.PROCEEDING_STATE="PROCEEDING";SIPTransaction.prototype.COMPLETED_STATE="COMPLETED";SIPTransaction.prototype.CONFIRMED_STATE="CONFIRMED";
SIPTransaction.prototype.TERMINATED_STATE="TERMINATED";SIPTransaction.prototype.MAXIMUM_RETRANSMISSION_TICK_COUNT=8;SIPTransaction.prototype.TIMEOUT_RETRANSMIT=3;SIPTransaction.prototype.CONNECTION_LINGER_TIME=8;SIPTransaction.prototype.lingerTimer=function(){this.getSIPStack().removeTransaction(this)};SIPTransaction.prototype.getBranchId=function(){return this.branch};
SIPTransaction.prototype.setOriginalRequest=function(a){null!=this.originalRequest&&this.originalRequest.getTransactionId()!=a.getTransactionId()&&this.sipStack.removeTransactionHash(this);this.originalRequest=a;this.method=a.getMethod();this.from=a.getFrom();this.to=a.getTo();this.toTag=this.to.getTag();this.fromTag=this.from.getTag();this.callId=a.getCallId();this.cSeq=a.getCSeq().getSeqNumber();this.event=a.getHeader("Event");this.transactionId=a.getTransactionId();this.originalRequest.setTransaction(this);
var b=a.getViaHeaders().getFirst().getBranch();null!=b?this.setBranch(b):this.setBranch(a.getTransactionId())};SIPTransaction.prototype.getOriginalRequest=function(){return this.originalRequest};SIPTransaction.prototype.getRequest=function(){return this.originalRequest};SIPTransaction.prototype.isInviteTransaction=function(){return"INVITE"==this.getMethod()?!0:!1};SIPTransaction.prototype.isCancelTransaction=function(){return"CANCEL"==this.getMethod()?!0:!1};
SIPTransaction.prototype.isByeTransaction=function(){return"BYE"==this.getMethod()?!0:!1};SIPTransaction.prototype.getMessageChannel=function(){return this.encapsulatedChannel};SIPTransaction.prototype.setBranch=function(a){this.branch=a};SIPTransaction.prototype.getBranch=function(){null==this.branch&&(this.branch=this.getOriginalRequest().getTopmostVia().getBranch());return this.branch};SIPTransaction.prototype.getMethod=function(){return this.method};SIPTransaction.prototype.getCSeq=function(){return this.cSeq};
SIPTransaction.prototype.setState=function(a){"COMPLETED"==this.currentState&&"TERMINATED"!=a&&"CONFIRMED"!=a&&(a="COMPLETED");"CONFIRMED"==this.currentState&&"TERMINATED"!=a&&(a="CONFIRMED");"TERMINATED"!=this.currentState?this.currentState=a:a=this.currentState;currentState=a};SIPTransaction.prototype.getState=function(){return this.currentState};SIPTransaction.prototype.enableTimeoutTimer=function(a){this.timeoutTimerTicksLeft=a};
SIPTransaction.prototype.disableTimeoutTimer=function(){this.timeoutTimerTicksLeft=-1};SIPTransaction.prototype.fireTimer=function(){-1!=this.timeoutTimerTicksLeft&&0==--this.timeoutTimerTicksLeft&&this.fireTimeoutTimer()};SIPTransaction.prototype.isTerminated=function(){return"TERMINATED"==this.getState()?!0:!1};SIPTransaction.prototype.getKey=function(){return this.encapsulatedChannel.getKey()};SIPTransaction.prototype.getSIPStack=function(){return this.sipStack};
SIPTransaction.prototype.getTransport=function(){return this.encapsulatedChannel.getTransport()};SIPTransaction.prototype.isReliable=function(){return!0};SIPTransaction.prototype.getViaHeader=function(){var a=WSMessageChannel.prototype.getViaHeader.call(this);a.setBranch(this.branch);return a};SIPTransaction.prototype.sendMessage=function(a){this.encapsulatedChannel.sendMessage(a)};
SIPTransaction.prototype.addEventListener=function(a){if(a){for(var b=null,c=0;c<this.eventListeners.length;c++)this.eventListeners[c]==a&&(b=c);null==b&&this.eventListeners.push(a)}};SIPTransaction.prototype.removeEventListener=function(a){for(var b=0;b<this.eventListeners.length;b++)if(this.eventListeners[b]==a){this.eventListeners.splice(null,1);break}};
SIPTransaction.prototype.raiseErrorEvent=function(a){for(var b,c=new SIPTransactionErrorEvent(this,a),d=0;d<this.eventListeners.length;d++)b=this.eventListeners[d],b.transactionErrorEvent(c);a!=this.TIMEOUT_RETRANSMIT&&(this.eventListeners=[],this.setState("TERMINATED"),this instanceof SIPServerTransaction&&this.isByeTransaction()&&null!=this.getDialog()&&this.getDialog().setState("TERMINATED"))};
SIPTransaction.prototype.isServerTransaction=function(){return this instanceof SIPServerTransaction?!0:!1};SIPTransaction.prototype.getDialog=function(){};SIPTransaction.prototype.setDialog=function(a,b){};SIPTransaction.prototype.getViaHost=function(){return this.getViaHeader().getHost()};SIPTransaction.prototype.getLastResponse=function(){return this.lastResponse};SIPTransaction.prototype.getResponse=function(){return this.lastResponse};SIPTransaction.prototype.getTransactionId=function(){return this.transactionId};
SIPTransaction.prototype.hashCode=function(){if(null==this.transactionId)return-1;var a=0,b=this.transactionId;if(null!=b&&""!=b.value)for(var c=0;c<b.length;c++)if(a=31*a+b.charCodeAt(c),2147483647<a||-2147483648>a)a&=4294967295;return a};SIPTransaction.prototype.getViaPort=function(){return this.getViaHeader().getPort()};SIPTransaction.prototype.getPort=function(){return this.encapsulatedChannel.getPort()};
SIPTransaction.prototype.doesCancelMatchTransaction=function(a){var b=!1;if(null==this.getOriginalRequest()||"CANCEL"==this.getMethod())return!1;var c=a.getViaHeaders();if(null!=c){c=c.getFirst();var d=c.getBranch();null!=d&&"z9hg4bk"!=d.toLowerCase().substring(0,7)&&(d=null);if(null!=d&&null!=this.getBranch()){if(this.getBranch().toLowerCase()==d.toLowerCase()&&c.getSentBy().equals(this.getOriginalRequest().getViaHeaders().getFirst().getSentBy())||a.getCallId().toString()==this.getOriginalRequest().getCallId())b=
!0}else this.getOriginalRequest().getRequestURI()==a.getRequestURI()&&this.getOriginalRequest().getTo()==a.getTo()&&this.getOriginalRequest().getFrom()==a.getFrom()&&this.getOriginalRequest().getCallId().getCallId()==a.getCallId().getCallId()&&this.getOriginalRequest().getCSeq().getSeqNumber()==a.getCSeq().getSeqNumber()&&c==this.getOriginalRequest().getViaHeaders().getFirst()&&(b=!0)}b&&this.setPassToListener();return b};SIPTransaction.prototype.close=function(){this.encapsulatedChannel.close()};
SIPTransaction.prototype.isSecure=function(){return this.encapsulatedChannel.isSecure()};SIPTransaction.prototype.getMessageProcessor=function(){return this.encapsulatedChannel.getMessageProcessor()};SIPTransaction.prototype.setApplicationData=function(a){this.applicationData=a};SIPTransaction.prototype.getApplicationData=function(){return this.applicationData};SIPTransaction.prototype.setEncapsulatedChannel=function(a){this.encapsulatedChannel=a};SIPTransaction.prototype.getSipProvider=function(){return this.getMessageProcessor().getListeningPoint().getProvider()};
SIPTransaction.prototype.raiseIOExceptionEvent=function(){this.setState("TERMINATED")};SIPTransaction.prototype.passToListener=function(){return this.toListener};SIPTransaction.prototype.setPassToListener=function(){this.toListener=!0};SIPTransaction.prototype.testAndSetTransactionTerminatedEvent=function(){var a=!this.terminatedEventDelivered;this.terminatedEventDelivered=!0;return a};SIPTransaction.prototype.startTransactionTimer=function(){};
SIPTransaction.prototype.isMessagePartOfTransaction=function(){};
function SIPClientTransaction(a,b){this.classname="SIPClientTransaction";this.encapsulatedChannel=b;this.wsurl=this.encapsulatedChannel.wsurl;this.disableTimeoutTimer();this.sipStack=a;this.infoApp=a.infoApp;this.addEventListener(a);this.originalRequest=null;this.setBranch(Utils.prototype.generateBranchId());this.timeoutIfStillInCallingState=this.notifyOnRetransmit=!1;this.setEncapsulatedChannel(b);this.messageProcessor=b.messageProcessor;this.sipDialogs=[];this.oldmessage=this.timer=this.callingStateTimeoutCount=
this.nextHop=this.defaultDialog=this.respondTo=this.viaHost=this.viaPort=this.lastRequest=null}SIPClientTransaction.prototype=new SIPTransaction;SIPClientTransaction.prototype.constructor=SIPClientTransaction;SIPClientTransaction.prototype.BRANCH_MAGIC_COOKIE_LOWER_CASE="z9hg4bk";SIPClientTransaction.prototype.MAXIMUM_RETRANSMISSION_TICK_COUNT=8;SIPClientTransaction.prototype.COMPLETED="COMPLETED";SIPClientTransaction.prototype.PROCEEDING="PROCEEDING";SIPClientTransaction.prototype.CALLING="CALLING";
SIPClientTransaction.prototype.TERMINATED="TERMINATED";SIPClientTransaction.prototype.ACK="ACK";SIPClientTransaction.prototype.INVITE="INVITE";SIPClientTransaction.prototype.TRYING="TRYING";SIPClientTransaction.prototype.CANCEL="CANCEL";SIPClientTransaction.prototype.BYE="BYE";SIPClientTransaction.prototype.SUBSCRIBE="SUBSCRIBE";SIPClientTransaction.prototype.NOTIFY="NOTIFY";SIPClientTransaction.prototype.TIMER_B=64;SIPClientTransaction.prototype.TIMER_D=SIPTransaction.prototype.TIMER_D;
SIPClientTransaction.prototype.TIMER_F=64;SIPClientTransaction.prototype.TIMER_K=SIPTransaction.prototype.T4;SIPClientTransaction.prototype.TIMER_J=64;SIPClientTransaction.prototype.TimeStampHeader="Timestamp";SIPClientTransaction.prototype.RouteHeader="Route";SIPClientTransaction.prototype.RETRANSMIT="RETRANSMIT";SIPClientTransaction.prototype.TRANSPORT_ERROR=2;SIPClientTransaction.prototype.TIMEOUT_ERROR=1;SIPClientTransaction.prototype.EARLY="EARLY";
SIPClientTransaction.prototype.CONNECTION_LINGER_TIME=8;SIPClientTransaction.prototype.BASE_TIMER_INTERVAL=500;SIPClientTransaction.prototype.setResponseInterface=function(a){this.respondTo=a};SIPClientTransaction.prototype.getRequestChannel=function(){return this};
SIPClientTransaction.prototype.isMessagePartOfTransaction=function(a){var b=a.getViaHeaders(),c=!1,d=b.getFirst().getBranch();d=null!=this.getBranch()&&null!=d&&this.getBranch().toLowerCase().substring(0,7)==this.BRANCH_MAGIC_COOKIE_LOWER_CASE&&d.toLowerCase().substring(0,7)==this.BRANCH_MAGIC_COOKIE_LOWER_CASE?!0:!1;this.COMPLETED==this.getState()?c=d?this.getBranch()().toLowerCase()==b.getFirst().getBranch().toLowerCase()&&this.getMethod()==a.getCSeq().getMethod()?!0:!1:this.getBranch()==a.getTransactionId()?
!0:!1:this.isTerminated()||(d?null!=b&&this.getBranch().toLowerCase()==b.getFirst().getBranch().toLowerCase()&&(c=this.getOriginalRequest().getCSeq().getMethod()==a.getCSeq().getMethod()?!0:!1):c=null!=this.getBranch()?this.getBranch().toLowerCase()==a.getTransactionId().toLowerCase()?!0:!1:this.getOriginalRequest().getTransactionId().toLowerCase()==a.getTransactionId().toLowerCase()?!0:!1);return c};
SIPClientTransaction.prototype.sendMessage=function(a){a.getViaHeaders().getFirst().setBranch(this.getBranch());if(this.PROCEEDING!=this.getState()&&this.CALLING!=this.getState()||a.getMethod()!=this.ACK){try{this.lastRequest=a,null==this.getState()&&(this.setOriginalRequest(a),a.getMethod()==this.INVITE?this.setState(this.CALLING):a.getMethod()==this.ACK?this.setState(this.TERMINATED):this.setState(this.TRYING),this.isInviteTransaction()?this.enableTimeoutTimer(this.TIMER_B):this.enableTimeoutTimer(this.TIMER_F)),
SIPTransaction.prototype.sendMessage.call(this,a)}catch(b){console.error("SIPClientTransaction:sendMessage(): catched exception:"+b),this.setState(this.TERMINATED)}this.isMapped=!0;this.startTransactionTimer()}else this.isReliable()?this.setState(this.TERMINATED):this.setState(this.COMPLETED),SIPTransaction.prototype.sendMessage.call(this,a)};
SIPClientTransaction.prototype.processResponse=function(){2==arguments.length?this.processResponseargu2(arguments[0],arguments[1]):this.processResponseargu3(arguments[0],arguments[1],arguments[2])};
SIPClientTransaction.prototype.processResponseargu2=function(a,b){var c=null,d=a.getCSeq().getMethod(),e=a.getDialogId(!1);if(d==this.CANCEL&&null!=this.lastRequest){var f=this.lastRequest.getInviteTransaction();null!=f&&(c=f.defaultDialog)}else c=this.getDialog(e);if(null==c)if(f=a.getStatusCode(),100<f&&300>f&&(null!=a.getToTag()||this.sipStack.isRfc2543Supported())&&this.sipStack.isDialogCreated(d))if(null!=this.defaultDialog)if(null!=a.getFromTag())c=this.defaultDialog.getLastResponse(),f=this.defaultDialog.getDialogId(),
null==c||d==this.SUBSCRIBE&&f==e&&c.getCSeq().getMethod()==this.NOTIFY?(this.defaultDialog.setLastResponse(this,a),c=this.defaultDialog):(c=this.sipStack.getDialog(e),null==c&&this.defaultDialog.isAssignedFunction()&&(c=this.sipStack.createDialog(this,a))),null!=c&&this.setDialog(c,c.getDialogId());else throw console.error("SIPClientTransaction:processResponseargu2(): response without from-tag "+a),"SIPClientTransaction:processResponseargu2(): response without from-tag "+a;else this.sipStack.isAutomaticDialogSupportEnabled&&
(c=this.sipStack.createDialog(this,a),this.setDialog(c,c.getDialogId()));else c=this.defaultDialog;else c.setLastResponse(this,a);this.processResponse(a,b,c)};
SIPClientTransaction.prototype.processResponseargu3=function(a,b,c){if(null!=this.getState()&&(this.COMPLETED!=this.getState()&&this.TERMINATED!=this.getState()||1!=a.getStatusCode()/100)){this.lastResponse=a;try{this.isInviteTransaction()?this.inviteClientTransaction(a,b,c):this.nonInviteClientTransaction(a,b,c)}catch(d){console.error("SIPClientTransaction:processResponseargu3(): catched exception:"+d),this.setState(this.TERMINATED)}}};
SIPClientTransaction.prototype.nonInviteClientTransaction=function(a,b,c){b=a.getStatusCode();this.TRYING==this.getState()?401==b||407==b?null!=this.respondTo&&this.respondTo.processResponse(a,this,c):100<=b&&199>=b?(this.setState(this.PROCEEDING),this.enableTimeoutTimer(this.TIMER_F),null!=this.respondTo&&this.respondTo.processResponse(a,this,c)):200<=b&&699>=b&&(this.isReliable()?(this.setState(this.TERMINATED),this.sipStack.removeTransaction(this),clearInterval(this.timer)):(this.setState(this.COMPLETED),
this.enableTimeoutTimer(this.TIMER_K)),null!=this.respondTo&&this.respondTo.processResponse(a,this,c)):this.PROCEEDING==this.getState()&&(100<=b&&199>=b?null!=this.respondTo&&this.respondTo.processResponse(a,this,c):200<=b&&699>=b&&(null!=this.respondTo&&this.respondTo.processResponse(a,this,c),this.disableTimeoutTimer(),this.isReliable()?this.setState(this.TERMINATED):(this.setState(this.COMPLETED),this.enableTimeoutTimer(this.TIMER_K))))};
SIPClientTransaction.prototype.inviteClientTransaction=function(a,b,c){b=a.getStatusCode();this.TERMINATED==this.getState()?(b=!1,null!=c&&c.isAckSeen()&&null!=c.getLastAckSent()&&c.getLastAckSent().getCSeq().getSeqNumber()==a.getCSeq().getSeqNumber()&&a.getFromTag()==c.getLastAckSent().getFromTag()&&(b=!0),null==c||b||a.getCSeq().getMethod()!=c.getMethod()||c.resendAck(),this.sipStack.removeTransaction(this),clearInterval(this.timer)):this.CALLING==this.getState()?200<=b&&299>=b?(this.disableTimeoutTimer(),
this.setState(this.TERMINATED),null!=this.respondTo&&this.respondTo.processResponse(a,this,c)):401==b||407==b?null!=this.respondTo&&this.respondTo.processResponse(a,this,c):100<=b&&199>=b?(this.disableTimeoutTimer(),this.setState(this.PROCEEDING),null!=this.respondTo&&this.respondTo.processResponse(a,this,c)):300<=b&&699>=b&&(this.sendMessage(this.createErrorAck()),null!=this.respondTo&&this.respondTo.processResponse(a,this,c),this.isReliable()?this.setState(this.TERMINATED):(this.setState(this.COMPLETED),
this.enableTimeoutTimer(this.TIMER_D))):this.PROCEEDING==this.getState()?100<=b&&199>=b?null!=this.respondTo&&this.respondTo.processResponse(a,this,c):200<=b&&299>=b?(this.setState(this.TERMINATED),this.sipStack.removeTransaction(this),clearInterval(this.timer),null!=this.respondTo&&this.respondTo.processResponse(a,this,c)):300<=b&&699>=b&&(this.sendMessage(this.createErrorAck()),this.isReliable()?(this.setState(this.TERMINATED),this.sipStack.removeTransaction(this),clearInterval(this.timer)):(this.setState(this.COMPLETED),
this.enableTimeoutTimer(this.TIMER_D)),null!=this.respondTo&&this.respondTo.processResponse(a,this,c)):this.COMPLETED==this.getState()&&(this.setState(this.TERMINATED),this.sipStack.removeTransaction(this),clearInterval(this.timer),300<=b&&699>=b&&this.sendMessage(this.createErrorAck()))};
SIPClientTransaction.prototype.sendRequest=function(){var a=this.getOriginalRequest();if(null!=this.getState())throw console.error("SIPClientTransaction:sendRequest(): request already sent"),"SIPClientTransaction:sendRequest(): request already sent";try{a.checkHeaders()}catch(d){throw console.error("SIPClientTransaction:sendRequest(): "+d),"SIPClientTransaction:sendRequest(): "+d;}try{if(this.getMethod()==this.CANCEL&&this.sipStack.isCancelClientTransactionChecked()){var b=this.sipStack.findCancelTransaction(this.getOriginalRequest(),
!1);if(null==b)throw console.error("SIPClientTransaction:sendRequest(): could not find original tx to cancel. RFC 3261 9.1"),"SIPClientTransaction:sendRequest(): could not find original tx to cancel. RFC 3261 9.1";if(null==b.getState())throw console.error("SIPClientTransaction:sendRequest(): state is null no provisional response yet -- cannot cancel RFC 3261 9.1"),"SIPClientTransaction:sendRequest(): state is null no provisional response yet -- cannot cancel RFC 3261 9.1";if(b.getMethod()!=this.INVITE)throw console.error("SIPClientTransaction:sendRequest(): cannot cancel non-invite requests RFC 3261 9.1"),
"SIPClientTransaction:sendRequest(): cannot cancel non-invite requests RFC 3261 9.1";}else if(this.getMethod()==this.BYE||this.getMethod()==this.NOTIFY){var c=this.sipStack.getDialog(this.getOriginalRequest().getDialogId(!1));if(this.getSipProvider().isAutomaticDialogSupportEnabled()&&null!=c)throw console.error("SIPClientTransaction:sendRequest(): Dialog is present and AutomaticDialogSupport is enabled for the provider -- Send the Request using the Dialog.sendRequest(transaction)"),"SIPClientTransaction:sendRequest(): Dialog is present and AutomaticDialogSupport is enabled for the provider -- Send the Request using the Dialog.sendRequest(transaction)";
}this.getMethod()==this.INVITE&&this.getDefaultDialog();this.isMapped=!0;this.sendMessage(a)}catch(d){throw this.setState(this.TERMINATED),console.error("SIPClientTransaction:sendRequest(): catched exception:"+d),"SIPClientTransaction:sendRequest(): catched exception:"+d;}};
SIPClientTransaction.prototype.fireTimeoutTimer=function(){clearInterval(this.timer);var a=this.getDialog();if(this.CALLING==this.getState()||this.TRYING==this.getState()||this.PROCEEDING==this.getState())null==a||null!=a.getState()&&a.getState()!=this.EARLY?null!=a&&this.getOriginalRequest().getMethod().toLowerCase()==this.BYE.toLowerCase()&&a.isTerminatedOnBye()&&a.delet():this.getSIPStack().isDialogCreated(this.getOriginalRequest().getMethod())&&a.delet();this.COMPLETED!=this.getState()?(this.raiseErrorEvent(this.TIMEOUT_ERROR),
this.getOriginalRequest().getMethod().toLowerCase()==this.CANCEL.toLowerCase()&&(a=this.getOriginalRequest().getInviteTransaction(),null==a||null==a.getDialog()||a.getState()!=this.CALLING&&a.getState()!=this.PROCEEDING||a.setState(this.TERMINATED))):this.setState(this.TERMINATED)};
SIPClientTransaction.prototype.createCancel=function(){var a=this.getOriginalRequest();if(null==a)throw console.error("SIPClientTransaction:createCancel(): bad state "+this.getState()),"SIPClientTransaction:createCancel(): bad state "+this.getState();if(a.getMethod()!=this.INVITE)throw console.error("SIPClientTransaction:createCancel(): only INIVTE may be cancelled"),"SIPClientTransaction:createCancel(): only INIVTE may be cancelled";if(a.getMethod().toLowerCase()==this.ACK.toLowerCase())throw console.error("SIPClientTransaction:createCancel(): cannot Cancel ACK!"),
"SIPClientTransaction:createCancel(): cannot Cancel ACK!";a=a.createCancelRequest();a.setInviteTransaction(this);return a};
SIPClientTransaction.prototype.createAck=function(){var a=this.getOriginalRequest();if(null==a)throw console.error("SIPClientTransaction:createAck(): bad state "+getState()),"SIPClientTransaction:createAck(): bad state "+getState();if(this.getMethod().toLowerCase()==this.ACK.toLowerCase())throw console.error("SIPClientTransaction:createAck(): cannot ACK an ACK!"),"SIPClientTransaction:createAck(): cannot ACK an ACK!";if(null==this.lastResponse)throw console.error("SIPClientTransaction:createAck(): bad Transaction state"),
"SIPClientTransaction:createAck(): bad Transaction state";if(200>this.lastResponse.getStatusCode())throw console.error("SIPClientTransaction:createAck() : cannot ACK a provisional response!"),"SIPClientTransaction:createAck(): cannot ACK a provisional response!";a=a.createAckRequest(this.lastResponse.getTo());var b=this.lastResponse.getRecordRouteHeaders();if(null==b)return null!=this.lastResponse.getContactHeaders()&&3!=this.lastResponse.getStatusCode()/100&&(b=this.lastResponse.getContactHeaders().getFirst(),
b=b.getAddress().getURI(),a.setRequestURI(b)),a;a.removeHeader(this.RouteHeader);for(var c=new RouteList,d=b.getHeaderList().length-1;0<=d;d--){var e=b.getHeaderList()[d],f=new Route;f.setAddress(e.getAddress());f.setParameters(e.getParameters());c.add(f)}b=null;null!=this.lastResponse.getContactHeaders()&&(b=this.lastResponse.getContactHeaders().getFirst());c.getFirst().getAddress().getURI().hasLrParam()?null!=b&&(b=b.getAddress().getURI(),a.setRequestURI(b),a.addHeader(c)):(f=null,null!=b&&(f=new Route,
f.setAddress(b.getAddress())),b=c.getFirst(),c.removeFirst(),b=b.getAddress().getURI(),a.setRequestURI(b),null!=f&&c.add(f),a.addHeader(c));return a};
SIPClientTransaction.prototype.createErrorAck=function(){var a=this.getOriginalRequest();if(null==a)throw console.error("SIPClientTransaction:createErrorAck(): bad state "+getState()),"SIPClientTransaction:createErrorAck(): bad state "+getState();if(this.getMethod()!=this.INVITE)throw console.error("SIPClientTransaction:createErrorAck(): can only ACK an INVITE!"),"SIPClientTransaction:createErrorAck(): can only ACK an INVITE!";if(null==this.lastResponse)throw console.error("SIPClientTransaction:createErrorAck(): bad Transaction state"),
"SIPClientTransaction:createErrorAck():  bad Transaction state";if(200>this.lastResponse.getStatusCode())throw console.error("SIPClientTransaction:createErrorAck(): cannot ACK a provisional response!"),"SIPClientTransaction:createErrorAck(): cannot ACK a provisional response!";return a.createErrorAck(this.lastResponse.getTo())};SIPClientTransaction.prototype.setViaPort=function(a){this.viaPort=a};SIPClientTransaction.prototype.setViaHost=function(a){this.viaHost=a};
SIPClientTransaction.prototype.getViaPort=function(){return this.viaPort};SIPClientTransaction.prototype.getViaHost=function(){return this.viaHost};SIPClientTransaction.prototype.getOutgoingViaHeader=function(){return this.getMessageProcessor().getViaHeader()};SIPClientTransaction.prototype.clearState=function(){};SIPClientTransaction.prototype.setState=function(a){a==this.TERMINATED&&this.isReliable()&&(this.collectionTime=this.TIMER_J);SIPTransaction.prototype.setState.call(this,a)};
SIPClientTransaction.prototype.startTransactionTimer=function(){if(0==this.transactionTimerStarted&&(this.transactionTimerStarted=!0,null==this.timer)){var a=this;this.timer=setInterval(function(){a.isTerminated()?a.getSIPStack().removeTransaction(a):a.fireTimer()},this.BASE_TIMER_INTERVAL)}};SIPClientTransaction.prototype.terminate=function(){this.setState(this.TERMINATED)};
SIPClientTransaction.prototype.checkFromTag=function(a){var b=this.getRequest().getFromTag();a=a.getFrom().getTag();return null!=this.defaultDialog&&(null==b&&null==a||null==b^null==a||null!=b&&null!=a&&b.toLowerCase()!=a.toLowerCase())?!1:!0};SIPClientTransaction.prototype.getDialog=function(){if(0==arguments.length)return this.getDialogargu0();if(1==arguments.length)return this.getDialogargu1(arguments[0])};
SIPClientTransaction.prototype.getDialogargu0=function(){var a=null;null!=this.lastResponse&&null!=this.lastResponse.getFromTag()&&null!=this.lastResponse.getToTag()&&100!=this.lastResponse.getStatusCode()&&(a=this.lastResponse.getDialogId(!1),a=this.getDialog(a));null==a&&(a=this.defaultDialog);return a};SIPClientTransaction.prototype.getDialogargu1=function(a){for(var b=null,c=0;c<this.sipDialogs.length;c++)this.sipDialogs[c][0]==a&&(b=this.sipDialogs[c][1]);return b};
SIPClientTransaction.prototype.setDialog=function(a,b){if(null==a)throw console.error("SIPClientTransaction:setDialog(): bad dialog argument"),"SIPClientTransaction:setDialog(): bad dialog argument";null==this.defaultDialog&&(this.defaultDialog=a);if(null!=b&&null!=a.getDialogId()){for(var c=null,d=0;d<this.sipDialogs.length;d++)this.sipDialogs[d][0]==b&&(c=d);null!=c?this.sipDialogs[c][1]=a:(c=[],c[0]=b,c[1]=a,this.sipDialogs.push(c))}};SIPClientTransaction.prototype.getDefaultDialog=function(){return this.defaultDialog};
SIPClientTransaction.prototype.setNextHop=function(a){this.nextHop=a};SIPClientTransaction.prototype.getNextHop=function(){return this.nextHop};SIPClientTransaction.prototype.alertIfStillInCallingStateBy=function(a){this.timeoutIfStillInCallingState=!0;this.callingStateTimeoutCount=a};
function SIPServerTransaction(a,b){this.classname="SIPServerTransaction";this.auditTag=0;this.sipStack=a;this.originalRequest=null;this.encapsulatedChannel=b;this.disableTimeoutTimer();this.addEventListener(a);this.timer=this.timert=null;-1!=a.maxListenerResponseTime&&(this.timer=setTimeout(this.listenerExecutionMaxTimer(),1E3*a.maxListenerResponseTime));this.rseqNumber=1E3*Math.random();this.inviteTransaction=this.pendingSubscribeTransaction=this.isAckSeen=this.provisionalResponseTask=this.pendingReliableResponse=
this.dialog=this.requestOf=null}SIPServerTransaction.prototype=new SIPTransaction;SIPServerTransaction.prototype.constructor=SIPServerTransaction;SIPServerTransaction.prototype.TERMINATED_STATE=2;SIPServerTransaction.prototype.TIMEOUT_ERROR=1;SIPServerTransaction.prototype.RECEIVED="received";SIPServerTransaction.prototype.INVITE="INVITE";SIPServerTransaction.prototype.CANCEL="CANCEL";SIPServerTransaction.prototype.BRANCH="branch";SIPServerTransaction.prototype.BRANCH_MAGIC_COOKIE_LOWER_CASE="z9hg4bk";
SIPServerTransaction.prototype.TIMER_H=64;SIPServerTransaction.prototype.TIMER_J=64;SIPServerTransaction.prototype.TIMER_I=SIPTransaction.prototype.TIMER_I;SIPServerTransaction.prototype.CONNECTION_LINGER_TIME=8;SIPServerTransaction.prototype.BASE_TIMER_INTERVAL=500;SIPServerTransaction.prototype.ExpiresHeader="Expires";SIPServerTransaction.prototype.ContactHeader="Contact";
SIPServerTransaction.prototype.listenerExecutionMaxTimer=function(){if(null==this.getState()){this.terminate();var a=this.getSIPStack();a.removePendingTransaction(this);a.removeTransaction(this)}};SIPServerTransaction.prototype.setRequestInterface=function(a){this.requestOf=a};SIPServerTransaction.prototype.getResponseChannel=function(){return this};
SIPServerTransaction.prototype.isMessagePartOfTransaction=function(a){var b=!1,c=a.getCSeq().getMethod();if(c==this.INVITE||!this.isTerminated()){var d=a.getViaHeaders();if(null!=d){d=d.getFirst();var e=d.getBranch();null!=e&&e.toLowerCase().substring(0,7)!=this.BRANCH_MAGIC_COOKIE_LOWER_CASE&&(e=null);if(null!=e&&null!=this.getBranch())b=c==this.CANCEL?this.getMethod()==this.CANCEL&&this.getBranch().toLowerCase()==e.toLowerCase()&&d.getSentBy()==this.getOriginalRequest().getViaHeaders().getFirst().getSentBy()?
!0:!1:this.getBranch().toLowerCase()==e.toLowerCase()&&d.getSentBy()==this.getOriginalRequest().getViaHeaders().getFirst().getSentBy()?!0:!1;else{c=SIPTransaction.prototype.fromTag;e=a.getFrom().getTag();var f=null==c||null==e?!0:!1,g=SIPTransaction.prototype.toTag,h=a.getTo().getTag(),k=null==g||null==h?!0:!1,l=a instanceof SIPResponse?!0:!1;a.getCSeq().getMethod().toLowerCase()==this.CANCEL.toLowerCase()&&getOriginalRequest().getCSeq().getMethod().toLowerCase()!=this.CANCEL.toLowerCase()?b=!1:!l&&
this.getOriginalRequest().getRequestURI()!=a.getRequestURI()||!(f||null!=c&&c.toLowerCase()==e.toLowerCase())||!(k||null!=g&&g.toLowerCase()==h.toLowerCase())||this.getOriginalRequest().getCallId().getCallId().toLowerCase()!=a.getCallId().getCallId().toLowerCase()||this.getOriginalRequest().getCSeq().getSeqNumber()!=a.getCSeq().getSeqNumber()||a.getCSeq().getMethod()==this.CANCEL&&this.getOriginalRequest().getMethod()!=a.getCSeq().getMethod()||d!=getOriginalRequest().getViaHeaders().getFirst()||(b=
!0)}}}return b};SIPServerTransaction.prototype.isTransactionMapped=function(){return this.isMapped};
SIPServerTransaction.prototype.processRequest=function(a,b){b=!1;if(null==this.getRealState())this.setOriginalRequest(a),this.setState("TRYING"),b=!0,this.setPassToListener();else{if(this.isInviteTransaction()&&"COMPLETED"==this.getRealState()&&"ACK"==a.getMethod()){this.setState("CONFIRMED");this.isReliable()?this.setState("TERMINATED"):this.enableTimeoutTimer(this.TIMER_I);this.sipStack.isNon2XXAckPassedToListener()&&this.requestOf.processRequest(a,this);return}if(a.getMethod()==this.getMethod()){"PROCEEDING"==
this.getRealState()||"COMPLETED"==this.getRealState()?null!=this.lastResponse&&SIPTransaction.prototype.sendMessage.call(this,this.lastResponse):"ACK"==a.getMethod()&&null!=this.requestOf&&this.requestOf.processRequest(a,this);return}}"COMPLETED"!=this.getRealState()&&"TERMINATED"!=this.getRealState()&&null!=this.requestOf?this.getMethod()==a.getMethod()?b&&this.requestOf.processRequest(a,this):null!=this.requestOf&&this.requestOf.processRequest(a,this):this.getSIPStack().isDialogCreated(this.getMethod())&&
"TERMINATED"==this.getRealState()&&"ACK"==a.getMethod()&&null!=this.requestOf?(b=this.dialog,null!=b&&b.ackProcessed||(null!=b&&(b.ackReceived(a),b.ackProcessed=!0),this.requestOf.processRequest(a,this))):"CANCEL"==a.getMethod()&&this.sendMessage(a.createResponse("OK"))};
SIPServerTransaction.prototype.sendMessage=function(a){var b=a.getStatusCode();null!=this.getOriginalRequest().getTopmostVia().getBranch()?a.getTopmostVia().setBranch(this.getBranch()):a.getTopmostVia().removeParameter(ParameterNames.BRANCH);this.getOriginalRequest().getTopmostVia().hasPort()||a.getTopmostVia().removePort();if(!a.getCSeq().getMethod()==this.getMethod())this.sendResponseSRT(a);else{if("TRYING"==this.getRealState())199>=b&&100<=b?this.setState("PROCEEDING"):200<=b&&699>=b&&(this.isInviteTransaction()?
299>=b&&200<=b?(this.disableTimeoutTimer(),this.collectionTime=this.TIMER_J,this.setState("TERMINATED")):(this.setState("COMPLETED"),this.enableTimeoutTimer(this.TIMER_H)):this.isReliable()?this.setState("TERMINATED"):(this.setState("COMPLETED"),this.enableTimeoutTimer(this.TIMER_J)));else if("PROCEEDING"==this.getRealState())this.isInviteTransaction()?299>=b&&100<=b?(this.disableTimeoutTimer(),this.collectionTime=this.TIMER_J,this.setState("TERMINATED")):300<=b&&699>=b&&(this.setState("COMPLETED"),
this.enableTimeoutTimer(this.TIMER_H)):200<=b&&699>=b&&(this.setState("COMPLETED"),this.isReliable()?this.setState("TERMINATED"):this.enableTimeoutTimer(this.TIMER_J));else if("COMPLETED"==this.getRealState())return;try{this.lastResponse=a,this.sendResponseSRT(a)}catch(c){this.setState("TERMINATED"),this.collectionTime=0,console.error("SIPServerTransaction:sendMessage(): catched exception:"+c)}}};SIPServerTransaction.prototype.getViaHost=function(){return this.getMessageChannel().getViaHost()};
SIPServerTransaction.prototype.getViaPort=function(){return this.getMessageChannel().getViaPort()};
SIPServerTransaction.prototype.fireTimeoutTimer=function(){clearTimeout(this.timer);if("INVITE"!=this.getMethod()||!this.sipStack.removeTransactionPendingAck(this)){var a=this.dialog;!this.getSIPStack().isDialogCreated(this.getOriginalRequest().getMethod())||"CALLING"!=this.getRealState()&&"TRYING"!=this.getRealState()?"BYE"==this.getOriginalRequest().getMethod()&&null!=a&&a.isTerminatedOnBye()&&a.setState(this.TERMINATED_STATE):a.setState(this.TERMINATED_STATE);"COMPLETED"==this.getRealState()&&
this.isInviteTransaction()?(this.raiseErrorEvent(this.TIMEOUT_ERROR),this.setState("TERMINATED"),this.sipStack.removeTransaction(this)):"COMPLETED"!=this.getRealState()||this.isInviteTransaction()?"CONFIRMED"==this.getRealState()&&this.isInviteTransaction()?(this.setState("TERMINATED"),this.sipStack.removeTransaction(this)):isInviteTransaction()||"COMPLETED"!=this.getRealState()&&"CONFIRMED"!=this.getRealState()?isInviteTransaction()&&"TERMINATED"==this.getRealState()&&(this.raiseErrorEvent(this.TIMEOUT_ERROR),
null!=a&&a.setState(this.TERMINATED_STATE)):this.setState("TERMINATED"):(this.setState("TERMINATED"),this.sipStack.removeTransaction(this))}};SIPServerTransaction.prototype.getLastResponse=function(){return this.lastResponse};SIPServerTransaction.prototype.sendResponseSRT=function(a){this.getMessageChannel().sendMessage(a);this.startTransactionTimer()};
SIPServerTransaction.prototype.sendResponse=function(a){var b=this.dialog;if(null==a)throw console.error("SIPServerTransaction:sendResponse(): null response argument"),"SIPServerTransaction:sendResponse(): null response argument";try{a.checkHeaders()}catch(h){throw console.error("SIPServerTransaction:sendMessage(): catched exception:"+h),"SIPServerTransaction:sendResponse(): catched exception:"+h;}if(a.getCSeq().getMethod()!=this.getMethod())throw console.error("SIPServerTransaction:sendResponse(): CSeq method does not match Request method of request that created the tx."),
"SIPServerTransaction:sendResponse(): CSeq method does not match Request method of request that created the tx.";if("SUBSCRIBE"==this.getMethod()&&2==a.getStatusCode()/100){if(null==a.getHeader(this.ExpiresHeader))throw console.error("SIPServerTransaction:sendResponse(): Expires header is mandatory in 2xx response of SUBSCRIBE"),"SIPServerTransaction:sendResponse(): Expires header is mandatory in 2xx response of SUBSCRIBE";var c=this.getOriginalRequest().getExpires(),d=a.getExpires();if(null!=c&&
d.getExpires()>c.getExpires())throw console.error("SIPServerTransaction:sendResponse(): response Expires time exceeds request Expires time : See RFC 3265 3.1.1"),"SIPServerTransaction:sendResponse():Response Expires time exceeds request Expires time : See RFC 3265 3.1.1";}if(200==a.getStatusCode()&&"INVITE"==a.getCSeq().getMethod()&&null==a.getHeader(this.ContactHeader))throw console.error("SIPServerTransaction:sendResponse(): Contact Header is mandatory for the OK to the INVITE"),"SIPServerTransaction:sendResponse(): Contact Header is mandatory for the OK to the INVITE";
if(!this.isMessagePartOfTransaction(a))throw console.error("SIPServerTransaction:sendResponse(): response does not belong to this transaction."),"SIPServerTransaction:sendResponse(): response does not belong to this transaction.";try{if(null!=b){if(2==a.getStatusCode()/100&&this.sipStack.isDialogCreated(a.getCSeq().getMethod()))if(null==b.getLocalTag()&&null==a.getTo().getTag())a.getTo().setTag(Utils.prototype.generateTag());else if(null!=b.getLocalTag()&&null==a.getToTag())a.setToTag(b.getLocalTag());
else if(null!=b.getLocalTag()&&null!=a.getToTag()&&b.getLocalTag()!=a.getToTag())throw console.error("SIPServerTransaction:sendResponse(): tag mismatch dialogTag is "+b.getLocalTag()+" responseTag is "+a.getToTag()),"SIPServerTransaction:sendResponse(): tag mismatch dialogTag is "+b.getLocalTag()+" responseTag is "+a.getToTag();if(a.getCallId().getCallId()!=b.getCallId().getCallId())throw console.error("SIPServerTransaction:sendResponse(): dialog mismatch!"),"SIPServerTransaction:sendResponse(): dialog mismatch!";
}var e=this.getRequest().getFrom().getTag();if(null!=e&&null!=a.getFromTag()&&a.getFromTag()!=e)throw console.error("SIPServerTransaction:sendResponse(): from tag of request does not match response from tag"),"SIPServerTransaction:sendResponse(): from tag of request does not match response from tag";null!=e&&a.getFrom().setTag(e);if(null!=b&&100!=a.getStatusCode()){b.setResponseTags(a);var f=b.getState();b.setLastResponse(this,a);if(null==f&&"TERMINATED"==b.getState()){var g=new DialogTerminatedEvent(b.getSipProvider(),
b);b.getSipProvider().handleEvent(g,this)}}this.sendMessage(a)}catch(h){this.setState("TERMINATED"),this.raiseErrorEvent(this.TRANSPORT_ERROR),console.error("SIPServerTransaction:sendMessage(): catched exception:"+h)}};SIPServerTransaction.prototype.getRealState=function(){return SIPTransaction.prototype.getState.call(this)};SIPServerTransaction.prototype.getState=function(){return this.isInviteTransaction()&&"TRYING"==SIPTransaction.prototype.getState.call(this)?"PROCEEDING":SIPTransaction.prototype.getState.call(this)};
SIPServerTransaction.prototype.setState=function(a){"TERMINATED"==a&&this.isReliable()&&(this.collectionTime=this.TIMER_J);SIPTransaction.prototype.setState.call(this,a)};SIPServerTransaction.prototype.startTransactionTimer=function(){0==this.transactionTimerStarted&&(this.transactionTimerStarted=!0);if(this.transactionTimerStarted&&null==this.timer){var a=this;this.timer=setInterval(function(){a.isTerminated()||a.fireTimer()},this.BASE_TIMER_INTERVAL)}};SIPServerTransaction.prototype.getDialog=function(){return this.dialog};
SIPServerTransaction.prototype.setDialog=function(a,b){this.dialog=a;null!=b&&this.dialog.setAssigned()};SIPServerTransaction.prototype.terminate=function(){this.setState("TERMINATED")};SIPServerTransaction.prototype.setAckSeen=function(){this.isAckSeen=!0};SIPServerTransaction.prototype.ackSeen=function(){return this.isAckSeen};SIPServerTransaction.prototype.setMapped=function(a){this.isMapped=!0};SIPServerTransaction.prototype.setPendingSubscribe=function(a){this.pendingSubscribeTransaction=a};
SIPServerTransaction.prototype.setInviteTransaction=function(a){this.inviteTransaction=a};SIPServerTransaction.prototype.getCanceledInviteTransaction=function(){return this.inviteTransaction};
SIPServerTransaction.prototype.scheduleAckRemoval=function(){if(null==this.getMethod()||"ACK"!=this.getMethod())throw console.error("SIPServerTransaction:scheduleAckRemoval():  method is null["+(null==this.getMethod())+"] or method is not ACK["+this.getMethod()+"]"),"SIPServerTransaction:scheduleAckRemoval():  method is null["+(null==this.getMethod())+"] or method is not ACK["+this.getMethod()+"]";this.startTransactionTimer()};
SIPServerTransaction.prototype.map=function(){var a=this.getRealState();if(null==a||"TRYING"==a)this.isMapped=!0;this.sipStack.removePendingTransaction(this)};function Utils(){this.classname="Utils"}Utils.prototype.BRANCH_MAGIC_COOKIE="z9hG4bK";Utils.prototype.callIDCounter=0;Utils.prototype.counter=0;Utils.prototype.toHex="0123456789abcdef".split("");Utils.prototype.rand=Math.random();
Utils.prototype.toHexString=function(a){for(var b="",c=0;c<a.length;c++)b+=Utils.prototype.toHex[a[c]>>4&15],b+=Utils.prototype.toHex[a[c]&15];return b};Utils.prototype.getQuotedString=function(a){return'"'+a.replace('"','\\"')+'"'};
Utils.prototype.generateCallIdentifier=function(a){var b=(new Date).getTime()+Utils.prototype.callIDCounter+Math.round(1E20*Utils.prototype.rand);Utils.prototype.callIDCounter++;b=new String(Utils.prototype.getBytes(b.toString()));return Utils.prototype.digest(b)+"@"+a};Utils.prototype.generateTag=function(){return Math.round(1E10*Utils.prototype.rand).toString(16)};
Utils.prototype.generateBranchId=function(){var a=(new Date).getTime();a=Math.round(1E9*Utils.prototype.rand)+Utils.prototype.counter+a;Utils.prototype.counter++;a=Utils.prototype.digest(new String(Utils.prototype.getBytes(a.toString())));return Utils.prototype.BRANCH_MAGIC_COOKIE+"-"+Utils.prototype.signature+"-"+a};
Utils.prototype.responseBelongsToUs=function(a){a=a.getTopmostVia().getBranch();for(var b=a.length-1,c=0,d=Utils.prototype.signature.length-1;0<=d;d--)Utils.prototype.signature[d]==a[b]&&(c+=1,--b);return null!=a&&c==Utils.prototype.signature.length?!0:!1};Utils.prototype.getSignature=function(){return Utils.prototype.signature};
Utils.prototype.randomString=function(a){for(var b="",c=0;c<a;c++){var d=Math.floor(61*Math.random());b+="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".substring(d,d+1)}return b};Utils.prototype.getBytes=function(a){var b=[];a=new String(a);for(var c=0;c<a.length;c++)b[c]=a.charCodeAt(c);return b};Utils.prototype.signature=Utils.prototype.toHexString(Utils.prototype.getBytes(Math.round(1E3*Utils.prototype.rand).toString()));
Utils.prototype.digest=function(a){function b(p,q){var t=p&2147483648;var r=q&2147483648;var u=p&1073741824;var v=q&1073741824;p=(p&1073741823)+(q&1073741823);return u&v?p^2147483648^t^r:u|v?p&1073741824?p^3221225472^t^r:p^1073741824^t^r:p^t^r}function c(p,q,t,r,u,v,w){p=b(p,b(b(q&t|~q&r,u),w));return b(p<<v|p>>>32-v,q)}function d(p,q,t,r,u,v,w){p=b(p,b(b(q&r|t&~r,u),w));return b(p<<v|p>>>32-v,q)}function e(p,q,t,r,u,v,w){p=b(p,b(b(q^t^r,u),w));return b(p<<v|p>>>32-v,q)}function f(p,q,t,r,u,v,w){p=
b(p,b(b(t^(q|~r),u),w));return b(p<<v|p>>>32-v,q)}function g(p){var q="",t;for(t=0;3>=t;t++){var r=p>>>8*t&255;r="0"+r.toString(16);q+=r.substr(r.length-2,2)}return q}var h=[];a=function(p){p=p.replace(/\r\n/g,"\n");for(var q="",t=0;t<p.length;t++){var r=p.charCodeAt(t);128>r?q+=String.fromCharCode(r):(127<r&&2048>r?q+=String.fromCharCode(r>>6|192):(q+=String.fromCharCode(r>>12|224),q+=String.fromCharCode(r>>6&63|128)),q+=String.fromCharCode(r&63|128))}return q}(a);h=function(p){var q=p.length;var t=
q+8;for(var r=16*((t-t%64)/64+1),u=Array(r-1),v,w=0;w<q;)t=(w-w%4)/4,v=w%4*8,u[t]|=p.charCodeAt(w)<<v,w++;t=(w-w%4)/4;u[t]|=128<<w%4*8;u[r-2]=q<<3;u[r-1]=q>>>29;return u}(a);var k=1732584193;var l=4023233417;var m=2562383102;var n=271733878;for(a=0;a<h.length;a+=16){var x=k;var y=l;var z=m;var A=n;k=c(k,l,m,n,h[a+0],7,3614090360);n=c(n,k,l,m,h[a+1],12,3905402710);m=c(m,n,k,l,h[a+2],17,606105819);l=c(l,m,n,k,h[a+3],22,3250441966);k=c(k,l,m,n,h[a+4],7,4118548399);n=c(n,k,l,m,h[a+5],12,1200080426);m=
c(m,n,k,l,h[a+6],17,2821735955);l=c(l,m,n,k,h[a+7],22,4249261313);k=c(k,l,m,n,h[a+8],7,1770035416);n=c(n,k,l,m,h[a+9],12,2336552879);m=c(m,n,k,l,h[a+10],17,4294925233);l=c(l,m,n,k,h[a+11],22,2304563134);k=c(k,l,m,n,h[a+12],7,1804603682);n=c(n,k,l,m,h[a+13],12,4254626195);m=c(m,n,k,l,h[a+14],17,2792965006);l=c(l,m,n,k,h[a+15],22,1236535329);k=d(k,l,m,n,h[a+1],5,4129170786);n=d(n,k,l,m,h[a+6],9,3225465664);m=d(m,n,k,l,h[a+11],14,643717713);l=d(l,m,n,k,h[a+0],20,3921069994);k=d(k,l,m,n,h[a+5],5,3593408605);
n=d(n,k,l,m,h[a+10],9,38016083);m=d(m,n,k,l,h[a+15],14,3634488961);l=d(l,m,n,k,h[a+4],20,3889429448);k=d(k,l,m,n,h[a+9],5,568446438);n=d(n,k,l,m,h[a+14],9,3275163606);m=d(m,n,k,l,h[a+3],14,4107603335);l=d(l,m,n,k,h[a+8],20,1163531501);k=d(k,l,m,n,h[a+13],5,2850285829);n=d(n,k,l,m,h[a+2],9,4243563512);m=d(m,n,k,l,h[a+7],14,1735328473);l=d(l,m,n,k,h[a+12],20,2368359562);k=e(k,l,m,n,h[a+5],4,4294588738);n=e(n,k,l,m,h[a+8],11,2272392833);m=e(m,n,k,l,h[a+11],16,1839030562);l=e(l,m,n,k,h[a+14],23,4259657740);
k=e(k,l,m,n,h[a+1],4,2763975236);n=e(n,k,l,m,h[a+4],11,1272893353);m=e(m,n,k,l,h[a+7],16,4139469664);l=e(l,m,n,k,h[a+10],23,3200236656);k=e(k,l,m,n,h[a+13],4,681279174);n=e(n,k,l,m,h[a+0],11,3936430074);m=e(m,n,k,l,h[a+3],16,3572445317);l=e(l,m,n,k,h[a+6],23,76029189);k=e(k,l,m,n,h[a+9],4,3654602809);n=e(n,k,l,m,h[a+12],11,3873151461);m=e(m,n,k,l,h[a+15],16,530742520);l=e(l,m,n,k,h[a+2],23,3299628645);k=f(k,l,m,n,h[a+0],6,4096336452);n=f(n,k,l,m,h[a+7],10,1126891415);m=f(m,n,k,l,h[a+14],15,2878612391);
l=f(l,m,n,k,h[a+5],21,4237533241);k=f(k,l,m,n,h[a+12],6,1700485571);n=f(n,k,l,m,h[a+3],10,2399980690);m=f(m,n,k,l,h[a+10],15,4293915773);l=f(l,m,n,k,h[a+1],21,2240044497);k=f(k,l,m,n,h[a+8],6,1873313359);n=f(n,k,l,m,h[a+15],10,4264355552);m=f(m,n,k,l,h[a+6],15,2734768916);l=f(l,m,n,k,h[a+13],21,1309151649);k=f(k,l,m,n,h[a+4],6,4149444226);n=f(n,k,l,m,h[a+11],10,3174756917);m=f(m,n,k,l,h[a+2],15,718787259);l=f(l,m,n,k,h[a+9],21,3951481745);k=b(k,x);l=b(l,y);m=b(m,z);n=b(n,A)}return(g(k)+g(l)+g(m)+
g(n)).toLowerCase()};function EventWrapper(a,b){this.classname="EventWrapper";this.sipEvent=a;this.transaction=b}function EventScanner(a){this.classname="EventScanner";this.refCount=this.isStopped=null;this.pendingEvents=[];this.eventMutex=[];this.eventMutex[0]=0;this.sipStack=a}EventScanner.prototype.BRANCH_MAGIC_COOKIE="z9hG4bK";EventScanner.prototype.incrementRefcount=function(){};EventScanner.prototype.addEvent=function(a){this.pendingEvents.push(a)};
EventScanner.prototype.stop=function(){0<this.refCount&&this.refCount--;0==this.refCount&&(this.isStopped=!0)};EventScanner.prototype.forceStop=function(){this.isStopped=!0;this.refCount=0};
EventScanner.prototype.deliverEvent=function(a){var b=a.sipEvent,c=this.sipStack.getSipListener();if(b instanceof RequestEvent){var d=b.getRequest(),e=this.sipStack.findTransaction(d,!0);null!=e&&!e.passToListener()||null!=this.sipStack.findPendingTransaction(d)||(this.sipStack.putPendingTransaction(a.transaction),d.setTransaction(a.transaction),null!=c&&c.processRequest(b),null!=a.transaction&&(b=a.transaction.getDialog(),null!=b&&b.requestConsumed()),null!=a.transaction&&this.sipStack.removePendingTransaction(a.transaction),
"ACK"==a.transaction.getOriginalRequest().getMethod()&&a.transaction.setState("TERMINATED"))}else if(b instanceof ResponseEvent){d=b.getResponse();var f=b.getDialog();null!=c&&(e=a.transaction,null!=e&&e.setPassToListener(),c.processResponse(b));null==f||null!=f.getState()&&"TERMINATED"==f.getState()||481!=d.getStatusCode()&&408!=d.getStatusCode()||f.doDeferredDelete();"INVITE"==d.getCSeq().getMethod()&&null!=f&&200==d.getStatusCode()&&f.doDeferredDeleteIfNoAckSent(d.getCSeq().getSeqNumber());a=a.transaction;
null!=a&&"COMPLETED"==a.getState()&&null!=a.getOriginalRequest()&&"INVITE"!=a.getOriginalRequest().getMethod()&&a.clearState()}else b instanceof TimeoutEvent?null!=c&&c.processTimeout(b):b instanceof DialogTimeoutEvent?null!=c&&c.processDialogTimeout(b):b instanceof TransactionTerminatedEvent?null!=c&&c.processTransactionTerminated(b):b instanceof DialogTerminatedEvent&&null!=c&&c.processDialogTerminated(b)};
EventScanner.prototype.run=function(){for(;;){for(var a,b;0==this.pendingEvents.length;)if(this.isStopped)return;b=this.pendingEvents;this.pendingEvents=[];for(var c=0;c<b.length;c++)a=b[c],this.deliverEvent(a)}};function DialogTerminatedEvent(a,b){this.classname="DialogTerminatedEvent";this.mDialog=b;this.source=a}DialogTerminatedEvent.prototype.getDialog=function(){return this.mDialog};
function DialogTimeoutEvent(a,b,c){this.classname="DialogTimeoutEvent";this.source=a;this.m_dialog=b;this.m_reason=c}DialogTimeoutEvent.prototype.AckNotReceived="AckNotReceived";DialogTimeoutEvent.prototype.AckNotSent="AckNotSent";DialogTimeoutEvent.prototype.ReInviteTimeout="ReInviteTimeout";DialogTimeoutEvent.prototype.getDialog=function(){return this.m_dialog};DialogTimeoutEvent.prototype.getReason=function(){return this.m_reason};
function TransactionTerminatedEvent(a,b){this.classname="TransactionTerminatedEvent";this.source=this.mClientTransaction=this.mServerTransaction=this.mIsServerTransaction=this.mTimeout=null;b instanceof SIPServerTransaction?(this.source=a,this.mServerTransaction=b,this.mIsServerTransaction=!0):b instanceof SIPClientTransaction&&(this.source=a,this.mClientTransaction=b,this.mIsServerTransaction=!1)}TransactionTerminatedEvent.prototype.isServerTransaction=function(){return this.mIsServerTransaction};
TransactionTerminatedEvent.prototype.getClientTransaction=function(){return this.mClientTransaction};TransactionTerminatedEvent.prototype.getServerTransaction=function(){return this.mServerTransaction};function RequestEvent(a,b,c,d){this.classname="RequestEvent";this.mDialog=c;this.mRequest=d;this.mServerTransaction=b;this.source=a}RequestEvent.prototype.getDialog=function(){return this.mDialog};RequestEvent.prototype.getRequest=function(){return this.mRequest};
RequestEvent.prototype.getServerTransaction=function(){return this.mServerTransaction};function TimeoutEvent(a,b,c){this.classname="TimeoutEvent";this.source=this.mClientTransaction=this.mServerTransaction=this.mIsServerTransaction=this.mTimeout=null;b instanceof SIPServerTransaction?(this.source=a,this.mTimeout=c,this.mServerTransaction=b,this.mIsServerTransaction=!0):b instanceof SIPClientTransaction&&(this.source=a,this.mTimeout=c,this.mClientTransaction=b,this.mIsServerTransaction=!1)}
TimeoutEvent.prototype=new TransactionTerminatedEvent;TimeoutEvent.prototype.constructor=TimeoutEvent;TimeoutEvent.prototype.getTimeout=function(){return this.mTimeout};
function TransactionTerminatedEvent(a,b){this.classname="TransactionTerminatedEvent";this.source=this.mClientTransaction=this.mServerTransaction=this.mIsServerTransaction=this.mTimeout=null;b instanceof SIPServerTransaction?(this.source=a,this.mServerTransaction=b,this.mIsServerTransaction=!0):b instanceof SIPClientTransaction&&(this.source=a,this.mClientTransaction=b,this.mIsServerTransaction=!1)}TransactionTerminatedEvent.prototype.isServerTransaction=function(){return this.mIsServerTransaction};
TransactionTerminatedEvent.prototype.getClientTransaction=function(){return this.mClientTransaction};TransactionTerminatedEvent.prototype.getServerTransaction=function(){return this.mServerTransaction};function DefaultAddressResolver(){this.classname="DefaultAddressResolver"}DefaultAddressResolver.prototype.resolveAddress=function(a){if(-1!=a.getPort())return a;var b=new MessageProcessor;return new HopImpl(a.getHost(),b.getDefaultPort(),a.getTransport())};
function ResponseEvent(a,b,c,d){this.classname="ResponseEvent";this.mDialog=c;this.mResponse=d;this.mServerTransaction=b;this.source=a}ResponseEvent.prototype.getDialog=function(){return this.mDialog};ResponseEvent.prototype.getResponse=function(){return this.mResponse};ResponseEvent.prototype.getClientTransaction=function(){return this.mClientTransaction};
function ResponseEventExt(a,b,c,d){this.classname="ResponseEventExt";this.mDialog=c;this.mResponse=d;this.mServerTransaction=b;this.source=a;this.m_originalTransaction=b}ResponseEventExt.prototype=new ResponseEvent;ResponseEventExt.prototype.constructor=ResponseEventExt;ResponseEventExt.prototype.isForkedResponse=function(){return null==this.mServerTransaction&&null!=this.m_originalTransaction};ResponseEventExt.prototype.setOriginalTransaction=function(a){this.m_originalTransaction=a};
ResponseEventExt.prototype.getOriginalTransaction=function(){return this.m_originalTransaction};function DialogFilter(a){this.classname="DialogFilter";this.sipStack=a;this.listeningPoint=this.transactionChannel=null}DialogFilter.prototype.processResponse=function(){2==arguments.length?this.processResponseargu2(arguments[0],arguments[1]):this.processResponseargu3(arguments[0],arguments[1],arguments[2])};
DialogFilter.prototype.processResponseargu2=function(a,b){var c=a.getDialogId(!1),d=this.sipStack.getDialog(c),e=a.getCSeq().getMethod();if((!this.sipStack.checkBranchId||Utils.prototype.responseBelongsToUs(a))&&null!=this.listeningPoint&&(b=this.listeningPoint.getProvider(),null!=b&&null!=b.getSipListener())){var f=this.transactionChannel;null==d&&null!=f&&(d=f.getDialog(c),null!=d&&"TERMINATED"==d.getState()&&(d=null));if(null!=this.transactionChannel&&(c=this.transactionChannel.getRequest().getFromTag(),
null==c^null==a.getFrom().getTag()||null!=c&&c.toLowerCase()!=a.getFrom().getTag().toLowerCase()))return;if(this.sipStack.isDialogCreated(e)&&100!=a.getStatusCode()&&null!=a.getFrom().getTag()&&null!=a.getTo().getTag()&&null==d)b.isAutomaticDialogSupportEnabled()&&(null!=this.transactionChannel?null==d&&(d=this.sipStack.createDialog(this.transactionChannel,a),this.transactionChannel.setDialog(d,a.getDialogId(!1))):d=this.sipStack.createDialog(b,a));else if(null!=d&&null==f&&"TERMINATED"!=d.getState()){if("TERMINATED"==
d.getState()&&(200<=a.getStatusCode()||299>=a.getStatusCode())){(200<=a.getStatusCode()||299>=a.getStatusCode())&&"INVITE"==a.getCSeq().getMethod()&&(a=d.createAck(a.getCSeq().getSeqNumber()),d.sendAck(a));return}e=!1;d.isAckSeen()&&null!=d.getLastAckSent()&&d.getLastAckSent().getCSeq().getSeqNumber()==a.getCSeq().getSeqNumber()&&a.getDialogId(!1)==d.getLastAckSent().getDialogId(!1)&&(e=!0);if(e&&a.getCSeq().getMethod()==d.getMethod()){d.resendAck();return}}null!=d&&100!=a.getStatusCode()&&null!=
a.getTo().getTag()&&d.setLastResponse(f,a);d=new ResponseEventExt(b,f,d,a);"INVITE"==a.getCSeq().getMethod()&&(a=this.sipStack.getForkedTransaction(a.getTransactionId()),d.setOriginalTransaction(a));b.handleEvent(d,f)}};
DialogFilter.prototype.processResponseargu3=function(a,b,c){if(null!=this.listeningPoint&&(!this.sipStack.checkBranchId||Utils.prototype.responseBelongsToUs(a))&&(b=this.listeningPoint.getProvider(),null!=b&&null!=b.getSipListener())){var d=this.transactionChannel;if(null==d){if(null!=c){if(200>a.getStatusCode()||299<a.getStatusCode()||"TERMINATED"==c.getState())return;var e=!1;c.isAckSeen()&&null!=c.getLastAckSent()&&c.getLastAckSent().getCSeq().getSeqNumber()==a.getCSeq().getSeqNumber()&&(e=!0);
if(e&&a.getCSeq().getMethod()==c.getMethod()){c.resendAck();return}}c=new ResponseEventExt(b,d,c,a);"INVITE"==a.getCSeqHeader().getMethod()&&(a=this.sipStack.getForkedTransaction(a.getTransactionId()),c.setOriginalTransaction(a));b.handleEvent(c,d)}else e=new ResponseEventExt(b,d,c,a),"INVITE"==a.getCSeqHeader().getMethod()&&e.setOriginalTransaction(d),null!=c&&100!=a.getStatusCode()&&(c.setLastResponse(d,a),d.setDialog(c,c.getDialogId())),b.handleEvent(e,d)}};DialogFilter.prototype.getSipStack=function(){return this.sipStack};
DialogFilter.prototype.sendBadRequestResponse=function(a,b,c){var d=a.createResponse(400);null!=c&&d.setReasonPhrase(c);c=MessageFactoryImpl.prototype.getDefaultServerHeader();null!=c&&d.setHeader(c);"INVITE"==a.getMethod()&&this.sipStack.addTransactionPendingAck(b);b.sendResponse(d)};
DialogFilter.prototype.sendCallOrTransactionDoesNotExistResponse=function(a,b){var c=a.createResponse(481),d=MessageFactoryImpl.prototype.getDefaultServerHeader();null!=d&&c.setHeader(d);"INVITE"==a.getMethod()&&this.sipStack.addTransactionPendingAck(b);b.sendResponse(c)};DialogFilter.prototype.sendLoopDetectedResponse=function(a,b){a=a.createResponse(482);var c=MessageFactoryImpl.prototype.getDefaultServerHeader();null!=c&&a.setHeader(c);this.sipStack.addTransactionPendingAck(b);b.sendResponse(a)};
DialogFilter.prototype.processRequest=function(a,b){if(null!=this.listeningPoint){var c=this.transactionChannel.getSIPStack();b=this.listeningPoint.getProvider();if(null!=b){var d=this.transactionChannel,e=a.getDialogId(!0),f=c.getDialog(e);if(null!=f&&b!=f.getSipProvider()){var g=f.getMyContactHeader();if(null!=g){var h=g.getAddress().getURI();g=h.getHost();h=h.getPort();-1==h&&(h=5060);null==g||g==this.listeningPoint.getHostAddress()&&h==this.listeningPoint.getPort()||(f=null)}}if(b.isAutomaticDialogSupportEnabled()&&
b.isDialogErrorsAutomaticallyHandled()&&null==a.getToTag()&&null!=c.findMergedTransaction(a))this.sendLoopDetectedResponse(a,d);else{if("ACK"==a.getMethod())if(null==f){if(g=c.findTransactionPendingAck(a),null!=g){g.setAckSeen();c.removeTransaction(g);c.removeTransactionPendingAck(g);return}}else if(f.handleAck(d))d.passToListener(),f.addTransaction(d),f.addRoute(a),d.setDialog(f,e),"INVITE"==a.getMethod()&&b.isDialogErrorsAutomaticallyHandled()&&c.putInMergeTable(d,a),c.deliverTerminatedEventForAck?
(c.addTransaction(d),d.scheduleAckRemoval()):d.setMapped(!0);else{g=c.findTransactionPendingAck(a);null!=g&&(g.setAckSeen(),c.removeTransaction(g),c.removeTransactionPendingAck(g));return}else if("BYE"==a.getMethod()){if(null!=f&&!f.isRequestConsumable(a)){f.getRemoteSeqNumber()>=a.getCSeq().getSeqNumber()&&"TRYING"==d.getState()&&this.sendServerInternalErrorResponse(a,d);null!=d&&c.removeTransaction(d);return}if(null==f&&b.isAutomaticDialogSupportEnabled()){a=a.createResponse(481);a.setReasonPhrase("Dialog Not Found");
d.sendResponse(a);null!=d&&c.removeTransaction(d);return}null!=d&&null!=f&&b==f.getSipProvider()&&(c.addTransaction(d),f.addTransaction(d),d.setDialog(f,e))}else if("CANCEL"==a.getMethod()){g=c.findCancelTransaction(a,!0);if("CANCEL"==a.getMethod()&&null!=g&&"TERMINATED"==g.getState()){d.sendResponse(a.createResponse("OK"));return}if(null!=d&&null!=g&&null!=g.getDialog())d.setDialog(g.getDialog(),e),f=g.getDialog();else if(null==g&&b.isAutomaticDialogSupportEnabled()&&null!=d){a=a.createResponse(481);
b.sendResponse(a);null!=d&&c.removeTransaction(d);return}null!=g&&null!=d&&(c.addTransaction(d),d.setPassToListener(),d.setInviteTransaction(g))}else if("INVITE"==a.getMethod()){g=null==f?null:f.getInviteTransaction();if(null!=f&&null!=d&&null!=g&&a.getCSeq().getSeqNumber()>g.getCSeq()&&g instanceof SIPServerTransaction&&b.isDialogErrorsAutomaticallyHandled()&&f.isSequnceNumberValidation()&&g.isInviteTransaction()&&"COMPLETED"!=g.getState()&&"TERMINATED"!=g.getState()&&"CONFIRMED"!=g.getState()){this.sendServerInternalErrorResponse(a,
d);return}g=null==f?null:f.getLastTransaction();if(null!=f&&b.isDialogErrorsAutomaticallyHandled()&&null!=g&&g.isInviteTransaction()&&g instanceof SIPClientTransaction&&null!=g.getLastResponse()&&200==g.getLastResponse().getStatusCode()&&!f.isAckSent(g.getLastResponse().getCSeq().getSeqNumber())||null!=f&&null!=g&&b.isDialogErrorsAutomaticallyHandled()&&g.isInviteTransaction()&&g instanceof SIPServerTransaction&&!f.isAckSeen())return}if(null!=f&&null!=d&&"BYE"!=a.getMethod()&&"CANCEL"!=a.getMethod()&&
"ACK"!=a.getMethod()){if(!f.isRequestConsumable(a)){Number(f.getRemoteSeqNumber())>=Number(a.getCSeq().getSeqNumber())&&b.isDialogErrorsAutomaticallyHandled()&&("TRYING"==d.getState()||"PROCEEDING"==d.getState())&&this.sendServerInternalErrorResponse(a,d);return}try{b==f.getSipProvider()&&(c.addTransaction(d),f.addTransaction(d),f.addRoute(a),d.setDialog(f,e))}catch(k){console.error("DialogFilter:processRequest(): catched exception:"+k);c.removeTransaction(d);return}}a=null!=d?new RequestEvent(b,
d,f,a):new RequestEvent(b,null,f,a);b.handleEvent(a,d)}}}};DialogFilter.prototype.sendServerInternalErrorResponse=function(a,b){console.error("DialogFilter:sendServerInternalErrorResponse(): ",a)};DialogFilter.prototype.getProcessingInfo=function(){return null};function ListeningPointImpl(a,b){this.classname="ListeningPointImpl";this.sipStack=a;this.messageProcessor=b;this.sipProvider=null}ListeningPointImpl.prototype.makeKey=function(a,b){return(""+a+"/"+b).toLowerCase()};
ListeningPointImpl.prototype.getKey=function(){return this.makeKey(this.sipStack.getHostAddress(),this.messageProcessor.getTransport())};ListeningPointImpl.prototype.setSipProvider=function(a){this.sipProvider=a};ListeningPointImpl.prototype.removeSipProvider=function(){this.sipProvider=null};ListeningPointImpl.prototype.getTransport=function(){return this.messageProcessor.getTransport()};ListeningPointImpl.prototype.getProvider=function(){return this.sipProvider};
ListeningPointImpl.prototype.setSentBy=function(a){this.messageProcessor.setSentBy(a)};ListeningPointImpl.prototype.getSentBy=function(){return this.messageProcessor.getSentBy()};ListeningPointImpl.prototype.isSentBySet=function(){return this.messageProcessor.isSentBySet()};ListeningPointImpl.prototype.getViaHeader=function(){return this.messageProcessor.getViaHeader()};ListeningPointImpl.prototype.getMessageProcessor=function(){return this.messageProcessor};
ListeningPointImpl.prototype.createContactHeader=function(a){try{var b=this.sipStack.getHostAddress(),c=new SipUri;c.setHost_String(b);c.setUser(a);c.setTransportParam(this.messageProcessor.getTransport());var d=new Contact,e=new AddressImpl;e.setURI(c);d.setAddress(e);return d}catch(f){return console.error("ListeningPointImpl:createContactHeader(): catched exception:"+f),null}};
ListeningPointImpl.prototype.sendHeartbeat=function(a){a=this.messageProcessor.createMessageChannel(a);var b=new SIPRequest;b.setNullRequest();a.sendMessage(b)};ListeningPointImpl.prototype.getPort=function(){return this.messageProcessor.getPort()};ListeningPointImpl.prototype.getHostAddress=function(){return this.sipStack.getHostAddress()};function NistSipMessageFactoryImpl(a){this.classname="NistSipMessageFactoryImpl";this.sipStack=a}
NistSipMessageFactoryImpl.prototype.newSIPServerRequest=function(a,b){if(null==b||null==a)throw console.error("NistSipMessageFactoryImpl:newSIPServerRequest(): null Arg!"),"NistSipMessageFactoryImpl:newSIPServerRequest(): null Arg!";a=b.getSIPStack();a=new DialogFilter(a);b instanceof SIPTransaction&&(a.transactionChannel=b);a.listeningPoint=b.getMessageProcessor().getListeningPoint();return null==a.listeningPoint?null:a};
NistSipMessageFactoryImpl.prototype.newSIPServerResponse=function(a,b){var c=b.getSIPStack().findTransaction(a,!1);if(null!=c&&(null==c.getState()||"COMPLETED"==c.getState()&&1==a.getStatusCode()/100))return null;a=new DialogFilter(this.sipStack);a.transactionChannel=c;a.listeningPoint=b.getMessageProcessor().getListeningPoint();return a};
function SipProviderImpl(a){this.classname="SipProviderImpl";this.automaticDialogSupportEnabled=this.port=this.address=this.eventScanner=this.sipStack=this.sipListener=null;this.dialogErrorsAutomaticallyHandled=!0;this.sipStack=a;this.eventScanner=a.getEventScanner();this.eventScanner.incrementRefcount();this.listeningPoints=[];this.automaticDialogSupportEnabled=this.sipStack.isAutomaticDialogSupportEnabledFunction();this.dialogErrorsAutomaticallyHandled=this.sipStack.isAutomaticDialogErrorHandlingEnabledFunction()}
SipProviderImpl.prototype.getListeningPoint=function(a){for(var b=0;b<this.listeningPoints.length;b++)if(this.listeningPoints[b][0]==a.toUpperCase())return this.listeningPoints[b][1];return null};SipProviderImpl.prototype.getDefaultListeningPoint=function(){return 0<this.listeningPoints.length?this.listeningPoints[0][1]:null};SipProviderImpl.prototype.isAutomaticDialogSupportEnabled=function(){return this.automaticDialogSupportEnabled};
SipProviderImpl.prototype.handleEvent=function(a,b){a=new EventWrapper(a,b);this.sipStack.reEntrantListener?this.eventScanner.deliverEvent(a):this.eventScanner.addEvent(a)};
SipProviderImpl.prototype.addSipListener=function(a){if(null==this.sipStack.sipListener)this.sipStack.sipListener=a;else if(this.sipStack.sipListener!=a)throw console.error("SipProviderImpl:addSipListener(): stack already has a listener. Only one listener per stack allowed"),"SipProviderImpl:addSipListener(): stack already has a listener. Only one listener per stack allowed";this.sipListener=a};
SipProviderImpl.prototype.setListeningPoint=function(a){if(null==a)throw console.error("SipProviderImpl:setListeningPoint(): null listeningPoint argument"),"SipProviderImpl:setListeningPoint(): null listeningPoint argument ";a.sipProvider=this;var b=a.getTransport().toUpperCase();this.address=a.getHostAddress();this.port=a.getPort();this.listeningPoints=[];var c=[];c[0]=b;c[1]=a;this.listeningPoints.push(c)};SipProviderImpl.prototype.getSipListener=function(){return this.sipListener};
SipProviderImpl.prototype.stop=function(){for(var a=0;a<this.listeningPoints.length;a++)this.listeningPoints[a][1].removeSipProvider();this.eventScanner.stop()};SipProviderImpl.prototype.getNewCallId=function(){var a=Utils.prototype.generateCallIdentifier(this.getListeningPoint().getHostAddress()),b=new CallID;b.setCallId(a);return b};
SipProviderImpl.prototype.getNewClientTransaction=function(a){if(null==a)throw console.error("SipProviderImpl:getNewClientTransaction(): null request argument"),"SipProviderImpl:getNewClientTransaction(): null request argument ";if(!this.sipStack.isAlive())throw console.error("SipProviderImpl:getNewClientTransaction(): stack is stopped"),"SipProviderImpl:getNewClientTransaction(): stack is stopped";if(null!=a.getTransaction())throw console.error("SipProviderImpl:getNewClientTransaction(): transaction already assigned to request"),
"SipProviderImpl:getNewClientTransaction(): transaction already assigned to request";if("ACK"==a.getMethod())throw console.error("SipProviderImpl:getNewClientTransaction(): cannot create client transaction for  ACK"),"SipProviderImpl:getNewClientTransaction(): cannot create client transaction for  ACK";var b=this.sipStack.getNextHop(a);if(null==b)throw console.error("SipProviderImpl:getNewClientTransaction(): cannot resolve next hop -- transaction unavailable"),"SipProviderImpl:getNewClientTransaction(): cannot resolve next hop -- transaction unavailable";
var c=b.getTransport();null==c&&(c="WSS");if(null==a.getTopmostVia()){var d=this.getListeningPoint(c);null==d&&(d=this.getListeningPoints()[0]);a.setHeader(d.getViaHeader())}try{a.checkHeaders()}catch(g){throw console.error("SipProviderImpl:getNewClientTransaction(): catched exception: "+g),"SipProviderImpl:getNewClientTransaction(): catched exception: "+g;}var e="z9hG4bK"==a.getTopmostVia().getBranch().substring(0,7)?!0:!1;if(null!=a.getTopmostVia().getBranch()&&e&&null!=this.sipStack.findTransaction(a,
!1))throw console.error("SipProviderImpl:getNewClientTransaction(): transaction already exists!"),"SipProviderImpl:getNewClientTransaction(): transaction already exists!";if("CANCEL"==a.getMethod().toUpperCase()&&(e=this.sipStack.findCancelTransaction(a,!1),null!=e))return b=this.sipStack.createClientTransaction(a,e.getMessageChannel()),b.addEventListener(this),this.sipStack.addTransaction(b),null!=e.getDialog()&&b.setDialog(e.getDialog(),a.getDialogId(!1)),b;d=a.getDialogId(!1);d=this.sipStack.getDialog(d);
null!=d&&"TERMINATED"==d.getState()&&this.sipStack.removeDialog(d);e=new Number(a.getCSeq().getSeqNumber());a.getCSeq().setSeqNumber(e+1);null!=d&&d.incrementLocalSequenceNumber();e="z9hG4bK"!=a.getTopmostVia().getBranch().substring(0,7)?!0:!1;if(null==a.getTopmostVia().getBranch()||e||this.sipStack.checkBranchIdFunction()){var f=Utils.prototype.generateBranchId();a.getTopmostVia().setBranch(f)}e=a.getTopmostVia();null==e.getTransport()&&e.setTransport(c);f=a.getTopmostVia().getBranch();e=this.sipStack.createTransaction(a,
this.sipStack.getChannel(),b);if(null==e)throw console.error("SipProviderImpl:getNewClientTransaction(): cannot create transaction"),"SipProviderImpl:getNewClientTransaction(): cannot create transaction";e.setNextHop(b);e.setOriginalRequest(a);e.setBranch(f);this.sipStack.isDialogCreated(a.getMethod())?null!=d?e.setDialog(d,a.getDialogId(!1)):this.isAutomaticDialogSupportEnabled()&&(b=this.sipStack.createDialog(e),e.setDialog(b,a.getDialogId(!1))):null!=d&&e.setDialog(d,a.getDialogId(!1));e.addEventListener(this);
return e};
SipProviderImpl.prototype.getNewServerTransaction=function(a){if(!this.sipStack.isAlive())throw console.error("SipProviderImpl:getNewServerTransaction(): stack is stopped"),"SipProviderImpl:getNewServerTransaction(): stack is stopped";try{a.checkHeaders()}catch(d){throw console.error("SipProviderImpl:getNewServerTransaction(): catched exception:"+d),"SipProviderImpl:getNewServerTransaction(): catched exception:"+d;}if("ACK"==a.getMethod())throw console.error("SipProviderImpl:getNewServerTransaction(): cannot create Server transaction for  ACK"),"SipProviderImpl:getNewServerTransaction(): cannot Server client transaction for  ACK";
if("NOTIFY"==a.getMethod()&&null!=a.getFromTag()&&null==a.getToTag()&&null==this.sipStack.findSubscribeTransaction(a,this.getListeningPoint(a.getTopmostVia().getTransport()))&&!this.sipStack.deliverUnsolicitedNotify)throw console.error("SipProviderImpl:getNewServerTransaction(): cannot find matching Subscription (and gov.nist.javax.sip.DELIVER_UNSOLICITED_NOTIFY not set)"),"SipProviderImpl:getNewServerTransaction(): cannot find matching Subscription (and gov.nist.javax.sip.DELIVER_UNSOLICITED_NOTIFY not set)";
if(this.sipStack.isDialogCreated(a.getMethod())){if(null!=this.sipStack.findTransaction(a,!0))throw console.error("SipProviderImpl:getNewServerTransaction(): server transaction already exists!"),"SipProviderImpl:getNewServerTransaction(): server transaction already exists!)";var b=a.getTransaction();if(null==b)throw console.error("SipProviderImpl:getNewServerTransaction(): transaction not available"),"SipProviderImpl:getNewServerTransaction(): transaction not available";null==b.getOriginalRequest()&&
b.setOriginalRequest(a);try{this.sipStack.addTransaction(b)}catch(d){throw console.error("SipProviderImpl:getNewServerTransaction(): catched exception:"+d),"SipProviderImpl:getNewServerTransaction(): catched exception:"+d;}b.addEventListener(this);if(this.isAutomaticDialogSupportEnabled()){var c=a.getDialogId(!0);c=this.sipStack.getDialog(c);null==c&&(c=this.sipStack.createDialog(b));b.setDialog(c,a.getDialogId(!0));"INVITE"==a.getMethod()&&this.isDialogErrorsAutomaticallyHandled()&&this.sipStack.putInMergeTable(b,
a);c.addRoute(a);null!=c.getRemoteTag()&&null!=c.getLocalTag()&&this.sipStack.putDialog(c);c.setInviteTransaction(b);c.setState(c.EARLY_STATE)}}else{if(this.isAutomaticDialogSupportEnabled()){b=this.sipStack.findTransaction(a,!0);if(null!=b)throw console.error("SipProviderImpl:getNewServerTransaction(): transaction exists!"),"SipProviderImpl:getNewServerTransaction(): transaction exists!";b=a.getTransaction();if(null==b)throw console.error("SipProviderImpl:getNewServerTransaction(): transaction not available"),
"SipProviderImpl:getNewServerTransaction():transaction not available";null==b.getOriginalRequest()&&b.setOriginalRequest(a);try{this.sipStack.addTransaction(b)}catch(d){throw console.error("SipProviderImpl:getNewServerTransaction(): catched exception:"+d),"SipProviderImpl:getNewServerTransaction():  catched exception:"+d;}}else{b=this.sipStack.findTransaction(a,!0);if(null!=b)throw console.error("SipProviderImpl:getNewServerTransaction(): transaction exists!"),"SipProviderImpl:getNewServerTransaction(): transaction exists!";
b=a.getTransaction();if(null!=b)null==b.getOriginalRequest()&&b.setOriginalRequest(a);else{b=a.getMessageChannel();b=this.sipStack.createServerTransaction(b);if(null==b)throw console.error("SipProviderImpl:getNewServerTransaction(): transaction unavailable -- too many servrer transactions"),"SipProviderImpl:getNewServerTransaction(): transaction unavailable -- too many servrer transactions";b.setOriginalRequest(a)}this.sipStack.mapTransaction(b)}c=a.getDialogId(!0);c=this.sipStack.getDialog(c);null!=
c&&(c.addTransaction(b),c.addRoute(a),b.setDialog(c,a.getDialogId(!0)))}return b};SipProviderImpl.prototype.getSipStack=function(){return this.sipStack};SipProviderImpl.prototype.removeSipListener=function(a){a==this.getSipListener()&&(this.sipListener=null);a=!1;for(var b=this.sipStack.getSipProviders(),c=0;c<b.length;c++)null!=b[c].getSipListener()&&(a=!0);a||(this.sipStack.sipListener=null)};
SipProviderImpl.prototype.sendRequest=function(a){if(!this.sipStack.isAlive())throw console.error("SipProviderImpl:sendRequest(): stack is stopped"),"SipProviderImpl:sendRequest(): stack is stopped";var b=this.sipStack.getRouter(a).getNextHop(a);if(null==b)throw console.error("SipProviderImpl:sendRequest(): could not determine next hop!"),"SipProviderImpl:sendRequest():  could not determine next hop!";if(!a.isNullRequest()&&null==a.getTopmostVia())throw console.error("SipProviderImpl:sendRequest(): invalid SipRequest -- no via header!"),
"SipProviderImpl:sendRequest(): invalid SipRequest -- no via header!";if(!a.isNullRequest()){var c=a.getTopmostVia(),d=c.getBranch();null!=d&&0!=d.length()||c.setBranch(a.getTransactionId())}d=c=null;for(var e=0;e<this.listeningPoints.length;e++)b.getTransport().toUpperCase()==this.listeningPoints[e][0]&&(d=e);null!=d&&(c=this.sipStack.createRawMessageChannel());if(null!=c)c.sendMessage(a);else throw console.error("SipProviderImpl:sendRequest(): could not create a message channel for "+b.toString()),
"SipProviderImpl:sendRequest(): could not create a message channel for "+b.toString();};
SipProviderImpl.prototype.sendResponse=function(a){if(!this.sipStack.isAlive())throw console.error("SipProviderImpl:sendResponse(): stack is stopped"),"SipProviderImpl:sendResponse(): stack is stopped";if(null==a.getTopmostVia())throw console.error("SipProviderImpl:sendResponse(): no via header in response!"),"SipProviderImpl:sendResponse(): no via header in response!";var b=this.sipStack.findTransaction(a,!0);if(null!=b&&"TERMINATED"!=b.getState()&&this.isAutomaticDialogSupportEnabled())throw console.error("SipProviderImpl:sendResponse(): transaction exists -- cannot send response statelessly"),
"SipProviderImpl:sendResponse(): transaction exists -- cannot send response statelessly";try{if(null==this.getListeningPoint())throw console.error("SipProviderImpl:sendResponse(): whoopsa daisy! no listening point found for transport "+transport),"SipProviderImpl:sendResponse(): whoopsa daisy! no listening point found for transport "+transport;this.sipStack.getChannel().sendMessage(a)}catch(c){throw console.error("SipProviderImpl:sendResponse(): catched exception: "+c),"SipProviderImpl:sendResponse(): catched exception:"+
c;}};
SipProviderImpl.prototype.getNewDialog=function(a){if(null==a)throw console.error("SipProviderImpl:sendResponse(): null transaction!"),"SipProviderImpl:sendResponse():  null transaction!";if(!this.sipStack.isAlive())throw console.error("SipProviderImpl:sendResponse(): stack is stopped"),"SipProviderImpl:sendResponse(): stack is stopped";if(this.isAutomaticDialogSupportEnabled())throw console.error("SipProviderImpl:sendResponse(): error - AUTOMATIC_DIALOG_SUPPORT is on"),"SipProviderImpl:sendResponse(): error - AUTOMATIC_DIALOG_SUPPORT is on";if(!this.sipStack.isDialogCreated(a.getRequest().getMethod()))throw console.error("SipProviderImpl:sendResponse(): dialog cannot be created for this method "+
a.getRequest().getMethod()),"SipProviderImpl:sendResponse(): dialog cannot be created for this method "+a.getRequest().getMethod();if(a instanceof SIPServerTransaction){var b=a.getLastResponse();if(null!=b&&100!=b.getStatusCode())throw console.error("SipProviderImpl:sendResponse(): cannot set dialog after response has been sent"),"SipProviderImpl:sendResponse(): cannot set dialog after response has been sent";b=a.getRequest();var c=b.getDialogId(!0);c=this.sipStack.getDialog(c);null==c?(c=this.sipStack.createDialog(a),
c.addTransaction(a),c.addRoute(b),a.setDialog(c,null)):a.setDialog(c,b.getDialogId(!0));"INVITE"==b.getMethod()&&this.isDialogErrorsAutomaticallyHandled()&&this.sipStack.putInMergeTable(a,b)}else if(b=a.getLastResponse(),null==b){c=a.getRequest().getDialogId(!1);c=this.sipStack.getDialog(c);if(null!=c)throw console.error("SipProviderImpl:sendResponse(): dialog already exists!"),"SipProviderImpl:sendResponse(): dialog already exists!";c=this.sipStack.createDialog(a);a.setDialog(c,null)}else throw console.error("SipProviderImpl:sendResponse(): cannot call this method after response is received!"),
"SipProviderImpl:sendResponse(): cannot call this method after response is received!";c.addEventListener(this);return c};
SipProviderImpl.prototype.transactionErrorEvent=function(a){a.getSource();if(2==a.getErrorID()){a=a.getSource();var b="TRANSACTION";a instanceof SIPServerTransaction||a.getNextHop();b=new TimeoutEvent(this,a,b);this.handleEvent(b,a)}else 1==a.getErrorID()?(a=a.getSource(),b="TRANSACTION",a instanceof SIPServerTransaction||a.getNextHop(),b=new TimeoutEvent(this,a,b),this.handleEvent(b,a)):3==a.getErrorID()&&(a=a.getSource(),b=Timeout.RETRANSMIT,b=new TimeoutEvent(this,a,b),this.handleEvent(b,a))};
SipProviderImpl.prototype.dialogErrorEvent=function(a){var b=a.getSource(),c="AckNotReceived";2==a.getErrorID()?c="AckNotSent":3==a.getErrorID()&&(c="ReInviteTimeout");a=new DialogTimeoutEvent(this,b,c);this.handleEvent(a,null)};SipProviderImpl.prototype.getListeningPoints=function(){for(var a=[],b=0;b<this.listeningPoints.length;b++)a[b]=this.listeningPoints[b][1];return a};
SipProviderImpl.prototype.addListeningPoint=function(a){if(null!=a.sipProvider&&a.sipProvider!=this)throw console.error("SipProviderImpl:addListeningPoint(): listening point assigned to another provider"),"SipProviderImpl:addListeningPoint(): listening point assigned to another provider";var b=a.getTransport().toUpperCase();if(0==this.listeningPoints.length)this.address=a.getHostAddress(),this.port=a.getPort();else if(this.address!=a.getHostAddress()||this.port!=a.getPort())throw console.error("SipProviderImpl:addListeningPoint(): provider already has different IP Address associated"),
"SipProviderImpl:addListeningPoint(): provider already has different IP Address associated";for(var c=null,d=null,e=0;e<this.listeningPoints.length;e++)b==this.listeningPoints[e][0]&&(d=c=e);if(null!=d)var f=this.listeningPoints[d][1];if(null!=c&&f!=a)throw console.error("SipProviderImpl:addListeningPoint(): listening point already assigned for transport!"),"SipProviderImpl:addListeningPoint(): listening point already assigned for transport!";a.sipProvider=this;c=[];c[0]=b;c[1]=a;this.listeningPoints.push(c)};
SipProviderImpl.prototype.removeListeningPoint=function(a){for(var b=null,c=0;c<this.listeningPoints.length;c++)a.getTransport().toUpperCase()==this.listeningPoints[c][0]&&(b=c);this.listeningPoints.splice(b,1)};SipProviderImpl.prototype.removeListeningPoints=function(){for(var a=0;a<this.listeningPoints.length;a++)this.listeningPoints[a][1].messageProcessor.stop();this.listeningPoints=[]};
SipProviderImpl.prototype.setAutomaticDialogSupportEnabled=function(a){if(this.automaticDialogSupportEnabled=a)this.dialogErrorsAutomaticallyHandled=!0};SipProviderImpl.prototype.setDialogErrorsAutomaticallyHandled=function(){this.dialogErrorsAutomaticallyHandled=!0};SipProviderImpl.prototype.isDialogErrorsAutomaticallyHandled=function(){return this.dialogErrorsAutomaticallyHandled};
function SipStackImpl(a,b,c){this.classname="SipStackImpl";this.stackName=null;this.serverTransactionTable=[];this.clientTransactionTable=[];this.earlyDialogTable=[];this.isBackToBackUserAgent=!1;this.eventScanner=new EventScanner(this);this.listeningPoints=[];this.sipProviders=[];this.sipListener=null;this.setNon2XXAckPassedToListener(!1);this.isAutomaticDialogErrorHandlingEnabled=this.isAutomaticDialogSupportEnabled=!0;this.messageChannel=null;this.userAgentName=a;this.lastTransaction=null;this.reEntrantListener=
!0;this.setHostAddress(Utils.prototype.randomString(12)+".invalid");this.sipMessageFactory=new NistSipMessageFactoryImpl(this);this.DEFAULT_WS_TRANSPORT=c;this.defaultRouter=new DefaultRouter(this,this.stackAddress,b,c)}SipStackImpl.prototype=new SIPTransactionStack;SipStackImpl.prototype.constructor=SipStackImpl;SipStackImpl.prototype.MAX_DATAGRAM_SIZE=8192;SipStackImpl.prototype.DEFAULT_WS_TRANSPORT="WSS";SipStackImpl.prototype.isAutomaticDialogSupportEnabledFunction=function(){return this.isAutomaticDialogSupportEnabled};
SipStackImpl.prototype.isAutomaticDialogErrorHandlingEnabledFunction=function(){return this.isAutomaticDialogErrorHandlingEnabled};SipStackImpl.prototype.getEventScanner=function(){return this.eventScanner};SipStackImpl.prototype.getSipListener=function(){return this.sipListener};
SipStackImpl.prototype.createSipProvider=function(a){if(null==a)throw console.error("SipProviderImpl:createSipProvider(): null listeningPoint argument"),"SipProviderImpl:createSipProvider(): null listeningPoint argument";if(null!=a.sipProvider)throw console.error("SipProviderImpl:createSipProvider(): provider already attached!"),"SipProviderImpl:createSipProvider(): provider already attached!";var b=new SipProviderImpl(this);b.setListeningPoint(a);a.setSipProvider(b);this.sipProviders.push(b);return b};
SipStackImpl.prototype.createListeningPoint=function(a){this.isAlive()||(this.toExit=!1,this.reInitialize());if(0==a.toLowerCase().indexOf("ws://"))var b="WS";else if(0==a.toLowerCase().indexOf("wss://"))b="WSS";else throw"WSMessageChannel:createWebSocket(): bad Websocket Url";b=ListeningPointImpl.prototype.makeKey(this.stackAddress,b);for(var c=0;c<this.listeningPoints.length;c++)if(this.listeningPoints[c]==b)return this.listeningPoints[c][1];a=new WSMessageProcessor(this,a);this.addMessageProcessor(a);
c=new ListeningPointImpl(this,a);a.setListeningPoint(c);var d=[];d[0]=b;d[1]=c;this.listeningPoints.push(d);this.messageChannel=a.getMessageChannel();return c};SipStackImpl.prototype.reInitialize=function(){this.reInit();this.eventScanner=new EventScanner(this);this.listeningPoints=[];this.sipProviders=[];this.sipListener=null};SipStackImpl.prototype.getUserAgent=function(){return this.userAgentName};
SipStackImpl.prototype.deleteListeningPoint=function(a){if(null==a)throw console.error("SipProviderImpl:deleteListeningPoint(): null listeningPoint arg"),"SipProviderImpl:deleteListeningPoint(): null listeningPoint arg";this.removeMessageProcessor(a.messageProcessor);a=a.getKey();for(var b=0;b<this.listeningPoints.length;b++)if(this.listeningPoints[b][0]==a){this.listeningPoints.splice(b,1);break}};
SipStackImpl.prototype.deleteSipProvider=function(a){if(null==a)throw console.error("SipProviderImpl:deleteSipProvider(): null provider arg"),"SipProviderImpl:deleteSipProvider(): null provider arg";if(null!=a.getSipListener())throw console.error("SipProviderImpl:deleteSipProvider(): sipProvider still has an associated SipListener!"),"SipProviderImpl:deleteSipProvider(): sipProvider still has an associated SipListener!";a.removeListeningPoints();a.stop();for(var b=0;b<this.sipProviders.length;b++)if(this.sipProviders[b]==
a){this.sipProviders.splice(b,1);break}0==this.sipProviders.length&&this.stopStack()};SipStackImpl.prototype.getListeningPoints=function(){return this.listeningPoints};SipStackImpl.prototype.getSipProviders=function(){return this.sipProviders};SipStackImpl.prototype.getStackName=function(){return this.stackName};SipStackImpl.prototype.finalize=function(){this.stopStack()};
SipStackImpl.prototype.stop=function(){this.stopStack();this.sipProviders=[];this.listeningPoints=[];null!=this.eventScanner&&this.eventScanner.forceStop();this.eventScanner=null};SipStackImpl.prototype.start=function(){null==this.eventScanner&&(this.eventScanner=new EventScanner(this))};SipStackImpl.prototype.getSipListener=function(){return this.sipListener};SipStackImpl.prototype.setEnabledCipherSuites=function(a){this.cipherSuites=a};SipStackImpl.prototype.getEnabledCipherSuites=function(){return this.cipherSuites};
SipStackImpl.prototype.setEnabledProtocols=function(a){this.enabledProtocols=a};SipStackImpl.prototype.getEnabledProtocols=function(){return this.enabledProtocols};SipStackImpl.prototype.setIsBackToBackUserAgent=function(a){this.isBackToBackUserAgent=a};SipStackImpl.prototype.isBackToBackUserAgent=function(){return this.isBackToBackUserAgent};SipStackImpl.prototype.isAutomaticDialogErrorHandlingEnabled=function(){return this.isAutomaticDialogErrorHandlingEnabled};
SipStackImpl.prototype.getChannel=function(){return this.messageChannel};
SipStackImpl.prototype.newSIPServerRequest=function(a,b){var c=null;var d=a.getTransactionId();a.setMessageChannel(b);for(var e=null,f=0;f<this.serverTransactionTable.length;f++)this.serverTransactionTable[f][0]==d&&(e=f);null!=e&&(c=this.serverTransactionTable[e][1]);if(null==c||!c.isMessagePartOfTransaction(a)){c=null;f=this.BRANCH_MAGIC_COOKIE_LOWER_CASE.length;if(d.toLowerCase().substr(0,f-1)!=this.BRANCH_MAGIC_COOKIE_LOWER_CASE)for(f=0;f<this.serverTransactionTable.length&&null==c;f++)d=this.serverTransactionTable[f][1],
d.isMessagePartOfTransaction(a)&&(c=d);if(null==c){c=this.findPendingTransaction(a);if(null!=c)return a.setTransaction(c),null!=c?c:null;c=this.createServerTransaction(b);c.setOriginalRequest(a);a.setTransaction(c);"ACK"!=a.getMethod()&&(c=b.messageProcessor.listeningPoint.sipProvider.getNewServerTransaction(a))}}null!=c&&c.setRequestInterface(this.sipMessageFactory.newSIPServerRequest(a,c));"ACK"==a.getMethod()?c=this.lastTransaction:this.lastTransaction=c;return c};
SipStackImpl.prototype.newSIPServerResponse=function(a,b){var c=null;var d=a.getTransactionId();for(var e=null,f=0;f<this.clientTransactionTable.length;f++)this.clientTransactionTable[f][0]==d&&(e=f);null!=e&&(c=this.clientTransactionTable[e][1]);f=this.BRANCH_MAGIC_COOKIE_LOWER_CASE.length;d=d.toLowerCase().substr(0,f-1);if(null==c||!c.isMessagePartOfTransaction(a)&&d!=this.BRANCH_MAGIC_COOKIE_LOWER_CASE){for(f=0;f<this.clientTransactionTable.length&&null==c;f++)d=this.clientTransactionTable[f][1],
d.isMessagePartOfTransaction(a)&&(c=d);if(null==c)return this.sipMessageFactory.newSIPServerResponse(a,b)}a=this.sipMessageFactory.newSIPServerResponse(a,c);if(null!=a)c.setResponseInterface(a);else return null;return c};SipStackImpl.prototype.createServerTransaction=function(a){return new SIPServerTransaction(this,a)};
SipStackImpl.prototype.removeTransaction=function(a){if(a instanceof SIPServerTransaction){for(var b=a.getTransactionId(),c=null,d=null,e=0;e<this.serverTransactionTable.length;e++)b==this.serverTransactionTable[e]&&(d=e,c=this.serverTransactionTable[e][1]);this.serverTransactionTable.splice(d,1);b=a.getMethod();this.removePendingTransaction(a);this.removeTransactionPendingAck(a);"INVITE"==b.toUpperCase()&&this.removeFromMergeTable(a);b=a.getSipProvider();null!=c&&a.testAndSetTransactionTerminatedEvent()&&
(c=new TransactionTerminatedEvent(b,a),b.handleEvent(c,a))}else{b=a.getTransactionId();d=null;for(e=0;e<this.clientTransactionTable.length;e++)this.clientTransactionTable[e][0]==b&&(d=e);null!=d&&(c=this.clientTransactionTable[d][1],this.clientTransactionTable.splice(d,1));null!=c&&a.testAndSetTransactionTerminatedEvent()&&(b=a.getSipProvider(),c=new TransactionTerminatedEvent(b,a),b.handleEvent(c,a))}};function SipListener(){}SipListener.prototype.processDialogTerminated=function(a){};
SipListener.prototype.processIOException=function(a){};SipListener.prototype.processRequest=function(a){};SipListener.prototype.processResponse=function(a){};SipListener.prototype.processTimeout=function(a){};SipListener.prototype.processTransactionTerminated=function(a){};SipListener.prototype.processConnected=function(){};SipListener.prototype.processDisconnected=function(){};SipListener.prototype.processConnectionError=function(){};function SipFactory(){this.classname="SipFactory"}
SipFactory.prototype.createSipStack=function(a,b,c){try{return new SipStackImpl(a,b,c)}catch(d){throw console.error("SipFactory:createAddressFactory(): failed to create SipStackImpl"),"SipFactory:createAddressFactory(): failed to create SipStackImpl";}};
SipFactory.prototype.createAddressFactory=function(){try{return new AddressFactoryImpl}catch(a){throw console.error("SipFactory:createAddressFactory(): failed to create AddressFactory"),"SipFactory:createAddressFactory(): failed to create AddressFactory";}};
SipFactory.prototype.createHeaderFactory=function(){try{return new HeaderFactoryImpl}catch(a){throw console.error("SipFactory:createHeaderFactory(): failed to create HeaderFactory"),"SipFactory:createHeaderFactory(): failed to create HeaderFactory";}};
SipFactory.prototype.createMessageFactory=function(){try{return new MessageFactoryImpl}catch(a){throw console.error("SipFactory:createMessageFactory(): failed to create MessageFactory"),"SipFactory:createMessageFactory():failed to create MessageFactory";}};
